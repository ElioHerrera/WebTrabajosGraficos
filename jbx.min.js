var jbx={},A='prototype',B='array',C='color',D='RGB',E='HSB',F='HSL',G='string',H='dom',I='style',J='classes',K='query',L='browser',M='Range',N='selection',O='math',P='Point',Q='Rect',R='Box',S='Size',T='easing',U='Path',V='Arc',W='Ellipse',X='Line',Y='Curve',Z='events',a='Event',b='Listener',c='TouchEvent',d='FocusEvent',e='MouseEvent',f='KeyboardEvent',g='DragDropEvent',h='AnimationEvent',i='ResizeEvent',j='SlideshowEvent',k='base',l='Object',m='Component',n='Control',o='Http',p='net',q='history',r='json',s='XHR',t='man',u='component',v='dd',w='animation',x='com',y='DragSource',z='Timer',AA='Animation',AB='DropTarget',AC='DropTargetGroup',AD='Resize',AE='Tween',AF='widget',AG='Slideshow';jbx[B]={};jbx[C]={};jbx[C][D]={};jbx[C][E]={};jbx[C][F]={};jbx[G]={};jbx[H]={};jbx[H][I]={};jbx[H][J]={};jbx[H][K]={};jbx[H][L]={};jbx[H][M]={};jbx[H][N]={};jbx[O]={};jbx[O][P]={};jbx[O][Q]={};jbx[O][R]={};jbx[O][S]={};jbx[O][T]={};jbx[O][U]={};jbx[O][V]={};jbx[O][W]={};jbx[O][X]={};jbx[O][Y]={};jbx[Z]={};jbx[Z][a]={};jbx[Z][b]={};jbx[Z][c]={};jbx[Z][d]={};jbx[Z][e]={};jbx[Z][f]={};jbx[Z][g]={};jbx[Z][h]={};jbx[Z][i]={};jbx[Z][j]={};jbx[k]={};jbx[k][l]={};jbx[k][m]={};jbx[k][n]={};jbx[k][o]={};jbx[p]={};jbx[p][q]={};jbx[p][r]={};jbx[p][s]={};jbx[t]={};jbx[t][u]={};jbx[t][v]={};jbx[t][w]={};jbx[x]={};jbx[x][y]={};jbx[x][z]={};jbx[x][AA]={};jbx[x][AB]={};jbx[x][AC]={};jbx[x][AD]={};jbx[x][AE]={};jbx[AF]={};jbx[AF][AG]={};jbx._UniqueIdCounter=1;jbx.getUniqueId=function(obj){var id=obj.getAttribute?obj.getAttribute('data-jbx-unique-id'):obj['data-jbx-unique-id'];if(jbx.isEmpty(id)){id=jbx._UniqueIdCounter++;if(obj.setAttribute){obj.setAttribute('data-jbx-unique-id',id);}else{obj['data-jbx-unique-id']=id;}}return id;};jbx.isDefined=function(value){return value!==undefined;};jbx.isNull=function(value){return value===null||!jbx.isDefined(value);};jbx.isEmpty=function(value){return value===0||value===NaN||value===''||jbx.isNull(value)||jbx.isEmptyObject(value)||(jbx.isArray(value)&&value.length==0);};jbx.isEmptyObject=function(value){var i=0;if(jbx.isObject(value)){for(i in value){return false;}return true;}return false;};jbx.isString=function(value){return typeof value=="string";};jbx.isBoolean=function(value){return typeof value=="boolean";};jbx.isNumber=function(value){return typeof value=="number"&&!isNaN(value);};jbx.isFunction=function(value){return typeof value=="function";};jbx.isObject=function(value){return!jbx.isNull(value)&&(typeof value=='object'||jbx.isFunction(value));};jbx.isDate=function(value){return jbx.isObject(value)&&jbx.isFunction(value.getFullYear);};jbx.isArray=function(value){return value instanceof Array||(!(value instanceof Object)&&Object.prototype.toString.call(value)=='[object Array]');};jbx.eval=function(code){if(window.execScript){window.execScript(code,"JavaScript");}else
if(window.eval){var fn=function(src){window.eval.call(window,src);};fn(code);}else{var node=document.createElement("script");node.type="text/javascript";node.appendChild(document.createTextNode(code));document.body.appendChild(node);document.body.removeChild(node);}};jbx.extends=function(subclass,superclass){var subClassObj=jbx.getObjectByName(subclass),supClassObj=jbx.getObjectByName(superclass);if(!subClassObj||!supClassObj){throw new Error("Missing super-class ("+superclass+") or sub-class ("+subclass+") objects.");}function temp(){};temp.prototype=supClassObj.prototype;subClassObj.prototype=new temp();subClassObj.prototype.constructor=subClassObj;subClassObj.Super=function(scope,method,args){args=Array.prototype.slice.call(arguments,2);return supClassObj.prototype[method].apply(scope,args);};if(supClassObj.prototype.isObject){subClassObj.prototype.className=subclass;subClassObj.prototype.styleName=subclass.replace(/\./g,'-');subClassObj.prototype.classParent=superclass;}};jbx._basePath=null;jbx.getBasePath=function(){var src='',i=0,l=0,scripts=null;if(this._basePath===null){scripts=document.getElementsByTagName('SCRIPT');for(i=0,l=scripts.length;i<l;i++){src=scripts[i].src;if(src&&src.substr(src.length-6,6)=='jbx.js'){this._basePath=src.substr(0,src.length-6);break;}}}return this._basePath;};jbx.getObjectByName=function(name){var parts=null,part=null,curr=null;parts=name.split('.');part=parts.shift();curr=window[part];while(parts.length&&curr){part=parts.shift();curr=curr[part];}return curr;};jbx[B].indexOf=function(arr,item,fromIndex){var i=0,len=arr.length;fromIndex=fromIndex||0;fromIndex=fromIndex<0?Math.max(0,len+fromIndex):fromIndex;for(i=fromIndex;i<len;i++){if(arr[i]===item){return i;}}return-1;};jbx[B].lastIndexOf=function(arr,item,fromIndex){var i=0,len=arr.length;fromIndex=!jbx.isDefined(fromIndex)?len-1:fromIndex;fromIndex=fromIndex<0?Math.max(0,len+fromIndex):fromIndex;for(i=fromIndex;i>=0;i--){if(arr[i]===item){return i;}}return-1;};jbx[B].filter=function(arr,func,scope){var i=0,l=arr.length,result=[],index=0;scope=scope||this;for(;i<l;i++){if(func.call(scope,arr[i],i,arr)){result[index++]=arr[i];}}return result;};jbx[B].map=function(arr,func,scope){var i=0,l=arr.length,result=[];scope=scope||this;for(;i<l;i++){result[i]=func.call(scope,arr[i],i,arr);}return result;};jbx[B].find=function(arr,func,scope){var index=jbx.array.findIndex(arr,func,scope);return arr[index]||null;};jbx[B].findIndex=function(arr,func,scope){var i=0,l=arr.length;scope=scope||this;for(;i<l;i++){if(func.call(scope,arr[i],i,arr)){return i;}}return-1;};jbx[B].every=function(arr,func,scope){var i=0,l=arr.length;scope=scope||this;for(;i<l;i++){if(!func.call(scope,arr[i],i,arr)){return false;}}return true;};jbx[B].some=function(arr,func,scope){var i=0,l=arr.length;scope=scope||this;for(;i<l;i++){if(func.call(scope,arr[i],i,arr)){return true;}}return false;};jbx[B].forEach=function(arr,func,scope){var i=0,l=arr.length;scope=scope||this;for(;i<l;i++){if(func.call(scope,arr[i],i,arr)===false){break;}}};jbx[B].unique=function(arr){var i=0,l=arr.length,result=[],nidx=0;for(;i<l;i++){if(jbx.array.indexOf(result,arr[i])==-1){result[nidx]=arr[i];nidx++;}}return result;};jbx[G].toUcFirst=function(str){str=str.toLowerCase();return str.replace(/^([^a-z\xe0-\xff]*?[a-z\xe0-\xff])/ig,function(x,l){return l.toUpperCase();});};jbx[G].toUcWords=function(str){str=str.toLowerCase();return str.replace(/(^[^a-z\xe0-\xff]*?[a-z\xe0-\xff]|[^a-z\xe0-\xff][a-z\xe0-\xff])/ig,function(x,l){return l.toUpperCase();});};jbx[G].toCamel=function(str){if(str.indexOf('-')>-1){str=str.toLowerCase();return str.replace(/-([a-z])/g,function(x,l){return l.toUpperCase();});}return str;};jbx[G].toBreak=function(str){return str.replace(/(\r\n|\r|\n)/g,"<br />");};jbx[G].toLineFeed=function(str){return str.replace(/<br\s?\/?>/gi,"\n");};jbx[G].toNbsp=function(str,all){return all?str.replace(/( )/g,"&nbsp;"):str.replace(/(  )/g,"&nbsp; ");};jbx[G].toSpace=function(str){return str.replace(/&(nbsp|#160);/g," ");};jbx[G].countSymbols=function(str){return str.replace(/[^\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F][\u0300-\u036F\u1DC0-\u1DFF\u20D0-\u20FF\uFE20-\uFE2F]+/g).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,'_').length;};jbx[G].trim=function(str){return str.replace(/^[\t\n\r\s\u00A0\u000C]+|[\t\n\r\s\u00A0\u000C]+$/g,'');};jbx[G].trimLeft=function(str){return str.replace(/^[\t\n\r\s\u00A0\u000C]+/g,'');};jbx[G].trimRight=function(str){return str.replace(/[\t\n\r\s\u00A0\u000C]+$/g,'');};jbx[G].padLeft=function(str,len,padStr){str=str+'';padStr=padStr||' ';if(str.length<len){str=new Array(len-str.length+1).join(padStr)+str;}return str;};jbx[G].padRight=function(str,len,padStr){str=str+'';padStr=padStr||' ';if(str.length<len){str=str+new Array(len-str.length+1).join(padStr);}return str;};jbx[G].numberFormat=function(num,decimals,decimalSeparator,thousandSeparator){decimals=decimals||0;decimalSeparator=decimalSeparator||'.';thousandSeparator=thousandSeparator||'';num=parseFloat(num);if(isNaN(num)){return num+'';}num=num.toFixed(decimals);num=(num+'').split('.');if(num[1]){num[1]=jbx.string.padRight(num[1],decimals,'0');}if(thousandSeparator!=''){num[0]=num[0].replace(/\d{1,3}(?=(\d{3})+(?!\d))/g,function(s){return s+thousandSeparator;});}return num.join(decimalSeparator)+'';};jbx[G].truncate=function(str,len,useHint){return str.length<=len?str:[(useHint?['<span title="',jbx.string.htmlEntities(str),'">'].join(''):''),str.substring(0,len-3),"...",(useHint?'</span>':'')].join('');};jbx[G].truncateMiddle=function(str,len,useHint){var midp=0,endp=0;if(str.length>len){len-=3;midp=Math.floor(len/2),endp=str.length-midp;midp+=len%2;str=[(useHint?['<span title="',jbx.string.htmlEntities(str),'">'].join(''):''),str.substring(0,midp),"...",str.substring(endp),(useHint?'</span>':'')].join('');}return str+'';};jbx[G].escapeRegExp=function(str){return str.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,'\\$1');};jbx[G].stripTags=function(str){return str.replace(/<.*?>/g,'');};jbx[G].htmlEntities=function(str){return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\"/g,'&quot;');};jbx[G].htmlEntitiesDecode=function(str){var ent={'lt':'<','gt':'>','amp':'&','quot':'"'};return str.replace(/&([^;]+);/g,function(s,m){return ent[m]?ent[m]:(m.charAt(0)=='#'?String.fromCharCode(m.substr(1)):s);});};jbx[C][E]=function(h,s,b){this.setHSB(h||0,s||0,b||0);};jbx.color.HSB.prototype.h=0;jbx.color.HSB.prototype.s=0;jbx.color.HSB.prototype.b=0;jbx[C][E][A].getChroma=function(){return this.b*this.s;};jbx[C][E][A].setHSB=function(h,s,b){this.h=h%360;this.s=Math.min(Math.max(0,s),1);this.b=Math.min(Math.max(0,b),1);};jbx[C][E][A].toRGB=function(){var rgb=new jbx.color.RGB(),chroma=this.getChroma(),min=this.b-chroma,sextant=this.h/60,x=chroma*(1-Math.abs(sextant%2-1));switch(Math.floor(sextant)){case 6:case 0:rgb.r=chroma+min;rgb.g=x+min;rgb.b=min;break;case 1:rgb.r=x+min;rgb.g=chroma+min;rgb.b=min;break;case 2:rgb.r=min;rgb.g=chroma+min;rgb.b=x+min;break;case 3:rgb.r=min;rgb.g=x+min;rgb.b=chroma+min;break;case 4:rgb.r=x+min;rgb.g=min;rgb.b=chroma+min;break;case 5:rgb.r=chroma+min;rgb.g=min;rgb.b=x+min;break;}rgb.r=Math.round(rgb.r*255);rgb.g=Math.round(rgb.g*255);rgb.b=Math.round(rgb.b*255);return rgb;};jbx[C][E][A].clone=function(){return new jbx.color.HSB(this.h,this.s,this.b);};jbx[C][F]=function(h,s,l){this.setHSL(h,s,l);};jbx.color.HSL.prototype.h=0;jbx.color.HSL.prototype.s=0;jbx.color.HSL.prototype.l=0;jbx[C][F][A].getChroma=function(){return this.s*(1-Math.abs((2*this.l)-1));};jbx[C][F][A].setHSL=function(h,s,l){this.h=h%360;this.s=Math.min(Math.max(0,s),1);this.l=Math.min(Math.max(0,l),1);};jbx[C][F][A].toRGB=function(){var rgb=new jbx.color.RGB(),chroma=this.getChroma(),min=this.l-(chroma/2),sextant=this.h/60,x=chroma*(1-Math.abs(sextant%2-1));switch(Math.floor(sextant)){case 6:case 0:rgb.r=chroma+min;rgb.g=x+min;rgb.b=min;break;case 1:rgb.r=x+min;rgb.g=chroma+min;rgb.b=min;break;case 2:rgb.r=min;rgb.g=chroma+min;rgb.b=x+min;break;case 3:rgb.r=min;rgb.g=x+min;rgb.b=chroma+min;break;case 4:rgb.r=x+min;rgb.g=min;rgb.b=chroma+min;break;case 5:rgb.r=chroma+min;rgb.g=min;rgb.b=x+min;break;}rgb.r=Math.round(rgb.r*255);rgb.g=Math.round(rgb.g*255);rgb.b=Math.round(rgb.b*255);return rgb;};jbx[C][F][A].clone=function(){return new jbx.color.HSL(this.h,this.s,this.l);};jbx[C][D]=function(r,g,b){this.setRGB(r||0,g||0,b||0);};jbx.color.RGB.prototype.r=0;jbx.color.RGB.prototype.g=0;jbx.color.RGB.prototype.b=0;jbx[C][D][A].formatHEX=function(){return jbx.string.padLeft(this.r.toString(16),2,'0')+jbx.string.padLeft(this.g.toString(16),2,'0')+jbx.string.padLeft(this.b.toString(16),2,'0');};jbx[C][D][A].formatRGB=function(){return'rgb('+this.r+', '+this.g+', '+this.b+')';};jbx[C][D][A].getChroma=function(){var nr=this.r/255,ng=this.g/255,nb=this.b/255,min=Math.min(nr,ng,nb),max=Math.max(nr,ng,nb);return max-min;};jbx[C][D][A].getLuma=function(){return(this.r*0.299)+(this.g*0.587)+(this.b*0.114);};jbx[C][D][A].getHUE=function(){var hue=0,sextant=0,min=Math.min(this.r,this.g,this.b),max=Math.max(this.r,this.g,this.b),chroma=max-min;if(chroma!=0){if(max==this.r){sextant=((this.g-this.b)/chroma)%6;}else
if(max==this.g){sextant=((this.b-this.r)/chroma)+2;}else{sextant=((this.r-this.g)/chroma)+4;}hue=sextant*60;}return(hue+360)%360;};jbx[C][D][A].getDistance=function(color){var rd=0,gd=0,bd=0;if(jbx.isString(color)){color=jbx.color.parse(color);}rd=Math.abs(this.r-color.r);gd=Math.abs(this.g-color.g);bd=Math.abs(this.b-color.b);return Math.sqrt(rd*rd+gd*gd+bd*bd);};jbx[C][D][A].getLumaDifference=function(color){if(jbx.isString(color)){color=jbx.color.parse(color);}return Math.abs(this.getLuma()-color.getLuma());};jbx[C][D][A].getColorDifference=function(color){var rdif=0,gdif=0,bdif=0;if(jbx.isString(color)){color=jbx.color.parse(color);}rdif=Math.abs(this.r-color.r);gdif=Math.abs(this.g-color.g);bdif=Math.abs(this.b-color.b);return rdif+gdif+bdif;};jbx[C][D][A].getReadabilityContrast=function(color){var cdif=0,ydif=0;if(jbx.isString(color)){color=jbx.color.parse(color);}cdif=this.getColorDifference(color);ydif=Math.abs(this.getLuma()-color.getLuma());if(ydif<64||cdif<192){return jbx.color.Readability.BAD;}else
if(ydif<128||cdif<384){return jbx.color.Readability.POOR;}else
if(ydif<192||cdif<576){return jbx.color.Readability.GOOD;}else{return jbx.color.Readability.EXCELENT;}};jbx[C][D][A].setRGB=function(r,g,b){this.r=Math.min(Math.max(0,r),255);this.g=Math.min(Math.max(0,g),255);this.b=Math.min(Math.max(0,b),255);};jbx[C][D][A].toHSB=function(){var hue=0,saturation=0,min=Math.min(this.r,this.g,this.b),max=Math.max(this.r,this.g,this.b),chroma=max-min;if(chroma!=0){hue=this.getHUE();saturation=chroma/max;}return new jbx.color.HSB(hue,saturation,max/255);};jbx[C][D][A].toHSL=function(){var hue=0,saturation=0,nr=this.r/255,ng=this.g/255,nb=this.b/255,min=Math.min(nr,ng,nb),max=Math.max(nr,ng,nb),lightness=(min+max)/2,chroma=max-min;if(chroma!=0){hue=this.getHUE();saturation=chroma/(1-Math.abs((2*lightness)-1));}return new jbx.color.HSL(hue,saturation,lightness);};jbx[C][D][A].clone=function(){return new jbx.color.RGB(this.r,this.g,this.b);};jbx[C][D][A].lighten=function(factor){this.blend('FFF',factor);};jbx[C][D][A].darken=function(factor){this.blend('000',factor);};jbx[C][D][A].blend=function(color,factor){factor=Math.max(0,Math.min(factor,1));color=jbx.isString(color)?jbx.color.parse(color):color;this.r=Math.round((factor*color.r)+((1-factor)*this.r));this.g=Math.round((factor*color.g)+((1-factor)*this.g));this.b=Math.round((factor*color.b)+((1-factor)*this.b));};jbx[C].Readability={BAD:'bad',POOR:'poor',GOOD:'good',EXCELENT:'excelent'};jbx[C].WebNames={aliceblue:'f0f8ff',antiquewhite:'faebd7',aqua:'00ffff',aquamarine:'7fffd4',azure:'f0ffff',beige:'f5f5dc',bisque:'ffe4c4',black:'000000',blanchedalmond:'ffebcd',blue:'0000ff',blueviolet:'8a2be2',brown:'a52a2a',burlywood:'deb887',cadetblue:'5f9ea0',chartreuse:'7fff00',chocolate:'d2691e',coral:'ff7f50',cornflowerblue:'6495ed',cornsilk:'fff8dc',crimson:'dc143c',cyan:'00ffff',darkblue:'00008b',darkcyan:'008b8b',darkgoldenrod:'b8860b',darkgray:'a9a9a9',darkgreen:'006400',darkgrey:'a9a9a9',darkkhaki:'bdb76b',darkmagenta:'8b008b',darkolivegreen:'556b2f',darkorange:'ff8c00',darkorchid:'9932cc',darkred:'8b0000',darksalmon:'e9967a',darkseagreen:'8fbc8f',darkslateblue:'483d8b',darkslategray:'2f4f4f',darkslategrey:'2f4f4f',darkturquoise:'00ced1',darkviolet:'9400d3',deeppink:'ff1493',deepskyblue:'00bfff',dimgray:'696969',dimgrey:'696969',dodgerblue:'1e90ff',firebrick:'b22222',floralwhite:'fffaf0',forestgreen:'228b22',fuchsia:'ff00ff',gainsboro:'dcdcdc',ghostwhite:'f8f8ff',gold:'ffd700',goldenrod:'daa520',gray:'808080',green:'008000',greenyellow:'adff2f',grey:'808080',honeydew:'f0fff0',hotpink:'ff69b4',indianred:'cd5c5c',indigo:'4b0082',ivory:'fffff0',khaki:'f0e68c',lavender:'e6e6fa',lavenderblush:'fff0f5',lawngreen:'7cfc00',lemonchiffon:'fffacd',lightblue:'add8e6',lightcoral:'f08080',lightcyan:'e0ffff',lightgoldenrodyellow:'fafad2',lightgray:'d3d3d3',lightgreen:'90ee90',lightgrey:'d3d3d3',lightpink:'ffb6c1',lightsalmon:'ffa07a',lightseagreen:'20b2aa',lightskyblue:'87cefa',lightslategray:'778899',lightslategrey:'778899',lightsteelblue:'b0c4de',lightyellow:'ffffe0',lime:'00ff00',limegreen:'32cd32',linen:'faf0e6',magenta:'ff00ff',maroon:'800000',mediumaquamarine:'66cdaa',mediumblue:'0000cd',mediumorchid:'ba55d3',mediumpurple:'9370db',mediumseagreen:'3cb371',mediumslateblue:'7b68ee',mediumspringgreen:'00fa9a',mediumturquoise:'48d1cc',mediumvioletred:'c71585',midnightblue:'191970',mintcream:'f5fffa',mistyrose:'ffe4e1',moccasin:'ffe4b5',navajowhite:'ffdead',navy:'000080',oldlace:'fdf5e6',olive:'808000',olivedrab:'6b8e23',orange:'ffa500',orangered:'ff4500',orchid:'da70d6',palegoldenrod:'eee8aa',palegreen:'98fb98',paleturquoise:'afeeee',palevioletred:'db7093',papayawhip:'ffefd5',peachpuff:'ffdab9',peru:'cd853f',pink:'ffc0cb',plum:'dda0dd',powderblue:'b0e0e6',purple:'800080',red:'ff0000',rosybrown:'bc8f8f',royalblue:'4169e1',saddlebrown:'8b4513',salmon:'fa8072',sandybrown:'f4a460',seagreen:'2e8b57',seashell:'fff5ee',sienna:'a0522d',silver:'c0c0c0',skyblue:'87ceeb',slateblue:'6a5acd',slategray:'708090',slategrey:'708090',snow:'fffafa',springgreen:'00ff7f',steelblue:'4682b4',tan:'d2b48c',teal:'008080',thistle:'d8bfd8',tomato:'ff6347',turquoise:'40e0d0',violet:'ee82ee',wheat:'f5deb3',white:'ffffff',whitesmoke:'f5f5f5',yellow:'ffff00',yellowgreen:'9acd32'};jbx[C].HUENames={Amaranth:'ff001f',Crimson:'ff003f',Raspberry:'ff005f',Rose:'ff007f',Cerise:'ff009f',Fuchsia:'ff00bf',Orchid:'ff00df',Magenta:'ff00ff',Heliotrope:'df00ff',Mulberry:'bf00ff',Purple:'9f00ff',Violet:'7f00ff',BlueViolet:'5f00ff',Indigo:'3f00ff',PersianBlue:'1f00ff',Blue:'0000ff',PhthaloBlue:'001fff',SapphireBlue:'003fff',CobaltBlue:'005fff',Azure:'007fff',CornflowerBlue:'009fff',Cerulean:'00bfff',ArcticBlue:'00dfff',Cyan:'00ffff',Opal:'00ffdf',Turquoise:'00ffbf',Aquamarine:'00ff9f',SpringGreen:'00ff7f',SeaGreen:'00ff5f',MalachiteGreen:'00ff3f',EmeraldGreen:'00ff1f',Green:'00ff00',SapGreen:'1fff00',Harlequin:'3fff00',Pistachio:'5fff00',ChartreuseGreen:'7fff00',SpringBud:'9fff00',LimeGreen:'bfff00',AppleGreen:'dfff00',Yellow:'ffff00',Gold:'ffdf00',Amber:'ffbf00',Gamboge:'ff9f00',Orange:'ff7f00',Tangelo:'ff5f00',Vermilion:'ff3f00',Scarlet:'ff1f00',Red:'ff0000'};jbx[C].parse=function(str){var r=0,g=0,b=0;str+='';str=str.substr(0,1)=='#'?str.substr(1):str;if(str.match(/^([a-f0-9]{3}){1,2}$/i)){if(str.length==3){r=str.substr(0,1);g=str.substr(1,1);b=str.substr(2,1);r=parseInt(r+''+r,16);g=parseInt(g+''+g,16);b=parseInt(b+''+b,16);}else{r=parseInt(str.substr(0,2),16);g=parseInt(str.substr(2,2),16);b=parseInt(str.substr(4,2),16);}}else
if(str.match(/rgb\s*?\(\s*?([0-9]{1,3})\s*?,\s*?([0-9]{1,3})\s*?,\s*?([0-9]{1,3})\s*?\)/)){r=parseInt(RegExp.$1,10);g=parseInt(RegExp.$2,10);b=parseInt(RegExp.$3,10);}else
if(jbx.color.WebNames[str.toLowerCase()]){return jbx.color.parse(jbx.color.WebNames[str.toLowerCase()]);}return new jbx.color.RGB(r,g,b);};jbx[O].isInt=function(num){return jbx.math.isNumber(num)&&num%1==0;};jbx[O].isNumber=function(value){return jbx.isNumber(value);};jbx[O].toInt=function(str){var n=parseInt(str,10);return isNaN(n)?0:n;};jbx[O].toNumber=function(str){var n=parseFloat(str);return isNaN(n)?0:n;};jbx[O].toRadians=function(a){return a*Math.PI/180;};jbx[O].toDegrees=function(a){return a*180/Math.PI;};jbx[O].random=function(a,b){return jbx.math.lerp(a,b,Math.random());};jbx[O].lerp=function(a,b,t){return a+t*(b-a);};jbx[O][P]=function(x,y){this.setCoordinate(x,y);};jbx.math.Point.Expression=/^([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)$/;jbx.math.Point.prototype.x=0;jbx.math.Point.prototype.y=0;jbx[O][P].parse=function(str){var r=str.match(jbx.math.Point.Expression);return r?new jbx.math.Point(parseFloat(r[1]),parseFloat((r[2]=='-'?'-':'')+r[3])):false;};jbx[O][P][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return this.x.toFixed(precision).replace(/\.?0+$/,'')+","+this.y.toFixed(precision).replace(/\.?0+$/,'');};jbx[O][P][A].setCoordinate=function(x,y){this.x=x||0;this.y=y||0;};jbx[O][P][A].clone=function(){return new jbx.math.Point(this.x,this.y);};jbx[O][P][A].equals=function(pt){return pt&&this.x==pt.x&&this.y==pt.y;};jbx[O][P][A].translate=function(tx,ty){this.x+=tx;this.y+=ty;};jbx[O][P][A].distance=function(pt){var dx=this.x-pt.x,dy=this.y-pt.y;return Math.sqrt(dx*dx+dy*dy);};jbx[O][P][A].add=function(pt){var result=this.clone();result.x=result.x+pt.x;result.y=result.y+pt.y;return result;};jbx[O][P][A].subtract=function(pt){var result=this.clone();result.x=result.x-pt.x;result.y=result.y-pt.y;return result;};jbx[O][P][A].globalToLocal=function(el){var pt=this.clone(),pos=jbx.dom.style.getGlobalPosition(el),brd=jbx.dom.style.getBoxProperty(el,'border');pt.x=pt.x-pos.x-brd.x;pt.y=pt.y-pos.y-brd.y;return pt;};jbx[O][P][A].localToGlobal=function(el){var pt=this.clone(),pos=jbx.dom.style.getGlobalPosition(el),brd=jbx.dom.style.getBoxProperty(el,'border');pt.x=this.x+pos.x+brd.x;pt.y=this.y+pos.y+brd.y;return pt;};jbx[O][R]=function(x,y,x2,y2){this.x=x||0;this.y=y||0;this.x2=x2||0;this.y2=y2||0;};jbx.math.Box.Expression=/^M\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*(M|m)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*$/;jbx.math.Box.prototype.x=0;jbx.math.Box.prototype.y=0;jbx.math.Box.prototype.x2=0;jbx.math.Box.prototype.y2=0;jbx[O][R].parse=function(str){var x0=0,y0=0,x1=0,y1=0,r=str.match(jbx.math.Line.Expression);if(r){x0=parseFloat(r[1]);y0=parseFloat((r[2]=='-'?'-':'')+r[3]);x1=parseFloat(r[5]);y1=parseFloat((r[6]=='-'?'-':'')+r[7]);if(r[4]==='m'){x1+=x0;y1+=y0;}return new jbx.math.Box(x0,y0,x1,y1);}return false;};jbx[O][R][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return'M '+this.x.toFixed(precision).replace(/\.?0+$/,'')+","+this.y.toFixed(precision).replace(/\.?0+$/,'')+" "+'M '+this.x2.toFixed(precision).replace(/\.?0+$/,'')+","+this.y2.toFixed(precision).replace(/\.?0+$/,'');};jbx[O][R][A].toRect=function(){return new jbx.math.Rect(this.x,this.y,this.x2-this.x,this.y2-this.y);};jbx[O][R][A].setBounds=function(x,y,x2,y2){this.setTopLeft(x,y);this.setBottomRight(x2,y2);};jbx[O][R][A].setTopLeft=function(x,y){this.x=x||0;this.y=y||0;};jbx[O][R][A].setBottomRight=function(x,y){this.x2=x||0;this.y2=y||0;};jbx[O][R][A].clone=function(){return new jbx.math.Box(this.x,this.y,this.x2,this.y2);};jbx[O][R][A].equals=function(box){return box&&this.x==box.x&&this.y==box.y&&this.x2==box.x2&&this.y2==box.y2;};jbx[O][R][A].translate=function(tx,ty){this.x+=tx;this.y+=ty;this.x2+=tx;this.y2+=ty;};jbx[O][R][A].union=function(box){var nbox=new jbx.math.Box(0,0,0,0);nbox.x=Math.min(this.x,box.x);nbox.y=Math.min(this.y,box.y);nbox.x2=Math.max(this.x2,box.x2);nbox.y2=Math.max(this.y2,box.y2);return nbox;};jbx[O][R][A].intersection=function(box){var nbox=new jbx.math.Box(0,0,0,0),x1=Math.max(this.x,box.x),y1=Math.max(this.y,box.y),x2=Math.min(this.x2,box.x2),y2=Math.min(this.y2,box.y2);if(x1<=x2&&y1<=y2){nbox.x=x1;nbox.y=y1;nbox.x2=x2;nbox.y2=y2;}return nbox;};jbx[O][R][A].intersects=function(box){var x1=Math.max(this.x,box.x),y1=Math.max(this.y,box.y),x2=Math.min(this.x2,box.x2),y2=Math.min(this.y2,box.y2);return x1<=x2&&y1<=y2;};jbx[O][R][A].contains=function(point){return this.x<=point.x&&this.y<=point.y&&this.x2>=point.x&&this.y2>=point.y;};jbx[O][R][A].inflate=function(dx,dy){this.x-=dx;this.y-=dy;this.x2+=dx;this.y2+=dy;};jbx[O][R][A].deflate=function(dx,dy){this.inflate(dx*-1,dy*-1);};jbx[O][Q]=function(x,y,width,height){this.x=x||0;this.y=y||0;this.width=width||0;this.height=height||0;};jbx.math.Rect.Expression=/^M\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*(H|h)\s*([+-]?\d*\.?\d+)\s*(V|v)\s*([+-]?\d*\.?\d+).*$/;jbx.math.Rect.prototype.x=0;jbx.math.Rect.prototype.y=0;jbx.math.Rect.prototype.width=0;jbx.math.Rect.prototype.height=0;jbx[O][Q].parse=function(str){var x=0,y=0,w=0,h=0,r=str.match(jbx.math.Rect.Expression);if(r){x=parseFloat(r[1]);y=parseFloat((r[2]=='-'?'-':'')+r[3]);w=parseFloat(r[5]);h=parseFloat(r[7]);if(r[4]==='H'){w=w-x;}if(r[6]==='V'){h=h-y;}return new jbx.math.Rect(x,y,w,h);}return false;};jbx[O][Q][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return'M '+this.x.toFixed(precision).replace(/\.?0+$/,'')+","+this.y.toFixed(precision).replace(/\.?0+$/,'')+" "+'h '+this.width.toFixed(precision).replace(/\.?0+$/,'')+" "+'v '+this.height.toFixed(precision).replace(/\.?0+$/,'')+" "+'h '+(this.width*-1).toFixed(precision).replace(/\.?0+$/,'')+" "+'v '+(this.height*-1).toFixed(precision).replace(/\.?0+$/,'');};jbx[O][Q][A].toBox=function(){return new jbx.math.Box(this.x,this.y,this.width+this.x,this.height+this.y);};jbx[O][Q][A].setSize=function(width,height){this.width=width||0;this.height=height||0;};jbx[O][Q][A].setCoordinate=function(x,y){this.x=x||0;this.y=y||0;};jbx[O][Q][A].setBounds=function(x,y,width,height){this.setSize(width,height);this.setCoordinate(x,y);};jbx[O][Q][A].clone=function(){return new jbx.math.Rect(this.x,this.y,this.width,this.height);};jbx[O][Q][A].copy=function(rec){this.setBounds(rec.x,rec.y,rec.width,rec.height);};jbx[O][Q][A].equals=function(rect){return rect&&this.x==rect.x&&this.y==rect.y&&this.width==rect.width&&this.height==rect.height;};jbx[O][Q][A].inflate=function(dx,dy){this.x-=dx;this.y-=dy;this.width+=dx*2;this.height+=dy*2;};jbx[O][Q][A].deflate=function(dx,dy){this.inflate(dx*-1,dy*-1);};jbx[O][Q][A].union=function(rect){var nrect=new jbx.math.Rect(0,0,0,0);nrect.x=Math.min(this.x,rect.x);nrect.y=Math.min(this.y,rect.y);nrect.width=Math.max(this.x+this.width,rect.x+rect.width)-nrect.x;nrect.height=Math.max(this.y+this.height,rect.y+rect.height)-nrect.y;return nrect;};jbx[O][Q][A].intersection=function(rect){var nrect=new jbx.math.Rect(0,0,0,0),x1=Math.max(this.x,rect.x),y1=Math.max(this.y,rect.y),x2=Math.min(this.x+this.width,rect.x+rect.width),y2=Math.min(this.y+this.height,rect.y+rect.height);if(x1<=x2&&y1<=y2){nrect.x=x1;nrect.y=y1;nrect.width=x2-x1;nrect.height=y2-y1;}return nrect;};jbx[O][Q][A].intersects=function(rect){var x1=Math.max(this.x,rect.x),y1=Math.max(this.y,rect.y),x2=Math.min(this.x+this.width,rect.x+rect.width),y2=Math.min(this.y+this.height,rect.y+rect.height);return x1<=x2&&y1<=y2;};jbx[O][Q][A].contains=function(rect){return this.x<=rect.x&&this.y<=rect.y&&this.x+this.width>=rect.x+rect.width&&this.y+this.height>=rect.y+rect.height;};jbx[O][Q][A].containsPoint=function(point){return this.x<=point.x&&this.y<=point.y&&this.x+this.width>=point.x&&this.y+this.height>=point.y;};jbx[O][S]=function(width,height){this.width=width||0;this.height=height||0;};jbx.math.Size.Expression=/^([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)$/;jbx.math.Size.prototype.width=0;jbx.math.Size.prototype.height=0;jbx[O][S].parse=function(str){var r=str.match(jbx.math.Size.Expression);return r?new jbx.math.Size(parseFloat(r[1]),parseFloat((r[2]=='-'?'-':'')+r[3])):false;};jbx[O][S][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return this.width.toFixed(precision).replace(/\.?0+$/,'')+","+this.height.toFixed(precision).replace(/\.?0+$/,'');};jbx[O][S][A].clone=function(){return new jbx.math.Size(this.width,this.height);};jbx[O][S][A].setSize=function(width,height){this.width=width||0;this.height=height||0;};jbx[O][S][A].equals=function(size){return size&&this.width==size.width&&this.height==size.height;};jbx[H][I].Side={TOP:1,LEFT:2,RIGHT:4,BOTTOM:8};jbx[H][I].SideName={1:'top',2:'left',4:'right',8:'bottom'};jbx[H][I].Corner={CENTER:0,TOPLEFT:3,TOPRIGHT:5,BOTTOMLEFT:10,BOTTOMRIGHT:12};jbx[H][I].CornerName={3:'topleft',5:'topright',10:'bottomleft',12:'bottomright'};jbx[H][I].zIndex={TOP:9000000,MID:5000000,LOW:1000000};jbx[H][I].isVisible=function(el){return!jbx.dom.resolveNode(el,jbx.dom.TreeWalker.PARENT_NODE,jbx.dom.style.isDisplayNone);};jbx[H][I].isDisplayNone=function(el){return jbx.dom.isElementNode(el)&&jbx.dom.style.getStyle(el,"display")=="none";};jbx[H][I].isUnselectable=function(el){if('MozUserSelect'in el.style){return el.style.MozUserSelect=='none';}else
if('WebkitUserSelect'in el.style){return el.style.WebkitUserSelect=='none';}else{return el.getAttribute("unselectable")=='on';}};jbx[H][I].toPixel=function(el,property,value){var re=/^\d+(px)?$/,pixel=null,oldinline=null,oldruntime=null,names={thin:2,medium:4,thick:6};property=property.toLowerCase()=='height'?'height':'width';if(re.test(value)){return jbx.math.toInt(value);}else
if(names[value]){return names[value];}else
if(el.currentStyle&&el.runtimeStyle){oldinline=el.style[property];oldruntime=el.runtimeStyle[property];el.runtimeStyle[property]=jbx.dom.style.getStyle(el,property);el.style[property]=value;pixel=el.style[jbx.string.toCamel('pixel-'+property)];el.style[property]=oldinline;el.runtimeStyle[property]=oldruntime;return parseInt(pixel,10);}else{oldinline=el.style[property];el.style[property]=value;pixel=jbx.dom.style.getStyle(el,property);el.style[property]=oldinline;return jbx.math.toInt(pixel);}};jbx[H][I].getStyle=function(el,property){property=jbx.string.toCamel(property);return property=='float'?jbx.dom.style.getFloat(el):property=='opacity'?jbx.dom.style.getOpacity(el):property=='transform'?jbx.dom.style.getTransform(el):property=='transformOrigin'?jbx.dom.style.getTransformOrigin(el):property=='boxSizing'?jbx.dom.style.getBoxSizing(el):jbx.dom.style.getComputedStyle(el,property);};jbx[H][I].getComputedStyle=function(el,property){var styles=null,doc=jbx.dom.getDocument(el);property=jbx.string.toCamel(property);if(doc.defaultView&&doc.defaultView.getComputedStyle){styles=doc.defaultView.getComputedStyle(el,null);if(styles){return styles[property]||styles.getPropertyValue(property);}}else
if(el.currentStyle){return el.currentStyle[property];}return el.style[property];};jbx[H][I].getFloat=function(el,value){return jbx.dom.style.getComputedStyle(el,'cssFloat'in el.style?'cssFloat':'styleFloat');};jbx[H][I].getOpacity=function(el){var result='',match=null;if('opacity'in el.style){result=jbx.dom.style.getComputedStyle(el,'opacity');}else if('MozOpacity'in el.style){result=jbx.dom.style.getComputedStyle(el,'MozOpacity');}else if('filter'in el.style){match=el.style.filter.match(/alpha\(opacity=(.+)\)/);if(match){result=match[1]/100;}}result=parseFloat(result);return isNaN(result)?1:result;};jbx[H][I].getTransform=function(el){var result='';if('transform'in el.style){result=jbx.dom.style.getComputedStyle(el,'transform');}else
if('WebkitTransform'in el.style){result=jbx.dom.style.getComputedStyle(el,'WebkitTransform');}else
if('MsTransform'in el.style){result=jbx.dom.style.getComputedStyle(el,'MsTransform');}return result;};jbx[H][I].getTransformOrigin=function(el){var result='';if('transformOrigin'in el.style){result=jbx.dom.style.getComputedStyle(el,'transformOrigin');}else
if('WebkitTransformOrigin'in el.style){result=jbx.dom.style.getComputedStyle(el,'WebkitTransformOrigin');}else
if('MsTransformOrigin'in el.style){result=jbx.dom.style.getComputedStyle(el,'MsTransformOrigin');}return result;};jbx[H][I].getBoxSizing=function(el){if('boxSizing'in el.style){return jbx.dom.style.getComputedStyle(el,'boxSizing');}else
if('MozBoxSizing'in el.style){return jbx.dom.style.getComputedStyle(el,'MozBoxSizing');}else
if('WebkitBoxSizing'in el.style){return jbx.dom.style.getComputedStyle(el,'WebkitBoxSizing');}else
if('MsBoxSizing'in el.style){return jbx.dom.style.getComputedStyle(el,'MsBoxSizing');}return'content-box';};jbx[H][I].getBoxProperty=function(el,property){var b=property=='border',top=[property,'Top',b?'Width':''].join(''),left=[property,'Left',b?'Width':''].join(''),right=[property,'Right',b?'Width':''].join(''),bottom=[property,'Bottom',b?'Width':''].join('');if(property=='border'&&jbx.dom.style.getStyle(el,'border-style')=='none'){return new jbx.math.Box(0,0,0,0);}top=jbx.dom.style.getStyle(el,top);left=jbx.dom.style.getStyle(el,left);right=jbx.dom.style.getStyle(el,right);bottom=jbx.dom.style.getStyle(el,bottom);return new jbx.math.Box(jbx.dom.style.toPixel(el,'width',left),jbx.dom.style.toPixel(el,'height',top),jbx.dom.style.toPixel(el,'width',right),jbx.dom.style.toPixel(el,'height',bottom));};jbx[H][I].getSize=function(el){return new jbx.math.Size(el.offsetWidth,el.offsetHeight);};jbx[H][I].getBorderBoxSize=function(el){return this.getSize(el);};jbx[H][I].getContentBoxSize=function(el){var size=jbx.dom.style.getSize(el),border=jbx.dom.style.getBoxProperty(el,'border'),padding=jbx.dom.style.getBoxProperty(el,'padding');return new jbx.math.Size(size.width-border.x-border.x2-padding.x-padding.x2,size.height-border.y-border.y2-padding.y-padding.y2);};jbx[H][I].getPosition=function(el){return new jbx.math.Point(el.offsetLeft,el.offsetTop);};jbx[H][I].getGlobalPosition=function(el){var rect=null,ppos=null,point=null,scroll=null,doc=jbx.dom.getDocument(el),vpt=jbx.dom.getViewport(doc),pos=jbx.dom.style.getStyle(el,'position');if(el==vpt){return new jbx.math.Point(0,0);}if(el.getBoundingClientRect){rect=el.getBoundingClientRect();rect.top-=vpt.clientTop;rect.left-=vpt.clientLeft;rect=new jbx.math.Rect(rect.left,rect.top,rect.width,rect.height);scroll=jbx.dom.style.getDocumentScroll(el);return new jbx.math.Point(Math.round(rect.x+scroll.x),Math.round(rect.y+scroll.y));}else{point=jbx.dom.style.getPosition(el),parent=el.offsetParent;if(pos=='fixed'){scroll=jbx.dom.style.getDocumentScroll(el);point.y+=scroll.y;point.x+=scroll.x;}while(parent){ppos=jbx.dom.style.getStyle(parent,'position');point.y+=parent.offsetTop+(parent.clientTop||0);point.x+=parent.offsetLeft+(parent.clientTop||0);if(ppos=='fixed'){scroll=jbx.dom.style.getDocumentScroll(el);point.y+=scroll.y;point.x+=scroll.x;break;}parent=parent.offsetParent;}parent=el;while(parent&&parent!=doc.body){point.y-=parent.scrollTop;point.x-=parent.scrollLeft;parent=parent.parentNode;}return point;}};jbx[H][I].getBounds=function(el){var size=jbx.dom.style.getSize(el),pos=jbx.dom.style.getGlobalPosition(el);return new jbx.math.Rect(pos.x,pos.y,size.width,size.height);};jbx[H][I].getScroll=function(el){return jbx.dom.isDocument(el)?jbx.dom.style.getDocumentScroll(el):new jbx.math.Rect(el.scrollLeft,el.scrollTop,el.scrollWidth,el.scrollHeight);};jbx[H][I].getDocumentScroll=function(node){var doc=jbx.dom.getDocument(node),vpt=jbx.dom.getViewport(doc);return new jbx.math.Rect(vpt.scrollLeft+doc.body.scrollLeft,vpt.scrollTop+doc.body.scrollTop,vpt.scrollWidth+doc.body.scrollWidth,vpt.scrollHeight+doc.body.scrollHeight);};jbx[H][I].getDocumentSize=function(node){var scr=jbx.dom.style.getDocumentScroll(node),size=jbx.dom.style.getViewportSize(node);return new jbx.math.Rect(0,0,Math.max(scr.width,size.width),Math.max(scr.height,size.height));};jbx[H][I].getViewportSize=function(node){var vpt=jbx.dom.getViewport(node),scr=jbx.dom.style.getDocumentScroll(node);return new jbx.math.Rect(scr.x,scr.y,vpt.clientWidth,vpt.clientHeight);;};jbx[H][I].setStyle=function(el,property,val){property=jbx.string.toCamel(property);switch(property){case'float':jbx.dom.style.setFloat(el,val);break;case'opacity':jbx.dom.style.setOpacity(el,val);break;case'transform':jbx.dom.style.setTransform(el,val);break;case'transformOrigin':jbx.dom.style.setTransformOrigin(el,val);break;case'boxSizing':jbx.dom.style.setBoxSizing(el,val);break;default:el.style[property]=val;}};jbx[H][I].setStyles=function(el,properties){var property,val;properties=properties.split(/\s*?;\s*?/);for(var i=0,l=properties.length;i<l;i++){property=properties[i].split(/\s*?:\s*?/);if(property.length==2){val=jbx.string.trim(property[1]);property=jbx.string.trim(property[0]);jbx.dom.style.setStyle(el,property,val);}}};jbx[H][I].setFloat=function(el,value){el.style['styleFloat']=value;el.style['cssFloat']=value;};jbx[H][I].setOpacity=function(el,alpha){if('opacity'in el.style){el.style.opacity=alpha>=1?'':alpha;}else
if('MozOpacity'in el.style){el.style.MozOpacity=alpha>=1?'':alpha;}else
if('filter'in el.style){el.style.filter=alpha>=1?'':['alpha(opacity=',alpha*100,')'].join('');}};jbx[H][I].setTransform=function(el,str){if('transform'in el.style){el.style.transform=str;}else
if('WebkitTransform'in el.style){el.style.WebkitTransform=str;}else
if('MsTransform'in el.style){el.style.MsTransform=str;}};jbx[H][I].setTransformOrigin=function(el,str){if('transformOrigin'in el.style){el.style.transformOrigin=str;}else
if('WebkitTransformOrigin'in el.style){el.style.WebkitTransformOrigin=str;}else
if('MsTransformOrigin'in el.style){el.style.MsTransformOrigin=str;}};jbx[H][I].setUnselectable=function(el,value,recursion){if('MozUserSelect'in el.style){el.style.MozUserSelect=value?'none':'';}else
if('WebkitUserSelect'in el.style){el.style.WebkitUserSelect=value?'none':'';}else{value=value?'on':'';el.setAttribute("unselectable",value);}if(recursion!==false){el=jbx.dom.firstChild(el);while(el){jbx.dom.style.setUnselectable(el,value,recursion);el=jbx.dom.nextElement(el);}}};jbx[H][I].setGradient=function(el,direction,colors){var i=0,l=0,realdir='',prefix=['','-o-','-ms-','-moz-','-webkit-'];direction=jbx.dom.style.SideName[direction];for(i=0,l=prefix.length;i<l;i++){realdir=direction;if(prefix[i]==''){switch(direction){case'top':realdir='to bottom';break;case'right':realdir='to left';break;case'bottom':realdir='to top';break;default:realdir='to right';break;}}el.style['backgroundImage']=prefix[i]+'linear-gradient('+realdir+', '+colors.join(', ')+')';if(el.style['backgroundImage']){return true;}}return false;};jbx[H][I].setBoxSizing=function(el,value){if('boxSizing'in el.style){el.style.boxSizing=value;return true;}else
if('MozBoxSizing'in el.style){el.style.MozBoxSizing=value;return true;}else
if('WebkitBoxSizing'in el.style){el.style.WebkitBoxSizing=value;return true;}else
if('MsBoxSizing'in el.style){el.style.MsBoxSizing=value;return true;}return false;};jbx[H][I].setSize=function(el,width,height){var border=null,padding=null;if(jbx.dom.style.getBoxSizing(el)=='content-box'){border=jbx.dom.style.getBoxProperty(el,'border');padding=jbx.dom.style.getBoxProperty(el,'padding');width=width-border.x-border.x2-padding.x-padding.x2;height=height-border.y-border.y2-padding.y-padding.y2;}width=Math.max(0,width);height=Math.max(0,height);el.style.width=Math.round(width)+'px';el.style.height=Math.round(height)+'px';};jbx[H][I].setBorderBoxSize=function(el,width,height){jbx.dom.style.setSize(el,width,height);};jbx[H][I].setContentBoxSize=function(el,width,height){var border=null,padding=null;if(jbx.dom.style.getBoxSizing(el)!='content-box'){border=jbx.dom.style.getBoxProperty(el,'border'),padding=jbx.dom.style.getBoxProperty(el,'padding'),width=width+border.x+border.x2+padding.x+padding.x2;height=height+border.y+border.y2+padding.y+padding.y2;}width=Math.max(0,width);height=Math.max(0,height);el.style.width=Math.round(width)+'px';el.style.height=Math.round(height)+'px';};jbx[H][I].setPosition=function(el,top,left){el.style.top=Math.round(top)+'px';el.style.left=Math.round(left)+'px';};jbx[H][I].setGlobalPosition=function(el,top,left){var pos=null,scroll=null,margin=null,off=el.offsetParent,doc=jbx.dom.getDocument(),vpt=jbx.dom.getViewport(),pt=new jbx.math.Point(Math.round(left),Math.round(top));if(off&&off!=doc&&off!=doc.body&&off!=vpt){pt=pt.globalToLocal(off);pt.y+=off.scrollTop;pt.x+=off.scrollLeft;}margin=jbx.dom.style.getBoxProperty(el,'margin');pt.y-=margin.y;pt.x-=margin.x;pos=jbx.dom.style.getStyle(el,'position');if(pos=='fixed'){scroll=jbx.dom.style.getDocumentScroll();pt.y-=scroll.y;pt.x-=scroll.x;}jbx.dom.style.setPosition(el,pt.y,pt.x);};jbx[H][I].setBounds=function(el,top,left,width,height,isRegion){jbx.dom.style.setSize(el,width,height,isRegion);jbx.dom.style.setGlobalPosition(el,top,left);};jbx[H][I].setScroll=function(el,scrollX,scrollY){var vpt=null;if(jbx.dom.isDocument(el)){vpt=jbx.dom.getViewport(el);vpt.scrollTop=scrollY;vpt.scrollLeft=scrollX;el.body.scrollTop=scrollY;el.body.scrollLeft=scrollX;}else{el.scrollTop=scrollY;el.scrollLeft=scrollX;}};jbx[H][I].align=function(source,target,sides,distanceX,distanceY,onscreen){var vpts=null,el=source instanceof jbx.math.Rect?null:source;source=source instanceof jbx.math.Rect?source.clone():jbx.dom.style.getBounds(source);target=target instanceof jbx.math.Rect?target.clone():jbx.dom.style.getBounds(target);source.setCoordinate(0,0);distanceX=distanceX||0;distanceY=distanceY||0;if((distanceX+'').substr(-1)=='%'){distanceX=source.width*parseInt(distanceX,10)/100;}if((distanceY+'').substr(-1)=='%'){distanceY=source.height*parseInt(distanceY,10)/100;}distanceX=parseInt(distanceX,10);distanceY=parseInt(distanceY,10);source.x=Math.round(target.x+(target.width/2)-(source.width/2));source.y=Math.round(target.y+(target.height/2)-(source.height/2));if(sides&jbx.dom.style.Side.TOP){source.y=target.y-source.height-distanceY;}if(sides&jbx.dom.style.Side.LEFT){source.x=target.x-source.width-distanceX;}if(sides&jbx.dom.style.Side.RIGHT){source.x=target.x+target.width+distanceX;}if(sides&jbx.dom.style.Side.BOTTOM){source.y=target.y+target.height+distanceY;}if(onscreen!==false){vpts=jbx.dom.style.getViewportSize(el);if(source.y+source.height>vpts.y+vpts.height){if(source.x+source.width<=target.x||source.x>=target.x+target.width){source.y=vpts.y+vpts.height-source.height;}else{source.y=target.y-source.height-distanceY;}}if(source.y<vpts.y){if(source.x+source.width<=target.x||source.x>=target.x+target.width){source.y=vpts.y;}else{source.y=target.y+target.height+distanceY;}}if(source.x+source.width>vpts.x+vpts.width){if(source.y+source.height<=target.y||source.y>=target.y+target.height){source.x=vpts.x+vpts.width-source.width;}else{source.x=target.x-source.width+distanceX;}}if(source.x<vpts.x){if(source.y+source.height<=target.y||source.y>=target.y+target.height){source.x=vpts.x;}else{source.x=target.x+target.width+distanceX;}}}el&&jbx.dom.style.setGlobalPosition(el,source.y,source.x);return new jbx.math.Point(source.x,source.y);};jbx[H][J].get=function(el){if(jbx.isString(el.className)){return jbx.string.trim(el.className)==''?[]:el.className.split(/\s+/g);}return[];};jbx[H][J].set=function(el,name){el.className=name;};jbx[H][J].has=function(el,name){if('classList'in el){return el.classList.contains(name);}else{var re=new RegExp('(^|\\s+)'+jbx.string.escapeRegExp(name)+'(\\s+|$)','g');return re.test(el.className);}};jbx[H][J].add=function(el,name){if('classList'in el){el.classList.add(name);}else{if(!jbx.dom.classes.has(el,name)){if(el.className==''){el.className=name;}else{el.className=[jbx.string.trim(el.className),name].join(' ');}}}};jbx[H][J].remove=function(el,name){if('classList'in el){el.classList.remove(name);}else{var re=new RegExp('(^|\\s+)?'+jbx.string.escapeRegExp(name)+'(\\s+|$)?','g');el.className=jbx.string.trim(el.className.replace(re,' '));}};jbx[H][J].swap=function(el,from,to){if(jbx.dom.classes.has(el,from)){jbx.dom.classes.remove(el,from);jbx.dom.classes.add(el,to);}};jbx[H][J].toggle=function(el,name){if('classList'in el){el.classList.toggle(name);}else{jbx.dom.classes.has(el,name)?jbx.dom.classes.remove(el,name):jbx.dom.classes.add(el,name);}};jbx.dom.query.reSelector='[#.]';jbx.dom.query.reIdentifier='[^#.\\[:][\\w-]*';jbx.dom.query.reID=new RegExp('^#('+jbx.dom.query.reIdentifier+')');jbx.dom.query.reTAG=new RegExp('^('+jbx.dom.query.reIdentifier+'|\\*)');jbx.dom.query.reCLASS=new RegExp('^\\.('+jbx.dom.query.reIdentifier+')');jbx.dom.query.rePSEUDO=new RegExp('^:('+jbx.dom.query.reIdentifier+')(\\((.*)\\))?');jbx.dom.query.reATTRIBUTE=new RegExp('^\\[ *('+jbx.dom.query.reIdentifier+') *(([~|^$*])?= *(('+jbx.dom.query.reIdentifier+')|"([^"]*)"|\'([^\']*)\'))? *\\]');jbx.dom.query.reConcat=new RegExp('^ *, *');jbx.dom.query.reCombinator=new RegExp('^ *([>+~ ]) *');jbx[H][K].get=function(query,context){context=context||jbx.dom.getDocument();return jbx.dom.query.support(query)?Array.prototype.slice.call(context.querySelectorAll(query)):jbx.dom.query.querySelectorAll(query,context);};jbx[H][K].support=function(query){if(!document.querySelectorAll){return false;}if(query.match(/:(selected|readonly|read-only)/)){return false;}return true;};jbx[H][K].querySelectorAll=function(query,context){var i=0,j=0,concat=false,results=[],tokens=jbx.dom.query.parseQuery(query),len=tokens.length;context=context||jbx.dom.getDocument();if(!len||[jbx.dom.NodeType.ELEMENT,jbx.dom.NodeType.DOCUMENT].indexOf(context.nodeType)<0){return[];}for(i=0;i<len;i++){if(i==0||concat){results=results.concat(jbx.dom.query['findElementsBy'+tokens[i].type](context,tokens[i]));concat=false;}else
if(tokens[i].type=='Concat'){concat=true;}else
if(tokens[i].type=='Combinator'){switch(tokens[i].value){case'+':results=jbx.dom.query.getDirectSiblings(results);break;case'~':results=jbx.dom.query.getAnySiblings(results);break;case'>':results=jbx.dom.query.getDirectChilds(results);break;case' ':results=jbx.dom.query.getAnyChilds(results);break;}}else{results=jbx.dom.query['filterElementsBy'+tokens[i].type](results,tokens[i]);}if(!results.length){break;}}return results;};jbx[H][K].parseQuery=function(query){var match=null,result=[],goon=true,remain=jbx.string.trim(query);while(goon){goon=false;match=jbx.dom.query.reConcat.exec(remain);if(match){result.length&&result.push({type:'Concat'});remain=remain.slice(match[0].length);goon=true;}match=jbx.dom.query.reCombinator.exec(remain);if(match){if(result.length){if(result[result.length-1].type=='Combinator'){throw new Error("Invalid combinator");}result.push({type:'Combinator',value:match[1]});}else{throw new Error("Illegal combinator at query start");}remain=remain.slice(match[0].length);goon=true;}match=jbx.dom.query.reTAG.exec(remain);if(match){result.push({type:'TagName',value:match[1]});remain=remain.slice(match[0].length);goon=true;}match=jbx.dom.query.reID.exec(remain);if(match){result.push({type:'Id',value:match[1]});remain=remain.slice(match[0].length);goon=true;}match=jbx.dom.query.reCLASS.exec(remain);if(match){result.push({type:'ClassName',value:match[1]});remain=remain.slice(match[0].length);goon=true;}match=jbx.dom.query.rePSEUDO.exec(remain);if(match){result.push({type:'PseudoClass',value:match[1],expr:match[3]});remain=remain.slice(match[0].length);goon=true;}match=jbx.dom.query.reATTRIBUTE.exec(remain);if(match){result.push({type:'Attribute',name:match[1],op:match[3],value:match[5]||match[6]||match[7]});remain=remain.slice(match[0].length);goon=true;}}if(remain.length){throw new Error("Invalid or illegal query string");}return result;};jbx[H][K].findElementsByTagName=function(context,token){return Array.prototype.slice.call(context.getElementsByTagName(token.value));};jbx[H][K].findElementsByClassName=function(context,token){return context.getElementsByClassName?Array.prototype.slice.call(context.getElementsByClassName(token.value)):jbx.dom.query.filterElementsByClassName(context.getElementsByTagName('*'),token);};jbx[H][K].findElementsById=function(context,token){return jbx.dom.query.filterElementsById(context.getElementsByTagName('*'),token);};jbx[H][K].findElementsByAttribute=function(context,token){return jbx.dom.query.filterElementsByAttribute(context.getElementsByTagName('*'),token);};jbx[H][K].findElementsByPseudoClass=function(context,token){return jbx.dom.query.filterElementsByPseudoClass(context.getElementsByTagName('*'),token);};jbx[H][K].filterElementsById=function(nodes,token){var i=0,result=[],len=nodes.length;for(i=0;i<len;i++){if(nodes[i].getAttribute&&nodes[i].getAttribute('id')==token.value){result.push(nodes[i]);}}return result;};jbx[H][K].filterElementsByTagName=function(nodes,token){var i=0,result=[],len=nodes.length;if(token.value=='*'){return nodes;}for(i=0;i<len;i++){if(nodes[i].nodeName==token.value.toUpperCase()){result.push(nodes[i]);}}return result;};jbx[H][K].filterElementsByClassName=function(nodes,token){var i=0,result=[],len=nodes.length;for(i=0;i<len;i++){if(jbx.dom.classes.has(nodes[i],token.value)){result.push(nodes[i]);}}return result;};jbx[H][K].filterElementsByAttribute=function(nodes,token){var i=0,attr=null,result=[],len=nodes.length;for(i=0;i<len;i++){attr=nodes[i].getAttribute&&nodes[i].getAttribute(token.name);if(attr!==null&&attr!==undefined){if(token.value){switch(token.op){case'^':attr&&attr.indexOf(token.value)==0&&result.push(nodes[i]);break;case'*':attr&&attr.indexOf(token.value)>=0&&result.push(nodes[i]);break;case'$':attr&&attr.slice(token.value.length*-1)==token.value&&result.push(nodes[i]);break;case'~':attr&&token.value.indexOf(' ')<0&&attr.split(' ').indexOf(token.value)>=0&&result.push(nodes[i]);break;case'|':(attr==token.value||attr.indexOf(token.value+'-')==0)&&result.push(nodes[i]);break;default:attr==token.value&&result.push(nodes[i]);}}else{result.push(nodes[i]);}}}return result;};jbx[H][K].filterElementsByPseudoClass=function(nodes,token){var i=0,attr=null,result=[],match=null,len=nodes.length,pseudo=token.value.toLowerCase();for(i=0;i<len;i++){switch(pseudo){case'checked':(!!nodes[i].checked||!!nodes[i].selected)&&result.push(nodes[i]);break;case'selected':!!nodes[i].selected&&result.push(nodes[i]);break;case'disabled':!!nodes[i].disabled&&result.push(nodes[i]);break;case'empty':!nodes[i].firstChild&&result.push(nodes[i]);break;case'enabled':nodes[i].disabled!=undefined&&!nodes[i].disabled&&result.push(nodes[i]);break;case'focus':nodes[i]==jbx.dom.getDocument(nodes[i]).activeElement&&result.push(nodes[i]);break;case'optional':nodes[i].required!=undefined&&!nodes[i].required&&result.push(nodes[i]);break;case'readonly':case'read-only':!!nodes[i].readOnly&&result.push(nodes[i]);break;case'required':!!nodes[i].required&&result.push(nodes[i]);break;case'first-child':jbx.dom.firstChild(nodes[i].parentNode)==nodes[i]&&result.push(nodes[i]);break;case'first-of-type':jbx.dom.getFirstOfType(nodes[i].parentNode).indexOf(nodes[i])>=0&&result.push(nodes[i]);break;case'last-child':jbx.dom.lastChild(nodes[i].parentNode)==nodes[i]&&result.push(nodes[i]);break;case'last-of-type':jbx.dom.getFirstOfType(nodes[i].parentNode,true).indexOf(nodes[i])>=0&&result.push(nodes[i]);break;case'not':jbx.dom.query.get(token.expr,nodes[i].parentNode).indexOf(nodes[i])<0&&result.push(nodes[i]);break;case'nth-child':jbx.dom.getOrdinalElements(nodes[i].parentNode,token.expr).indexOf(nodes[i])>=0&&result.push(nodes[i]);break;case'nth-last-child':jbx.dom.getOrdinalElements(nodes[i].parentNode,token.expr,true).indexOf(nodes[i])>=0&&result.push(nodes[i]);break;case'nth-of-type':jbx.dom.getOrdinalElements(nodes[i].parentNode,token.expr,false,true).indexOf(nodes[i])>=0&&result.push(nodes[i]);break;case'nth-last-of-type':jbx.dom.getOrdinalElements(nodes[i].parentNode,token.expr,true,true).indexOf(nodes[i])>=0&&result.push(nodes[i]);break;case'only-child':jbx.dom.firstChild(nodes[i].parentNode)==nodes[i]&&!jbx.dom.nextElement(jbx.dom.firstChild(nodes[i].parentNode))&&result.push(nodes[i]);break;case'only-of-type':throw new Error('only-of-type pseudoclass selector not implemented');break;case'root':nodes[i]==jbx.dom.getViewport()&&result.push(nodes[i]);break;}}return result;};jbx[H][K].getDirectSiblings=function(elements){var i=0,el=null,len=elements.length,result=[];for(i=0;i<len;i++){el=jbx.dom.nextElement(elements[i]);el&&result.push(el);}return result;};jbx[H][K].getAnySiblings=function(elements){var i=0,el=null,len=elements.length,result=[];for(i=0;i<len;i++){el=jbx.dom.nextElement(elements[i]);while(el){el&&result.indexOf(el)<0&&result.push(el);el=jbx.dom.nextElement(el);}}return result;};jbx[H][K].getDirectChilds=function(elements){var i=0,el=null,len=elements.length,result=[];for(i=0;i<len;i++){el=jbx.dom.firstChild(elements[i]);while(el){el&&result.indexOf(el)<0&&result.push(el);el=jbx.dom.nextElement(el);}}return result;};jbx[H][K].getAnyChilds=function(elements){var i=0,j=0,len=elements.length,result=[];for(i=0;i<len;i++){childs=elements[i].getElementsByTagName('*');for(j=0;j<childs.length;j++){result.indexOf(childs[j])<0&&result.push(childs[j]);}}return result;};jbx[H].NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};jbx[H].NodeName={TEXT:'#text',COMMENT:'#comment',DOCUMENT:'#document',DOCUMENT_FRAGMENT:'#document-fragment',CDATA_SECTION:'#cdata-section'};jbx[H].TreeWalker={PARENT_NODE:'parentNode',FIRST_CHILD:'firstChild',LAST_CHILD:'lastChild',PREVIOUS_SIBLING:'previousSibling',NEXT_SIBLING:'nextSibling',PREVIOUS_NODE:'previousNode',NEXT_NODE:'nextNode'};jbx[H].isNode=function(node){return!!node&&node.nodeType>0;};jbx[H].isElement=function(node){return jbx.dom.isNode(node)&&node.nodeType==jbx.dom.NodeType.ELEMENT;};jbx[H].isDocument=function(node){return jbx.dom.isNode(node)&&node.nodeType==jbx.dom.NodeType.DOCUMENT;};jbx[H].isDocumentStrictMode=function(doc){doc=doc||document;return doc.compatMode=="CSS1Compat";};jbx[H].get=function(query,context){return jbx.dom.query.get(query,context);};jbx[H].getElement=function(value,doc){doc=doc||document;return jbx.isString(value)?doc.getElementById(value):value;};jbx[H].getDocument=function(node){node=node||document;return node.nodeType==jbx.dom.NodeType.DOCUMENT?node:node.contentDocument||node.ownerDocument||node.document||document;};jbx[H].getViewport=function(node){var doc=jbx.dom.getDocument(node);return jbx.dom.isDocumentStrictMode(doc)?doc.documentElement:doc.body;};jbx[H].getWindow=function(node){var doc=jbx.dom.getDocument(node);return doc.parentWindow||doc.defaultView||window;};jbx[H].getFirstOfType=function(context,reverse){var i=0,result=[],visited=[],el=jbx.dom[reverse?'lastChild':'firstChild'](context),method=reverse?'previousElement':'nextElement';while(el){if(visited.indexOf(el.nodeName)<0){visited.push(el.nodeName);result.push(el);}el=jbx.dom[method](el);}return result;};jbx[H].getOrdinalElements=function(context,expr,reverse,bytype){var a=0,b=0,n=0,i=0,p=[],el=null,type='',result=[],childs={},match=expr.match(/^(even|odd|(\d*)|(-?\d*)n([+-]\d+)?)$/);if(match){el=jbx.dom.firstChild(context);while(el){type=bytype?e.nodeName:'--';childs[type]=childs[type]||[];childs[type].push(el);el=jbx.dom.nextElement(el);}if(reverse){for(type in childs){childs[type].reverse();}}if(match[2]){for(type in childs){result.push(childs[type][parseInt(match[2],10)-1]);}}else{switch(match[1]){case'odd':match[4]=1;case'even':match[3]=2;}if(match[3]=='-'){match[3]=-1;}b=parseInt(match[4]||0,10);a=parseInt(match[3]||0,10);if(a>0||b>0){for(type in childs){for(n=0;n<childs[type].length;n++){i=(a*n)+b;result.push(childs[type][i-1]);p.push(i);}}}}}return result;};jbx[H].setAttributes=function(el,attr){for(var a in attr){switch(a){case'for':el.htmlFor=attr[a];break;case'class':el.className=attr[a];break;case'style':jbx.dom.style.setStyles(el,attr[a]);break;default:el.setAttribute(a,attr[a]);el[a]=attr[a];}}};jbx[H].resolveNode=function(node,method,test){method=method||jbx.dom.TreeWalker.NEXT_SIBLING;test=test||jbx.dom.isElement;while(node&&!test(node)){node=node[method];}return node;};jbx[H].nextElement=function(node){return jbx.dom.resolveNode(node.nextSibling);};jbx[H].previousElement=function(node){return jbx.dom.resolveNode(node.previousSibling,jbx.dom.TreeWalker.PREVIOUS_SIBLING);};jbx[H].firstChild=function(node){return jbx.dom.resolveNode(node.firstChild,jbx.dom.TreeWalker.NEXT_SIBLING);};jbx[H].lastChild=function(node){node=node.lastChild;return jbx.dom.resolveNode(node,jbx.dom.TreeWalker.NEXT_SIBLING)||jbx.dom.resolveNode(node,jbx.dom.TreeWalker.PREVIOUS_SIBLING);};jbx[H].insertBefore=function(node,ref){ref&&ref.parentNode&&ref.parentNode.insertBefore(node,ref);};jbx[H].insertAfter=function(node,ref){var next=null;if(ref&&ref.parentNode){next=ref.nextSibling;next?ref.parentNode.insertBefore(node,next):ref.parentNode.appendChild(node);}};jbx[H].insertAt=function(parent,node,index){var sibling=parent.childNodes[index];sibling?parent.insertBefore(node,sibling):parent.appendChild(node);};jbx[H].insertElementAt=function(parent,node,index){var current=0,sibling=jbx.dom.firstChild(parent);while(current<index&&sibling){sibling=jbx.dom.nextElement(sibling);current++;}sibling?parent.insertBefore(node,sibling):parent.appendChild(node);};jbx[H].createElement=function(name,attr){var el=null;if(attr&&(attr.type||attr.name)){name=['<',name];if(attr.name){name.push(' name="'+jbx.string.htmlEntities(attr.name)+'"');delete attr.name;}if(attr.type){name.push(' type="'+jbx.string.htmlEntities(attr.type)+'"');delete attr.type;}name.push('>');el=document.createElement('DIV');el.innerHTML=name.join('');el=jbx.dom.firstChild(el);}else{el=document.createElement(name);}attr&&jbx.dom.setAttributes(el,attr);return el;};jbx[H].contains=function(parent,child){if(parent==child){return true;}else
if(parent.contains){return parent.contains(child);}else
if(parent.compareDocumentPosition){return!!(parent.compareDocumentPosition(child)&16);}else{while(child&&parent!=child){child=child.parentNode;}return child==parent;}};jbx[H][L].isAndroid=function(){return navigator.userAgent.indexOf('Android')>=0;};jbx[H][L].isIOS=function(){return navigator.userAgent.indexOf('iPod')>=0||navigator.userAgent.indexOf('iPad')>=0||navigator.userAgent.indexOf('iPhone')>=0;};jbx[H][L].isLinux=function(){return navigator.userAgent.indexOf('Linux')>=0;};jbx[H][L].isMac=function(){return navigator.userAgent.indexOf('Macintosh')>=0;};jbx[H][L].isWindows=function(){return navigator.userAgent.indexOf('Windows')>=0;};jbx[H][L].isChrome=function(){return!jbx.dom.browser.isOpera()&&navigator.userAgent.indexOf('Chrome')>=0;};jbx[H][L].isFirefox=function(){return navigator.userAgent.indexOf('Firefox')>=0;};jbx[H][L].isIE=function(){return navigator.userAgent.indexOf('MSIE')>=0;};jbx[H][L].isOpera=function(){return navigator.userAgent.indexOf('Opera')>=0||navigator.userAgent.indexOf('OPR/')>=0;};jbx[H][L].isSafari=function(){return!jbx.dom.browser.isOpera()&&!jbx.dom.browser.isChrome()&&!jbx.dom.browser.isAndroid()&&navigator.userAgent.indexOf('Safari')>=0;};jbx[H][L].isWebkit=function(){return navigator.userAgent.indexOf('WebKit')>=0;};jbx[H][L].isGecko=function(){return!jbx.dom.browser.isWebkit()&&!jbx.dom.browser.isIE()&&navigator.userAgent.indexOf('Gecko')!=-1;};jbx[k][l]=function(){};jbx.base.Object.prototype.isObject=true;jbx.base.Object.prototype.classParent='Object';jbx.base.Object.prototype.className='jbx.base.Object';jbx.base.Object.prototype.styleName='jbx-base-Object';jbx[k][l].Super=function(scope,method,args){};jbx[k][l][A].free=function(){};jbx[k][l][A].toString=function(){return'[object '+this.className+']';};jbx[Z][a]=function(type,dic){jbx.events.Event.Super(this,'constructor');this.initEvent(type,dic);};jbx.extends('jbx.events.Event','jbx.base.Object');jbx.events.Event.OPEN='open';jbx.events.Event.COMPLETE='complete';jbx.events.Event.ERROR='error';jbx.events.Event.READY='ready';jbx.events.Event.BEFORECUT='beforecut';jbx.events.Event.BEFOREPASTE='beforepaste';jbx.events.Event.CUT='cut';jbx.events.Event.PASTE='paste';jbx.events.Event.CHANGE='change';jbx.events.Event.SELECT='select';jbx.events.Event.SCROLL='scroll';jbx.events.Event.ABORT='abort';jbx.events.Event.LOAD='load';jbx.events.Event.UNLOAD='unload';jbx.events.Event.PROGRESS='progress';jbx.events.Event.STATECHANGE='statechange';jbx.events.Event.prototype.type='';jbx.events.Event.prototype.phase=0;jbx.events.Event.prototype.target=null;jbx.events.Event.prototype.currentTarget=null;jbx.events.Event.prototype.bubbles=false;jbx.events.Event.prototype.cancelable=true;jbx.events.Event.prototype.killed=false;jbx.events.Event.prototype.stopped=false;jbx.events.Event.prototype.canceled=false;jbx.events.Event.prototype.event=null;jbx[Z][a][A].free=function(){this.initEvent();jbx.events.Event.Super(this,'free');};jbx[Z][a][A].initEvent=function(type,dic){dic=dic||{};type=type||'';this.phase=0;this.type=type;this.event=null;this.target=null;this.currentTarget=null;this.killed=false;this.stopped=false;this.canceled=false;this.bubbles=dic.bubbles==true;this.cancelable=dic.cancelable!==false;};jbx[Z][a][A].setEvent=function(e,skipTargetResolve){this.event=e;if(skipTargetResolve!==false){this.target=jbx.dom.resolveNode(e.target||e.srcElement,jbx.dom.TreeWalker.PARENT_NODE);this.currentTarget=this.target;}};jbx[Z][a][A].stopPropagation=function(){this.stopped=true;if(this.event){if(this.event.stopPropagation){this.event.stopPropagation();}else{this.event.cancelBubble=true;}}};jbx[Z][a][A].stopImmediatePropagation=function(){this.killed=true;this.stopPropagation();};jbx[Z][a][A].preventDefault=function(){if(this.cancelable){this.canceled=true;if(this.event){if(this.event.preventDefault){this.event.preventDefault();}else{this.event.returnValue=false;}}}};jbx[Z][b]=function(src,type,handler,scope,capture){this.src=src;this.type=type;this.scope=scope||src;this.capture=!!capture;this.handler=handler;this.lastKey=null;this.lastKeyCode=0;this.lastKeyLocation=0;this.handleOnKeypress=false;jbx.events.Listener.Super(this,'constructor');};jbx.extends('jbx.events.Listener','jbx.base.Object');jbx.events.Listener.prototype.src=null;jbx.events.Listener.prototype.type=null;jbx.events.Listener.prototype.scope=null;jbx.events.Listener.prototype.capture=false;jbx.events.Listener.prototype.handler=null;jbx.events.Listener.prototype.lastKey=null;jbx.events.Listener.prototype.lastKeyCode=0;jbx.events.Listener.prototype.lastKeyLocation=0;jbx.events.Listener.prototype.handleOnKeypress=false;jbx[Z][b][A].free=function(){this.src=null;this.type=null;this.scope=null;this.handler=null;jbx.events.Listener.Super(this,'free');};jbx[Z][b][A].handleEvent=function(e){return this.handler.call(this.scope,e);};jbx[Z][c]=function(type,dic){jbx.events.TouchEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.TouchEvent','jbx.events.Event');jbx.events.TouchEvent.TOUCHSTART='touchstart';jbx.events.TouchEvent.TOUCHEND='touchend';jbx.events.TouchEvent.TOUCHMOVE='touchmove';jbx.events.TouchEvent.TOUCHCANCEL='touchcancel';jbx.events.TouchEvent.prototype.altKey=false;jbx.events.TouchEvent.prototype.metaKey=false;jbx.events.TouchEvent.prototype.ctrlKey=false;jbx.events.TouchEvent.prototype.shiftKey=false;jbx.events.TouchEvent.prototype.touches=null;jbx.events.TouchEvent.prototype.targetTouches=null;jbx.events.TouchEvent.prototype.changedTouches=null;jbx[Z][c][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=dic.bubbles!==false;jbx.events.TouchEvent.Super(this,'initEvent',type,dic);this.altKey=!!dic.altKey;this.ctrlKey=!!dic.ctrlKey;this.metaKey=!!dic.metaKey;this.shiftKey=!!dic.shiftKey;this.touches=dic.touches||null;this.targetTouches=dic.targetTouches||null;this.changedTouches=dic.changedTouches||null;};jbx[Z][c][A].setEvent=function(e){jbx.events.TouchEvent.Super(this,'setEvent',e);this.altKey=e.altKey;this.ctrlKey=e.ctrlKey;this.metaKey=e.metaKey;this.shiftKey=e.shiftKey;this.touches=e.touches||[];this.targetTouches=e.targetTouches||[];this.changedTouches=e.changedTouches||[];};jbx[Z][d]=function(type,dic){jbx.events.FocusEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.FocusEvent','jbx.events.Event');jbx.events.FocusEvent.BLUR='blur';jbx.events.FocusEvent.FOCUS='focus';jbx.events.FocusEvent.prototype.relatedTarget=null;jbx[Z][d][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=dic.bubbles!==false;jbx.events.FocusEvent.Super(this,'initEvent',type,dic);this.relatedTarget=dic.relatedTarget||null;};jbx[Z][d][A].setEvent=function(e){jbx.events.FocusEvent.Super(this,'setEvent',e);this.relatedTarget=e.relatedTarget;};jbx[Z][e]=function(type,dic){jbx.events.MouseEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.MouseEvent','jbx.events.Event');jbx.events.MouseEvent.BUTTON_LEFT=1;jbx.events.MouseEvent.BUTTON_RIGHT=2;jbx.events.MouseEvent.BUTTON_MIDDLE=4;jbx.events.MouseEvent.CLICK='click';jbx.events.MouseEvent.DBLCLICK='dblclick';jbx.events.MouseEvent.MOUSEUP='mouseup';jbx.events.MouseEvent.MOUSEDOWN='mousedown';jbx.events.MouseEvent.MOUSEOUT='mouseout';jbx.events.MouseEvent.MOUSEOVER='mouseover';jbx.events.MouseEvent.MOUSEMOVE='mousemove';jbx[Z][e].MOUSEWHEEL=(function(){var event='';try{event=WheelEvent&&'wheel';}catch(e){event=document.onmousewheel!==undefined?'mousewheel':'DOMMouseScroll';}return event;})();jbx[Z][e]._w3_to_ie_button={0:1,1:4,2:2};jbx[Z][e]._wheel_events={wheel:1,mousewheel:1,DOMMouseScroll:1};jbx.events.MouseEvent.prototype.screenX=0;jbx.events.MouseEvent.prototype.screenY=0;jbx.events.MouseEvent.prototype.clientX=0;jbx.events.MouseEvent.prototype.clientY=0;jbx.events.MouseEvent.prototype.offsetX=0;jbx.events.MouseEvent.prototype.offsetY=0;jbx.events.MouseEvent.prototype.deltaX=0;jbx.events.MouseEvent.prototype.deltaY=0;jbx.events.MouseEvent.prototype.deltaZ=0;jbx.events.MouseEvent.prototype.deltaMode=0;jbx.events.MouseEvent.prototype.altKey=false;jbx.events.MouseEvent.prototype.ctrlKey=false;jbx.events.MouseEvent.prototype.metaKey=false;jbx.events.MouseEvent.prototype.shiftKey=false;jbx.events.MouseEvent.prototype.button=0;jbx.events.MouseEvent.prototype.buttons=0;jbx.events.MouseEvent.prototype.relatedTarget=null;jbx[Z][e][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=dic.bubbles!==false;jbx.events.MouseEvent.Super(this,'initEvent',type,dic);this.clientX=dic.clientX||0;this.clientY=dic.clientY||0;this.screenX=dic.screenX||0;this.screenY=dic.screenY||0;this.offsetX=dic.offsetX||0;this.offsetY=dic.offsetY||0;this.deltaX=dic.deltaX||0;this.deltaY=dic.deltaY||0;this.deltaZ=dic.deltaZ||0;this.deltaMode=dic.deltaMode||0;this.button=dic.button||0;this.buttons=dic.buttons||0;this.altKey=!!dic.altKey;this.ctrlKey=!!dic.ctrlKey;this.metaKey=!!dic.metaKey;this.shiftKey=!!dic.shiftKey;this.relatedTarget=dic.relatedTarget||null;};jbx[Z][e][A].setEvent=function(e){jbx.events.MouseEvent.Super(this,'setEvent',e);this.relatedTarget=e.relatedTarget;if(!this.relatedTarget){if(this.type==jbx.events.MouseEvent.MOUSEOVER){this.relatedTarget=e.fromElement;}else
if(this.type==jbx.events.MouseEvent.MOUSEOUT){this.relatedTarget=e.toElement;}}this.altKey=e.altKey;this.ctrlKey=e.ctrlKey;this.metaKey=e.metaKey;this.shiftKey=e.shiftKey;this.button=jbx.events.MouseEvent._w3_to_ie_button[e.button]||e.button||0;this.buttons=jbx.isDefined(e.buttons)&&e.buttons>0?e.buttons:this.button;this.screenX=e.screenX||0;this.screenY=e.screenY||0;this.clientX=e.clientX||e.pageX||0;this.clientY=e.clientY||e.pageY||0;this.offsetX=e.offsetX||e.layerX||0;this.offsetY=e.offsetY||e.layerY||0;if(jbx.events.MouseEvent._wheel_events[e.type]){if(e.type=='wheel'){this.deltaX=e.deltaX;this.deltaY=e.deltaY;this.deltaZ=e.deltaZ;this.deltaMode=e.deltaMode;}else
if(e.type=='mousewheel'){this.deltaMode=0;this.deltaY=-e.wheelDelta/40;this.deltaY=e.wheelDeltaX?-e.wheelDeltaX/40:0;}else{this.deltaMode=0;if(jbx.isDefined(e.axis)&&e.axis===be.HORIZONTAL_AXIS){this.deltaX=e.detail;}else{this.deltaY=e.detail;}}}};jbx[Z][f]=function(type,dic){jbx.events.KeyboardEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.KeyboardEvent','jbx.events.Event');jbx.events.KeyboardEvent.KEYDOWN='keydown';jbx.events.KeyboardEvent.KEYUP='keyup';jbx.events.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0;jbx.events.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1;jbx.events.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2;jbx.events.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3;jbx[Z][f].KeyCode={Unidentified:0,Backspace:8,Tab:9,Clear:12,Enter:13,Shift:16,Control:17,Alt:18,Pause:19,CapsLock:20,Esc:27,Escape:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,ArrowLeft:37,Up:38,ArrowUp:38,Right:39,ArrowRight:39,Down:40,ArrowDown:40,PrintScreen:44,Insert:45,Delete:46,Meta:91,OS:92,ContextMenu:93,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NumLock:144,ScrollLock:145};jbx[Z][f].ModifierKeyName={8:'Backspace',9:'Tab',12:'Clear',13:'Enter',16:'Shift',17:'Control',18:'Alt',19:'Pause',20:'CapsLock',27:'Escape',33:'PageUp',34:'PageDown',35:'End',36:'Home',37:'ArrowLeft',38:'ArrowUp',39:'ArrowRight',40:'ArrowDown',44:'PrintScreen',45:'Insert',46:'Delete',91:'Meta',92:'Meta',93:'ContextMenu',112:'F1',113:'F2',114:'F3',115:'F4',116:'F5',117:'F6',118:'F7',119:'F8',120:'F9',121:'F10',122:'F11',123:'F12',144:'NumLock',145:'ScrollLock',224:'Meta'};jbx[Z][f].PrintableKeys={Spacebar:' ',Multiply:'*',Add:'+',Subtract:'-',Decimal:'.',Divide:'/',Equals:'='};jbx.events.KeyboardEvent.prototype.key='';jbx.events.KeyboardEvent.prototype.location=0;jbx.events.KeyboardEvent.prototype.keyCode=null;jbx.events.KeyboardEvent.prototype.altKey=false;jbx.events.KeyboardEvent.prototype.ctrlKey=false;jbx.events.KeyboardEvent.prototype.metaKey=false;jbx.events.KeyboardEvent.prototype.shiftKey=false;jbx.events.KeyboardEvent.prototype.repeat=false;jbx[Z][f][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=dic.bubbles!==false;jbx.events.KeyboardEvent.Super(this,'initEvent',type,dic);this.key=dic.key||'';this.location=dic.location||0;this.keyCode=dic.keyCode||0;this.repeat=!!dic.repeat;this.altKey=!!dic.altKey;this.ctrlKey=!!dic.ctrlKey;this.metaKey=!!dic.metaKey;this.shiftKey=!!dic.shiftKey;};jbx[Z][f][A].setEvent=function(e){jbx.events.KeyboardEvent.Super(this,'setEvent',e);};jbx.events._listeners={};jbx.events._keyCodes={};jbx.events._cachedKeys={};jbx.events._unicodeKeys={};jbx.events._fireKeypress={};jbx[Z].KeyboardEventTypes={keyup:true,keydown:true,keypress:true};jbx[Z].Phase={NONE:0,CAPTURE:1,TARGET:2,BUBBLE:3};jbx[Z].EventTypeInterface={load:'Event',unload:'Event',abort:'Event',error:'Event',select:'Event',resize:'Event',scroll:'Event',blur:'FocusEvent',focus:'FocusEvent',focusin:'FocusEvent',focusout:'FocusEvent',click:'MouseEvent',dblclick:'MouseEvent',mouseup:'MouseEvent',mousedown:'MouseEvent',mouseover:'MouseEvent',mouseout:'MouseEvent',mousemove:'MouseEvent',mouseenter:'MouseEvent',mouseleave:'MouseEvent',wheel:'MouseEvent',mousewheel:'MosuseEvent',dommousescroll:'MouseEvent',keydown:'KeyboardEvent',keyup:'KeyboardEvent',keypress:'KeyboardEvent',touchend:'TouchEvent',touchmove:'TouchEvent',touchstart:'TouchEvent',touchcancel:'TouchEvent'};jbx[Z].getNormalizedKeyCode=function(keyCode){var normalized=jbx.events.getNormalizedKeyInformation(keyCode);return normalized[0];};jbx[Z].getNormalizedKeyLocation=function(keyCode,location){var normalized=jbx.events.getNormalizedKeyInformation(keyCode);return normalized[1]>0?normalized[1]:location;};jbx[Z].getNormalizedKeyInformation=function(keyCode){var newCode=keyCode,newLocation=0;if(!jbx.isDefined(jbx.events._keyCodes[keyCode])){if(jbx.dom.browser.isGecko()){switch(keyCode){case 224:newCode=jbx.events.KeyboardEvent.KeyCode.Meta;break;case 59:newCode=186;break;case 61:newCode=187;break;case 173:newCode=189;break;}}else
if(keyCode==93&&jbx.dom.browser.isMac()){newCode=jbx.events.KeyboardEvent.KeyCode.Meta;newLocation=jbx.events.KeyboardEvent.DOM_KEY_LOCATION_RIGHT;}switch(keyCode){case 92:newCode=jbx.events.KeyboardEvent.KeyCode.Meta;newLocation=jbx.events.KeyboardEvent.DOM_KEY_LOCATION_RIGHT;break;}jbx.events._keyCodes[keyCode]=[newCode,newLocation];jbx.events._keyCodes[newCode]=[newCode,newLocation];}return jbx.events._keyCodes[keyCode];};jbx[Z].getUnicodeCharacter=function(key){if(!jbx.isDefined(jbx.events._unicodeKeys[key])){jbx.events._unicodeKeys[key]=null;if(key.match(/^U\+([0-9a-fA-F]{4})$/)){jbx.events._unicodeKeys[key]=String.fromCharCode(parseInt(RegExp.$1+'',16));}else
if(key&&jbx.string.countSymbols(key)==1){jbx.events._unicodeKeys[key]=key;}}return jbx.events._unicodeKeys[key];};jbx[Z].useKeypress=function(keyCode){if(!jbx.isDefined(jbx.events._fireKeypress[keyCode])){jbx.events._fireKeypress[keyCode]=(keyCode>=48&&keyCode<=57)||(keyCode>=96&&keyCode<=107)||(keyCode>=109&&keyCode<=111)||(keyCode>=65&&keyCode<=90)||(keyCode>=186&&keyCode<=192)||(keyCode>=219&&keyCode<=222);}return jbx.events._fireKeypress[keyCode];};jbx[Z].handleKeyboardEvent=function(l,e){return jbx.events['handle'+jbx.string.toUcFirst(e.type)+'Event'](l,e||window.event);};jbx[Z].handleCompositionstartEvent=function(l,e){l.composing=true;};jbx[Z].handleCompositionendEvent=function(l,e){l.composing=false;l.composedData=e.data;};jbx[Z].handleKeydownEvent=function(l,e){var keyCode=e.keyCode||0,keyLocation=e.location||e.keyLocation||0,identifier=e.key||e.keyIdentifier||'';l.handleOnKeypress=false;keyCode=jbx.events.getNormalizedKeyCode(keyCode);keyLocation=jbx.events.getNormalizedKeyLocation(keyCode,keyLocation);if(keyCode>0&&keyCode==l.lastKeyCode&&keyLocation==l.lastKeyLocation){return l.type=='keyup'||l.composing||jbx.events.fireKeyboardEvent(l,e,true);}l.lastKeyCode=keyCode;l.lastKeyLocation=keyLocation;l.lastKey=jbx.events.KeyboardEvent.ModifierKeyName[keyCode];if(!l.lastKey){if(identifier&&jbx.events.KeyboardEvent.PrintableKeys[identifier]){l.lastKey=jbx.events.KeyboardEvent.PrintableKeys[identifier];}else
if(e.char&&e.char==e.key&&!jbx.isEmpty(e.key)){l.lastKey=e.key;}else
if(e.keyIdentifier&&(e.ctrlKey||e.metaKey)){l.lastKey=jbx.events.getUnicodeCharacter(e.keyIdentifier);}else
if(e.key=='MozPrintableKey'||e.keyIdentifier){l.handleOnKeypress=true;}else
if(e.key){l.lastKey=jbx.events.getUnicodeCharacter(e.key);}else
if(jbx.events.useKeypress(keyCode)){l.handleOnKeypress=true;}}jbx.events._cachedKeys[l.lastKeyCode]=l.lastKey;if(l.type!='keyup'&&!l.handleOnKeypress&&!l.composing){return jbx.events.fireKeyboardEvent(l,e,false);}return true;};jbx[Z].handleKeyupEvent=function(l,e){var result=true,identifier='';if(l.type=='keyup'){identifier=e.key||e.keyIdentifier||'';l.lastKeyCode=jbx.events.getNormalizedKeyCode(e.keyCode||0);l.lastKeyLocation=jbx.events.getNormalizedKeyLocation(l.lastKeyCode,e.location||e.keyLocation||0);l.lastKey=jbx.events.KeyboardEvent.ModifierKeyName[l.lastKeyCode];if(l.composedData){l.lastKey=l.composedData;l.lastKeyCode=l.composedData.length==1?l.composedData.charCodeAt(0):229;l.composedData='';}if(!l.lastKey){if(identifier&&jbx.events.KeyboardEvent.PrintableKeys[identifier]){l.lastKey=jbx.events.KeyboardEvent.PrintableKeys[identifier];}else
if(e.char&&e.char==e.key){l.lastKey=e.key;}else
if(e.key){l.lastKey=jbx.events.getUnicodeCharacter(e.key);}}if(!l.lastKey){l.lastKey=jbx.events._cachedKeys[l.lastKeyCode];}result=l.composing||jbx.events.fireKeyboardEvent(l,e,false);}l.lastKey=null;l.lastKeyCode=0;l.lastKeyLocation=0;l.handleOnKeypress=false;return result;};jbx[Z].handleKeypressEvent=function(l,e){var charCode=0;if(l.handleOnKeypress){charCode=e.charCode||e.keyCode||e.which||0;if(e.ctrlKey&&jbx.dom.browser.isMac()){switch(charCode){case 173:charCode=45;break;case 219:charCode=91;break;case 220:charCode=92;break;case 221:charCode=93;break;}}if(charCode){l.lastKey=String.fromCharCode(charCode);}jbx.events._cachedKeys[l.lastKeyCode]=l.lastKey;if(l.type!='keyup'){return l.composing||jbx.events.fireKeyboardEvent(l,e,false);}}};jbx[Z].handleDOMEvent=function(l,e,dic){var len=0,file=null,intf=null,event=null,result=true,target=null,targets=null;e=e||window.event;intf=jbx.events.EventTypeInterface[l.type.toLowerCase()]||'Event';event=new jbx.events[intf](l.type,dic);event.setEvent(e);if(l.capture&&!l.src.addEventListener){if(e.keyCode<0||e.returnValue!=undefined){return true;}file=e.srcElement;file=!!file&&file.nodeName=='input'&&file.type=='file';if(e.keyCode==0&&!file){e.keyCode=-1;}else
if(e.returnValue==undefined){e.returnValue=true;}targets=[];target=l.src;while(target){targets.push(target);target=target.parentNode;}len=targets.length;while(len--&&!event.stopped){result=jbx.events.fireListeners(targets[len],event.type,true,event)&&result;}}else{event.currentTarget=l.src;event.phase=l.capture?jbx.events.Phase.CAPTURE:(event.target==l.src?jbx.events.Phase.TARGET:jbx.events.Phase.BUBBLE);if(event.phase!=jbx.events.Phase.CAPTURE||event.target!=l.src){result=l.handleEvent(event)!==false;}}!result&&event.preventDefault();result=!event.canceled;event.free();return result;};jbx[Z].fireKeyboardEvent=function(l,e,repeat){var result=null;result=jbx.events.handleDOMEvent(l,e,{repeat:repeat,key:l.lastKey||'Unidentified',keyCode:l.lastKeyCode||0,location:l.lastKeyLocation||0,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey});return result;};jbx[Z].fireListeners=function(target,type,capture,event){var len=0,result=true,id=jbx.getUniqueId(target),listeners=jbx.events._listeners;event.currentTarget=target;event.phase=capture?jbx.events.Phase.CAPTURE:(event.target==target?jbx.events.Phase.TARGET:jbx.events.Phase.BUBBLE);if(listeners[capture]&&listeners[capture][type]&&listeners[capture][type][id]){listeners=listeners[capture][type][id];len=listeners.length;while(len--&&!event.killed){if(listeners[len]){result=listeners[len].handleEvent(event)!==false&&result;}}}if(target.isControl&&!event.killed&&target.original){if(jbx.isFunction(target.original['on'+type])){target.original['on'+type](event);}}return result;};jbx[Z].dispatch=function(src,e){var len=0,intf=null,targets=[],result=true,current=null,newevent=jbx.isString(e),fireCapture=true in jbx.events._listeners,fireBubbling=false in jbx.events._listeners;if(newevent){intf=jbx.events.EventTypeInterface[e.toLowerCase()]||'Event';e=new jbx.events[intf](e,{target:src});}e.target=!e.target||src.isComponent?src:e.target;if(fireCapture){current=src;while(current){targets.push(current);current=current.isComponent?current.parent:current.parentNode;}len=targets.length;while(--len>0&&!e.stopped){result=jbx.events.fireListeners(targets[len],e.type,true,e)&&result;}}if(!e.stopped){result=jbx.events.fireListeners(src,e.type,false,e)&&result;}if(fireBubbling&&e.bubbles&&!e.stopped){current=src.isComponent?src.parent:src.parentNode;while(current&&!e.stopped){result=jbx.events.fireListeners(current,e.type,false,e)&&result;current=current.isComponent?current.parent:current.parentNode;}}!result&&e.preventDefault();result=result&&!e.canceled;newevent&&e.free();return result;};jbx[Z].listen=function(src,type,handler,scope,capture,priority){var id=null,len=0,list=null,prefix='',listener=null,method='addEventListener';if(jbx.isArray(type)){for(var i=0,l=type.length;i<l;i++){jbx.events.listen(src,type[i],handler,scope);}}else{capture=!!capture;scope=scope||src;src=jbx.dom.getElement(src);if(!src||!handler){return;}id=jbx.getUniqueId(src);list=jbx.events._listeners;list[capture]=list[capture]||{};list[capture][type]=list[capture][type]||{};list[capture][type][id]=list[capture][type][id]||[];list=list[capture][type][id];len=list.length;while(len--){if(list[len].handler==handler&&list[len].scope==scope){return list[len].id;}}listener=new jbx.events.Listener(src,type,handler,scope,capture);if(!src.isComponent){if(!src.addEventListener){method='attachEvent';prefix='on';}if(jbx.events.KeyboardEventTypes[type]){listener.handleDOMEvent=function(e){jbx.events.handleKeyboardEvent(listener,e);};src[method](prefix+'keyup',listener.handleDOMEvent,capture);src[method](prefix+'keydown',listener.handleDOMEvent,capture);src[method](prefix+'keypress',listener.handleDOMEvent,capture);src[method](prefix+'compositionend',listener.handleDOMEvent,capture);src[method](prefix+'compositionstart',listener.handleDOMEvent,capture);}else{listener.handleDOMEvent=function(e){jbx.events.handleDOMEvent(listener,e);};src[method](prefix+type,listener.handleDOMEvent,capture);}}priority?list.push(listener):list.unshift(listener);}};jbx[Z].unlisten=function(src,type,handler,scope,capture){var len=0,id=null,list=null,prefix='',listener=null,method='removeEventListener';if(type.length&&typeof type.splice!='undefined'){for(var i=0,l=type.length;i<l;i++){jbx.events.unlisten(src,type[i],handler,scope,capture);}}else{scope=scope||src;capture=!!capture;src=jbx.dom.getElement(src);if(!src){return;}id=jbx.getUniqueId(src);list=jbx.events._listeners;list[capture]=list[capture]||{};list[capture][type]=list[capture][type]||{};list[capture][type][id]=list[capture][type][id]||[];list=list[capture][type][id];len=list.length;while(len--){if(!handler||(list[len]&&list[len].handler==handler&&list[len].scope==scope)){listener=list[len];src=listener.src;type=listener.type;capture=listener.capture;list.splice(len,1);if(!src.isComponent){if(!src.removeEventListener){method='detachEvent';prefix='on';}if(jbx.events.KeyboardEventTypes[type]){src[method](prefix+'keyup',listener.handleDOMEvent,capture);src[method](prefix+'keydown',listener.handleDOMEvent,capture);src[method](prefix+'keypress',listener.handleDOMEvent,capture);src[method](prefix+'compositionend',listener.handleDOMEvent,capture);src[method](prefix+'compositionstart',listener.handleDOMEvent,capture);}else{src[method](prefix+type,listener.handleDOMEvent,capture);}}listener.handleDOMEvent=null;listener.free();}}}};jbx[Z].unlistenByType=function(src,type){var phase=false;src=jbx.dom.getElement(src);for(phase in jbx.events._listeners){jbx.events.unlisten(src,type,null,null,phase==true);}};jbx[Z].unlistenAll=function(src){var phase='',type='';src=jbx.dom.getElement(src);for(phase in jbx.events._listeners){for(type in jbx.events._listeners[phase]){jbx.events.unlisten(src,type,null,null,phase==true);}}};jbx.net._XHRNull=null;jbx.net._XDRNull=function(){};jbx.net._CORSClass='';jbx.net.MSXMLProgId=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"];jbx[p].isHistoryAvailable=function(){return!!(window.history&&window.history.pushState);};jbx[p].getXMLHttpRequestObject=function(){var i=0;if(typeof XMLHttpRequest!='undefined'){return new XMLHttpRequest;}else{if(!jbx.isString(jbx.net.MSXMLProgId)){if(typeof ActiveXObject!='undefined'){for(i=0;i<jbx.net.MSXMLProgId.length;i++){try{new ActiveXObject(jbx.net.MSXMLProgId[i]);jbx.net.MSXMLProgId=jbx.net.MSXMLProgId[i];jbx.net._XHRNull=function(){};break;}catch(e){}}}else{jbx.net.MSXMLProgId='';}}if(jbx.net.MSXMLProgId!=''){return new ActiveXObject(jbx.net.MSXMLProgId);}}return null;};jbx[p].getCORSRequestClass=function(){var xhr=null;if(jbx.net._CORSClass==''){if(typeof XMLHttpRequest!='undefined'){xhr=new XMLHttpRequest();if(('withCredentials'in xhr)){jbx.net._CORSClass='jbx.net.XHR';}}if(jbx.net._CORSClass==''){if(typeof XDomainRequest!='undefined'){jbx.net._CORSClass='jbx.net.XDR';}}if(jbx.net._CORSClass==''){jbx.net._CORSClass='jbx.net.JSONP';}}return jbx.net._CORSClass;};jbx.man.component.focusedControl=null;jbx.man.component._classCounters={};jbx.man.component._registeredComponents={};jbx.man.component._controlGroups={};jbx[t][u].getComponent=function(id){return jbx.man.component._registeredComponents[id];};jbx[t][u].getUniqueComponentId=function(com){var cnt=0,cls=com.className.split('-').pop();cnt=jbx.man.component._classCounters[cls]||0;jbx.man.component._classCounters[cls]=cnt+1;return cls+''+jbx.man.component._classCounters[cls];};jbx[t][u].getControlGroupState=function(type,name,state,skip){var i='',count=0,group=jbx.man.component._controlGroups;group=group[type]||{};group=group[name]||{};for(i in group){count++;}for(i in group){if((count<=1||group[i]!=skip)&&group[i].getState(state)){return true;}}return false;};jbx[t][u].setControlGroupState=function(type,name,state,on){var i='',group=jbx.man.component._controlGroups;group=group[type]||{};group=group[name]||{};for(i in group){group[i]._setState(state,on);}};jbx[t][u].addToGroup=function(type,name,control){var group=jbx.man.component._controlGroups;if(control.isControl){group[type]=group[type]||{};group[type][name]=group[type][name]||{};group[type][name][control.id]=control;}};jbx[t][u].removeFromGroup=function(type,name,control){var group=jbx.man.component._controlGroups;group[type]=group[type]||{};group[type][name]=group[type][name]||{};if(group[type][name][control.id]){group[type][name][control.id]=null;delete group[type][name][control.id];}};jbx[t][u].registerComponent=function(com,id){if(jbx.isEmpty(id)||jbx.man.component.getComponent(id)){id=jbx.man.component.getUniqueComponentId(com);}jbx.man.component._registeredComponents[id]=com;com.id=id;};jbx[t][u].unregisterComponent=function(com){if(jbx.man.component.focusedControl==com){jbx.man.component.focusedControl=null;}jbx.man.component._registeredComponents[com.id]=null;com.id='';};jbx[k][m]=function(id){jbx.base.Component.Super(this,'constructor');this.setId(id);};jbx.extends('jbx.base.Component','jbx.base.Object');jbx.base.Component.prototype.id='';jbx.base.Component.prototype.isComponent=true;jbx[k][m][A].free=function(){jbx.events.unlistenAll(this);jbx.man.component.unregisterComponent(this);jbx.base.Component.Super(this,'free');};jbx[k][m][A].setId=function(id){!jbx.isEmpty(this.id)&&jbx.man.component.unregisterComponent(this);jbx.man.component.registerComponent(this,id);};jbx[k][m][A].listen=function(type,handler,scope,capture,priority){jbx.events.listen(this,type,handler,scope||this,capture);};jbx[k][m][A].unlisten=function(type,handler,scope,capture){jbx.events.unlisten(this,type,handler,scope||this,capture);};jbx[k][m][A].dispatch=function(e){return jbx.events.dispatch(this,e);};jbx[Z][g]=function(type,dic){jbx.events.DragDropEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.DragDropEvent','jbx.events.Event');jbx.events.DragDropEvent.DROP='drop';jbx.events.DragDropEvent.DRAGSTART='dragstart';jbx.events.DragDropEvent.DRAGEND='dragend';jbx.events.DragDropEvent.DRAGMOVE='dragmove';jbx.events.DragDropEvent.DRAGOVER='dragover';jbx.events.DragDropEvent.DRAGOUT='dragout';jbx.events.DragDropEvent.CANDRAG='candrag';jbx.events.DragDropEvent.CANDROP='candrop';jbx.events.DragDropEvent.prototype.dragSource=null;jbx.events.DragDropEvent.prototype.dragger=null;jbx.events.DragDropEvent.prototype.dropEffect='move';jbx.events.DragDropEvent.prototype.clientX=0;jbx.events.DragDropEvent.prototype.clientY=0;jbx.events.DragDropEvent.prototype.mouseX=0;jbx.events.DragDropEvent.prototype.mouseY=0;jbx.events.DragDropEvent.prototype.distanceX=0;jbx.events.DragDropEvent.prototype.distanceY=0;jbx[Z][g][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=false;jbx.events.DragDropEvent.Super(this,'initEvent',type,dic);this.mouseX=dic.mouseX||0;this.mouseY=dic.mouseY||0;this.clientX=dic.clientX||0;this.clientY=dic.clientY||0;this.distanceX=dic.distanceX||0;this.distanceY=dic.distanceY||0;this.dragger=dic.dragger||null;this.dragSource=dic.dragSource||null;this.dropEffect=dic.dropEffect||'move';};jbx.man.dd.dragging=false;jbx.man.dd.activeDropTarget=null;jbx.man.dd._dropTargets=[];jbx.man.dd._scrollTimer=null;jbx.man.dd._scrollTargetAreas=[];jbx.man.dd._outerDropTargetArea=null;jbx.man.dd._outerScrollTargetArea=null;jbx.man.dd._fakeDropTargetArea=null;jbx.man.dd._validDropTartgetsIndexes=null;jbx[t][v].register=function(target){jbx.man.dd._dropTargets.push(target);};jbx[t][v].unregister=function(target){var targets=jbx.man.dd._dropTargets,index=jbx.array.indexOf(targets,target);index>=0&&targets.splice(index,1);};jbx[t][v].initializeValidDropTargets=function(source){var dt=null,indices=[],outerArea=null,targets=jbx.man.dd._dropTargets;for(var i=0,l=targets.length;i<l;i++){dt=targets[i];if(dt.notifyCanDrop(source)){indices.push(i);if(outerArea==null){outerArea=dt.area.clone();}else{outerArea=outerArea.union(dt.area);}}}jbx.man.dd._validDropTartgetsIndexes=indices;jbx.man.dd._outerDropTargetArea=outerArea;};jbx[t][v].initializeScrollTargets=function(source){var area=null,areas=[],target=null,outerArea=null,targets=source.getScrollTargets();for(var i=0,l=targets.length;i<l;i++){target=targets[i];area=jbx.dom.style.getBounds(target).toBox();if(outerArea==null){outerArea=area.clone();}else{outerArea=outerArea.union(area);}areas.push(area);}jbx.man.dd._outerScrollTargetArea=outerArea;jbx.man.dd._scrollTargetAreas=areas;};jbx[t][v].getDragDropEvent=function(type,ds,cx,cy,e){var dde=null,dic={clientX:jbx.isDefined(cx)?cx:ds.getPosition().x,clientY:jbx.isDefined(cy)?cy:ds.getPosition().y,mouseX:ds.getMouse().x,mouseY:ds.getMouse().y,distanceX:ds.getDistance().x,distanceY:ds.getDistance().y,dragger:ds.dragger,dragSource:ds};dde=new jbx.events.DragDropEvent(type,dic);e&&dde.setEvent(e);return dde;};jbx[t][v].getDropTargetFromPosition=function(point){var target=null,targets=jbx.man.dd._dropTargets,indices=jbx.man.dd._validDropTartgetsIndexes;for(var i=0,l=indices.length;i<l;i++){target=targets[indices[i]];if(target&&target.area.contains(point)){return target;}}return null;};jbx[t][v].getFakeDropTargetAreaFor=function(point){var hslice=-1,vslice=-1,target=null,area=new jbx.math.Box(0,0,0,0),targets=jbx.man.dd._dropTargets,indices=jbx.man.dd._validDropTartgetsIndexes;area=jbx.man.dd._outerDropTargetArea.clone();for(var i=0,l=indices.length;i<l;i++){vslice=-1;hslice=-1;target=targets[indices[i]];if(area.x<=target.area.x2){if(point.y>target.area.y2){if(area.y<=target.area.y2){vslice=target.area.y2;}}else
if(point.y<target.area.y){if(area.y2>=target.area.y){vslice=target.area.y;}}}if(area.y<=target.area.y2){if(point.x>target.area.x2){if(area.x<=target.area.x2){hslice=target.area.x2;}}else
if(point.x<target.area.x){if(area.x2>=target.area.x){hslice=target.area.x;}}}if(vslice>=0&&hslice>=0){if(Math.abs(hslice-point.x)>Math.abs(vslice-point.y)){vslice=-1;}else{hslice=-1;}}if(hslice>=0){if(hslice<=point.x){area.x=hslice;}else{area.x2=hslice;}}else
if(vslice>=0){if(vslice<=point.y){area.y=vslice;}else{area.y2=vslice;}}}return area.x2>area.x+10&&area.y2>area.y+10?area:null;};jbx[t][v].recalculateOuterDropArea=function(){var dt=null,outerArea=null,targets=jbx.man.dd._dropTargets,indices=jbx.man.dd._validDropTartgetsIndexes;for(var i=0,l=indices.length;i<l;i++){dt=targets[indices[i]];if(outerArea==null){outerArea=dt.area.clone();}else{outerArea=outerArea.union(dt.area);}}jbx.man.dd._outerDropTargetArea=outerArea;};jbx[t][v].scrollTarget=function(target,rec1,rec2,deltaX,deltaY){var scroll=null,scrollX=0,scrollY=0;if(jbx.man.dd._scrollTimer){clearInterval(jbx.man.dd._scrollTimer);jbx.man.dd._scrollTimer=null;}if(deltaY<=0){deltaY=rec2.y-rec1.y;deltaY=deltaY<0?Math.ceil(deltaY/4):0;}if(deltaY>=0){deltaY=(rec2.y+rec2.height)-(rec1.y+rec1.height);deltaY=deltaY>0?Math.ceil(deltaY/4):0;}if(deltaX<=0){deltaX=rec2.x-rec1.x;deltaX=deltaX<0?Math.ceil(deltaX/4):0;}if(deltaX>=0){deltaX=(rec2.x+rec2.width)-(rec1.x+rec1.width);deltaX=deltaX>0?Math.ceil(deltaX/4):0;}if(deltaX!=0||deltaY!=0){scroll=jbx.dom.style.getScroll(target);scrollX=Math.min(scroll.width,Math.max(0,scroll.x+deltaX));scrollY=Math.min(scroll.height,Math.max(0,scroll.y+deltaY));jbx.dom.style.setScroll(target,scrollX,scrollY);jbx.man.dd._scrollTimer=setInterval(function(){scrollX=Math.min(scroll.width,Math.max(0,scrollX+deltaX));scrollY=Math.min(scroll.height,Math.max(0,scrollY+deltaY));jbx.dom.style.setScroll(target,scrollX,scrollY);},10);}};jbx[t][v].notifyActiveDropTarget=function(source){var mouse=source.getMouse(),fakeArea=jbx.man.dd._fakeDropTargetArea,outerArea=jbx.man.dd._outerDropTargetArea,target=jbx.man.dd.activeDropTarget;if(target){if(target.area.contains(mouse)){return;}target.notifyDragOut(source);jbx.man.dd.activeDropTarget=null;}if(fakeArea&&fakeArea.contains(mouse)){return;}target=null;if(outerArea&&outerArea.contains(mouse)){target=jbx.man.dd.getDropTargetFromPosition(mouse);if(target){target.notifyDragOver(source);}else{jbx.man.dd._fakeDropTargetArea=jbx.man.dd.getFakeDropTargetAreaFor(mouse);}}jbx.man.dd.activeDropTarget=target;};jbx[t][v].notifyActiveScrollTarget=function(source,deltaX,deltaY){var area=null,targets=null,pos=source.getPosition(),size=source.getDraggerSize(),areas=jbx.man.dd._scrollTargetAreas,outerArea=jbx.man.dd._outerScrollTargetArea,box=new jbx.math.Box(pos.x,pos.y,pos.x+size.width,pos.y+size.height);if(outerArea&&outerArea.intersects(box)){for(var i=0,l=areas.length;i<l;i++){area=areas[i];if(area.intersects(box)){targets=source.getScrollTargets();targets[i]&&jbx.man.dd.scrollTarget(targets[i],area.toRect(),box.toRect(),deltaX,deltaY);return;}}}};jbx[t][v].notifyDragEnd=function(source){var mouse=source.getMouse(),target=jbx.man.dd.activeDropTarget;if(target&&target.area.contains(mouse)){target.notifyDrop(source);}jbx.man.dd.activeDropTarget=null;jbx.man.dd._scrollTargetAreas=null;jbx.man.dd._fakeDropTargetArea=null;jbx.man.dd._outerDropTargetArea=null;jbx.man.dd._outerScrollTargetArea=null;jbx.man.dd._validDropTartgetsIndexes=null;if(jbx.man.dd._scrollTimer){clearInterval(jbx.man.dd._scrollTimer);jbx.man.dd._scrollTimer=null;}};jbx[x][y]=function(el){jbx.com.DragSource.Super(this,'constructor');this._dragLimit=null;this._dragMouse=new jbx.math.Point(0,0);this._draggerSize=new jbx.math.Size(0,0);this._dragDistance=new jbx.math.Point(0,0);this._dragPosition=new jbx.math.Point(0,0);this.element=jbx.dom.getElement(el);this.snap=new jbx.math.Point(0,0);this.dragging=false;this._scrollTargets=[];this.setDragElement(this.element);this.element.setAttribute('aria-grabbed','false');jbx.dom.classes.add(this.element,this.styleName);};jbx.extends('jbx.com.DragSource','jbx.base.Component');jbx.com.DragSource.prototype.element=null;jbx.com.DragSource.prototype.dragger=null;jbx.com.DragSource.prototype.dragging=false;jbx.com.DragSource.prototype.hDirection=0;jbx.com.DragSource.prototype.vDirection=0;jbx.com.DragSource.prototype.snap=null;jbx.com.DragSource.prototype.snapX=0;jbx.com.DragSource.prototype.snapY=0;jbx.com.DragSource.prototype.snapType=jbx.dom.style.Corner.CENTER;jbx.com.DragSource.prototype.documentScroll=false;jbx.com.DragSource.prototype.vpTopLeftConstraint=true;jbx.com.DragSource.prototype.notifyDropTargets=true;jbx.com.DragSource.prototype._dragElement=null;jbx.com.DragSource.prototype._dragLimit=null;jbx.com.DragSource.prototype._dragMouse=null;jbx.com.DragSource.prototype._draggerSize=null;jbx.com.DragSource.prototype._dragDistance=null;jbx.com.DragSource.prototype._dragPosition=null;jbx.com.DragSource.prototype._dragThreshold=0;jbx.com.DragSource.prototype._scrollTargets=[];jbx[x][y][A].free=function(){this.endDrag();jbx.events.unlisten(this._dragElement,[jbx.events.MouseEvent.MOUSEUP,jbx.events.TouchEvent.TOUCHEND],this._onDragEnd,this);jbx.events.unlisten(this._dragElement,[jbx.events.MouseEvent.MOUSEMOVE,jbx.events.TouchEvent.TOUCHMOVE],this._onDragMove,this);jbx.events.unlisten(this._dragElement,[jbx.events.MouseEvent.MOUSEDOWN,jbx.events.TouchEvent.TOUCHSTART],this._onDragStart,this);jbx.dom.classes.remove(this.element,this.styleName);this.element.removeAttribute('aria-grabbed');this._releaseDraggerElement();this.snap=null;this.element=null;this._dragMouse=null;this._dragLimit=null;this._draggerSize=null;this._dragElement=null;this._dragDistance=null;this._dragPosition=null;this._scrollTargets=null;jbx.com.DragSource.Super(this,'free');};jbx[x][y][A]._initDraggerElement=function(dragger){var doc=jbx.dom.getDocument(this.element);this.dragger=dragger||this.getDefaultDraggerElement();this.dragger.style.margin='0px';this.dragger.style.position='absolute';this.dragger.style.zIndex=jbx.dom.style.zIndex.TOP++;this.dragger.setAttribute('role','presentation');jbx.dom.classes.add(this.dragger,this.styleName+'-dragger');doc.body.insertBefore(this.dragger,doc.body.firstChild);this._draggerSize=jbx.dom.style.getSize(this.dragger);this._dragPosition=jbx.dom.style.getGlobalPosition(this.dragger);};jbx[x][y][A]._releaseDraggerElement=function(){var parent=null;if(this.dragger){parent=this.dragger.parentNode;parent&&parent.removeChild(this.dragger);this.dragger=null;}};jbx[x][y][A]._getTouch=function(e){if(e.type==jbx.events.TouchEvent.TOUCHSTART||e.type==jbx.events.TouchEvent.TOUCHMOVE){return e.targetTouches[0];}else{return e.changedTouches[0];}};jbx[x][y][A]._getSnapAndlimitX=function(px){var src=this.element,snapx=this.snapX,snapt=this.snapType,limit=this._dragLimit;if(snapx>1){px=this._dragMouse.x;px=limit?px-limit.x:px;px=(Math.round(px/snapx)*snapx)+(limit?limit.x:0);if(this.dragger){if(snapt&jbx.dom.style.Side.RIGHT){px=px-this.dragger.offsetWidth;}else
if(!(snapt&jbx.dom.style.Side.LEFT)){px=px-Math.round(this.dragger.offsetWidth/2);}}}else{this.snap.x=0;}if(limit){px=Math.max(px,limit.x);px=Math.min(px,limit.x2-src.offsetWidth);}if(this.vpTopLeftConstraint){px=Math.max(0,px);}this.snap.x=snapx>1?Math.round((limit?px-limit.x:px)/snapx):0;return px;};jbx[x][y][A]._getSnapAndLimitY=function(py){var src=this.element,snapy=this.snapY,snapt=this.snapType,limit=this._dragLimit;if(snapy>1){py=this._dragMouse.y;py=limit?py-limit.y:py;py=(Math.round(py/snapy)*snapy)+(limit?limit.y:0);if(this.dragger){if(snapt&jbx.dom.style.Side.BOTTOM){py=py-this.dragger.offsetHeight;}else
if(!(snapt&jbx.dom.style.Side.TOP)){py=py-Math.round(this.dragger.offsetHeight/2);}}}if(limit){py=Math.max(py,limit.y);py=Math.min(py,limit.y2-src.offsetHeight);}if(this.vpTopLeftConstraint){py=Math.max(0,py);}this.snap.y=snapy>1?Math.round((limit?py-limit.y:py)/snapy):0;return py;};jbx[x][y][A]._canDrag=function(){var dde=null,result=false;if(!jbx.man.dd.dragging){dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.CANDRAG,this,0,0);result=this.dispatch(dde);dde.free();}return result;};jbx[x][y][A]._doDragStart=function(e){var isTouchEvent=e instanceof jbx.events.TouchEvent,touch=isTouchEvent?this._getTouch(e):e,scroll=jbx.dom.style.getDocumentScroll(this.element),dx=touch.clientX+scroll.x,dy=touch.clientY+scroll.y,dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGSTART,this,dx,dy,e);this.dispatch(dde);this.startDrag(dx,dy,dde.dragger);dde.free();this._doDragMove(e);};jbx[x][y][A]._doDragEnd=function(e){var dde=null,py=this._dragPosition.y,px=this._dragPosition.x;px=this._getSnapAndlimitX(px);py=this._getSnapAndLimitY(py);dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGEND,this,px,py,e);if(this.dispatch(dde)){jbx.dom.style.setGlobalPosition(this.element,dde.clientY,dde.clientX);}dde.free();this.endDrag();};jbx[x][y][A]._doDragMove=function(e){var px=0,py=0,dde=null,el=this.dragger,off=this._dragDistance,pos=this._dragPosition,mouse=this._dragMouse,scroll=jbx.dom.style.getDocumentScroll(el),isTouchEvent=e instanceof jbx.events.TouchEvent,touch=isTouchEvent?this._getTouch(e):e,deltaY=touch.clientY+scroll.y-mouse.y,deltaX=touch.clientX+scroll.x-mouse.x;this.hDirection=deltaX;this.vDirection=deltaY;off.translate(deltaX,deltaY);pos.translate(deltaX,deltaY);mouse.setCoordinate(touch.clientX+scroll.x,touch.clientY+scroll.y);py=this._getSnapAndLimitY(pos.y);px=this._getSnapAndlimitX(pos.x);dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGMOVE,this,px,py,e);this.dispatch(dde);jbx.dom.style.setPosition(el,dde.clientY,dde.clientX);dde.free();this.documentScroll&&this._doDocumentScroll(deltaX,deltaY);this.notifyDropTargets&&jbx.man.dd.notifyActiveDropTarget(this);jbx.man.dd.notifyActiveScrollTarget(this,deltaX,deltaY);};jbx[x][y][A]._doDocumentScroll=function(deltaX,deltaY){var size=this._draggerSize,pos=this._dragPosition,doc=jbx.dom.getDocument(this.element),rec1=jbx.dom.style.getViewportSize(this.element),rec2=new jbx.math.Rect(pos.x,pos.y,size.width,size.height);jbx.man.dd.scrollTarget(doc,rec1,rec2,deltaX,deltaY);};jbx[x][y][A]._onDragEnd=function(e){var doc=jbx.dom.getDocument(this.element);jbx.events.unlisten(doc,[jbx.events.MouseEvent.MOUSEUP,jbx.events.TouchEvent.TOUCHEND],this._onDragEnd,this);jbx.events.unlisten(doc,[jbx.events.MouseEvent.MOUSEMOVE,jbx.events.TouchEvent.TOUCHMOVE],this._onDragMove,this);this.dragging&&this._doDragEnd(e);};jbx[x][y][A]._onDragStart=function(e){var doc=jbx.dom.getDocument(this.element),scroll=jbx.dom.style.getDocumentScroll(this.element),isTouchEvent=e instanceof jbx.events.TouchEvent,touch=isTouchEvent?this._getTouch(e):e;this._dragDistance.setCoordinate(0,0);this._dragMouse.setCoordinate(touch.clientX+scroll.x,touch.clientY+scroll.y);if((isTouchEvent||e.button==jbx.events.MouseEvent.BUTTON_LEFT)&&this._canDrag()){jbx.events.listen(doc,[jbx.events.MouseEvent.MOUSEUP,jbx.events.TouchEvent.TOUCHEND],this._onDragEnd,this);jbx.events.listen(doc,[jbx.events.MouseEvent.MOUSEMOVE,jbx.events.TouchEvent.TOUCHMOVE],this._onDragMove,this);if(this._dragThreshold==0){this._doDragStart(e);}if(!isTouchEvent){e.preventDefault();}}};jbx[x][y][A]._onDragMove=function(e){var ox=0,oy=0,scroll=null,isTouchEvent=e instanceof jbx.events.TouchEvent,touch=isTouchEvent?this._getTouch(e):e;if(this.dragging){this._doDragMove(e);}else{scroll=jbx.dom.style.getDocumentScroll(this.element);oy=Math.abs(touch.clientY+scroll.y-this._dragMouse.y);ox=Math.abs(touch.clientX+scroll.x-this._dragMouse.x);if(oy+ox>=this._dragThreshold){this._doDragStart(e);}}e.preventDefault();};jbx[x][y][A].getDragElement=function(){return this._dragElement;};jbx[x][y][A].getLimits=function(){return this._dragLimit;};jbx[x][y][A].getMouse=function(){return this._dragMouse;};jbx[x][y][A].getDistance=function(){return this._dragDistance;};jbx[x][y][A].getPosition=function(){return this._dragPosition;};jbx[x][y][A].getDraggerSize=function(){return this._draggerSize;};jbx[x][y][A].getDragThreshold=function(){return this._dragThreshold;};jbx[x][y][A].getScrollTargets=function(){return this._scrollTargets;};jbx[x][y][A].getDefaultDraggerElement=function(){var el=this.element.cloneNode(true),doc=jbx.dom.getDocument(this.element),rec=jbx.dom.style.getBounds(this.element);el.id='';el.style.top=rec.y+'px';el.style.left=rec.x+'px';jbx.dom.style.setStyle(el,'opacity',0.6);doc.body.insertBefore(el,doc.body.firstChild);jbx.dom.style.setSize(el,rec.width,rec.height);doc.body.removeChild(el);return el;};jbx[x][y][A].setLimits=function(box){var rec=null;this._dragLimit=box||null;if(box){rec=jbx.dom.style.getBounds(this.element);jbx.dom.style.setGlobalPosition(this.element,Math.max(box.y,Math.min(rec.y,box.y2-rec.height)),Math.max(box.x,Math.min(rec.x,box.x2-rec.width)));}};jbx[x][y][A].setVpTopLeftConstraint=function(value){var pos=null;this.vpTopLeftConstraint=!!value;if(this.vpTopLeftConstraint){pos=jbx.dom.style.getGlobalPosition(this.element);jbx.dom.style.setGlobalPosition(this.element,Math.max(pos.y,0),Math.max(pos.x,0));}};jbx[x][y][A].setSnap=function(snapx,snapy,snaptype){this.snapX=snapx||0;this.snapY=snapy||0;this.snapType=snaptype||jbx.dom.style.Corner.CENTER;};jbx[x][y][A].setDragThreshold=function(val){this._dragThreshold=val<0?0:val;};jbx[x][y][A].setDragElement=function(el){el=el||this.element;if(this._dragElement){jbx.events.unlisten(this._dragElement,[jbx.events.MouseEvent.MOUSEDOWN,jbx.events.TouchEvent.TOUCHSTART],this._onDragStart,this);jbx.dom.classes.remove(this._dragElement,this.styleName+'-target');}jbx.events.listen(el,[jbx.events.MouseEvent.MOUSEDOWN,jbx.events.TouchEvent.TOUCHSTART],this._onDragStart,this);jbx.dom.classes.add(el,this.styleName+'-target');this._dragElement=el;};jbx[x][y][A].addScrollTarget=function(el){el=jbx.dom.getElement(el);if(jbx.array.indexOf(this._scrollTargets,el)<0){this._scrollTargets.push(el);}};jbx[x][y][A].removeScrollTarget=function(el){var i=jbx.array.indexOf(this._scrollTargets,el);i>=0&&this._scrollTargets.splice(i,1);};jbx[x][y][A].startDrag=function(mouseX,mouseY,dragger){var doc=jbx.dom.getDocument(this.element);this._dragDistance.setCoordinate(0,0);this._dragMouse.setCoordinate(mouseX||0,mouseY||0);this._initDraggerElement(dragger);jbx.events.listen(doc,[jbx.events.MouseEvent.MOUSEUP,jbx.events.TouchEvent.TOUCHEND],this._onDragEnd,this);jbx.events.listen(doc,[jbx.events.MouseEvent.MOUSEMOVE,jbx.events.TouchEvent.TOUCHMOVE],this._onDragMove,this);this.element.setAttribute('aria-grabbed','true');jbx.dom.classes.add(this.element,this.styleName+'-dragging');this.notifyDropTargets&&jbx.man.dd.initializeValidDropTargets(this);jbx.man.dd.initializeScrollTargets(this);jbx.man.dd.dragging=true;this.dragging=true;};jbx[x][y][A].endDrag=function(){var doc=null;if(this.dragging){this.dragging=false;jbx.man.dd.dragging=false;doc=jbx.dom.getDocument(this.element);jbx.events.unlisten(doc,[jbx.events.MouseEvent.MOUSEUP,jbx.events.TouchEvent.TOUCHEND],this._onDragEnd,this);jbx.events.unlisten(doc,[jbx.events.MouseEvent.MOUSEMOVE,jbx.events.TouchEvent.TOUCHMOVE],this._onDragMove,this);this.element.setAttribute('aria-grabbed','false');jbx.dom.classes.remove(this.element,this.styleName+'-dragging');this.notifyDropTargets&&jbx.man.dd.notifyDragEnd(this);this._releaseDraggerElement();}};jbx[k][n]=function(el,parent){el=jbx.dom.getElement(el);jbx.base.Control.Super(this,'constructor',el?(el.id||el.getAttribute('data-jbx-id')):'');this._initialize(el,jbx.dom.getElement(parent));};jbx.extends('jbx.base.Control','jbx.base.Component');jbx[k][n].State={DOWN:1,HOVER:2,MIXED:4,HIDDEN:8,ACTIVE:16,CHECKED:32,PRESSED:64,FOCUSED:128,INVALID:256,SELECTED:512,DISABLED:1024,READONLY:2048,EXPANDED:4096,GRABBED:8192,REQUIRED:16384,EMPTY:32768};jbx[k][n]._StateClassName={1:'down',2:'hover',4:'mixed',8:'hidden',16:'active',32:'checked',64:'pressed',128:'focused',256:'invalid',512:'selected',1024:'disabled',2048:'readonly',4096:'expanded',8192:'grabbed',16384:'required',32768:'empty'};jbx.base.Control.prototype.element=null;jbx.base.Control.prototype.content=null;jbx.base.Control.prototype.original=null;jbx.base.Control.prototype.parent=null;jbx.base.Control.prototype.tooltip='';jbx.base.Control.prototype.tabIndex=0;jbx.base.Control.prototype.accessKey='';jbx.base.Control.prototype.isControl=true;jbx.base.Control.prototype.fireInline=false;jbx.base.Control.prototype._dragsource=null;jbx.base.Control.prototype._controlState=0;jbx.base.Control.prototype._supportedStates=jbx.base.Control.State.EMPTY|jbx.base.Control.State.HOVER|jbx.base.Control.State.HIDDEN|jbx.base.Control.State.FOCUSED|jbx.base.Control.State.PRESSED|jbx.base.Control.State.DISABLED;jbx[k][n][A].free=function(){if(jbx.man.component.focusedControl==this){jbx.man.component.focusedControl=null;}this._setFocusListeners(false);this._setMouseListeners(false);this._setKeyListeners(false);this.setDraggable(false);this.setParent(null);this.tooltip=null;this.element=null;this.content=null;this.original=null;jbx.base.Control.Super(this,'free');};jbx[k][n][A]._initialize=function(el,parent){this.element=el||this._getControlElement();jbx.dom.classes.add(this.element,this.styleName);this.original=this.element;this.content=this.element;this._detectStructure(this.element);this._initStructure();this.element.setAttribute('data-jbx-id',this.id);this.content.setAttribute('data-jbx-id',this.id);jbx.dom.style.setBoxSizing(this.element,'border-box');this.parent=null;this.setParent(parent||this.element.parentNode);this._detectAttributes(this.original);this._setMouseListeners(true);if(this.isFocusable()){this._setKeyListeners(true);this._setFocusListeners(true);}};jbx[k][n][A]._initStructure=function(){};jbx[k][n][A]._detectStructure=function(el){var child=jbx.dom.firstChild(el);while(child){this._detectStructureElement(child);child=jbx.dom.nextElement(child);}};jbx[k][n][A]._detectStructureElement=function(el){switch(el.getAttribute('data-jbx-element')){case'content':this._setContentElement(el);break;case'struct':this._detectStructure(el);}};jbx[k][n][A]._detectAttributes=function(el){var i=0,l=0,val='';this.setTooltip(el.title);this.setTabIndex(el.tabIndex);this.setAccessKey(el.accessKey);val=el.getAttribute('data-jbx-draggable');val=='on'&&this.setDraggable(true);val=el.getAttribute('data-jbx-state');if(!jbx.isEmpty(val)){val=val.split(' ');for(i=0,l=val.length;i<l;i++){this._detectStateAttribute(val[i]);}}};jbx[k][n][A]._detectStateAttribute=function(state){switch(state){case'hidden':this.setHidden(true);break;case'disabled':this.setDisabled(true);break;case'focused':this.setFocused(true);break;case'active':this.setActive(true);break;}};jbx[k][n][A]._toggleSelector=function(selector,on){selector=this.styleName+'-'+selector;this.element&&jbx.dom.classes[on?'add':'remove'](this.element,selector);};jbx[k][n][A]._toggleStateSelector=function(state,on){var selector=jbx.base.Control._StateClassName[state];selector&&this._toggleSelector(selector,on);};jbx[k][n][A]._isSupportedState=function(state){return!!(this._supportedStates&state);};jbx[k][n][A]._canDrag=function(){return true;};jbx[k][n][A]._canSetContent=function(){return true;};jbx[k][n][A]._canSetState=function(state,on){return this._isSupportedState(state)&&this._getState(state)!=on;};jbx[k][n][A]._canSetHidden=function(on){return this._canSetState(jbx.base.Control.State.HIDDEN,on);};jbx[k][n][A]._canSetPressed=function(on){return this._canSetState(jbx.base.Control.State.PRESSED,on);};jbx[k][n][A]._canSetHover=function(on){return this.isEnabled()&&this.isVisible()&&this._canSetState(jbx.base.Control.State.HOVER,on);};jbx[k][n][A]._canSetDisabled=function(on){return this._canSetState(jbx.base.Control.State.DISABLED,on)&&(on||this.isParentEnabled());};jbx[k][n][A]._canSetFocused=function(on){return(!on||(this.isEnabled()&&this.isVisible()))&&this._canSetState(jbx.base.Control.State.FOCUSED,on);};jbx[k][n][A]._canSetActive=function(on){return(!on||(this.isEnabled()&&this.isVisible()))&&this._canSetState(jbx.base.Control.State.ACTIVE,on);};jbx[k][n][A]._getState=function(state){return!!(this._controlState&state);};jbx[k][n][A]._getControlElement=function(){return jbx.dom.createElement('DIV');};jbx[k][n][A]._getDragSourceElement=function(){return this.element;};jbx[k][n][A]._getKeyboardEventTarget=function(){return this.element;};jbx[k][n][A]._getMouseEventTarget=function(){return this.element;};jbx[k][n][A]._setState=function(state,on){on=!!on;if(this._canSetState(state,on)){this._controlState=on?this._controlState|state:this._controlState&~state;this._toggleStateSelector(state,on);}};jbx[k][n][A]._setSupportedState=function(state,on){on=!!on;if(this._isSupportedState(state)!=on){this._supportedStates=on?this._supportedStates|state:this._supportedStates&~state;}};jbx[k][n][A]._setContentElement=function(el){jbx.dom.classes.add(this.element,this.styleName+'-content');this._setEmpty(jbx.isEmpty(el.innerHTML));this.content=el;};jbx[k][n][A]._setFocusListeners=function(on){var target=this._getKeyboardEventTarget(),method=on?'listen':'unlisten';jbx.events[method](target,'blur',this._onBlur,this);jbx.events[method](target,'focus',this._onFocus,this);};jbx[k][n][A]._setKeyListeners=function(on){var target=this._getKeyboardEventTarget(),method=on?'listen':'unlisten';jbx.events[method](target,jbx.events.KeyboardEvent.KEYUP,this._onKeyup,this);jbx.events[method](target,jbx.events.KeyboardEvent.KEYDOWN,this._onKeydown,this);};jbx[k][n][A]._setMouseListeners=function(on){var target=this._getMouseEventTarget(),method=on?'listen':'unlisten';jbx.events[method](target,jbx.events.MouseEvent.CLICK,this._onClick,this);jbx.events[method](target,jbx.events.MouseEvent.MOUSEUP,this._onMouseup,this);jbx.events[method](target,jbx.events.MouseEvent.MOUSEOUT,this._onMouseout,this);jbx.events[method](target,jbx.events.MouseEvent.MOUSEOVER,this._onMouseover,this);jbx.events[method](target,jbx.events.MouseEvent.MOUSEDOWN,this._onMousedown,this);};jbx[k][n][A]._setContent=function(value){this._setEmpty(jbx.isEmpty(value));this.content.innerHTML=value;};jbx[k][n][A]._setEmpty=function(on){this._setState(jbx.base.Control.State.EMPTY,on);};jbx[k][n][A]._setHover=function(on){this._setState(jbx.base.Control.State.HOVER,on);};jbx[k][n][A]._setPressed=function(on){this._setState(jbx.base.Control.State.PRESSED,on);};jbx[k][n][A]._setGrabbed=function(on){this._setState(jbx.base.Control.State.GRABBED,on);};jbx[k][n][A]._setActive=function(on){this._setState(jbx.base.Control.State.ACTIVE,on);on&&this.parent&&this.parent.isContainer&&this.parent.setActiveControl(this);};jbx[k][n][A]._setDisabled=function(on){if(on){this.setHover(false);this.setPressed(false);this.setFocused(false);}this._setState(jbx.base.Control.State.DISABLED,on);this.setTabIndex(this.tabIndex);this.setAccessKey(this.accessKey);if('disabled'in this.original){this.original.disabled=on;}};jbx[k][n][A]._setHidden=function(on){if(on){this.element.style.display='none';this.setFocused(false);this.setPressed(false);this.setHover(false);}else{this.element.style.display='';}this._setState(jbx.base.Control.State.HIDDEN,on);};jbx[k][n][A]._doFocus=function(e){this.setActive(true);this._setState(jbx.base.Control.State.FOCUSED,true);jbx.man.component.focusedControl=this;};jbx[k][n][A]._doBlur=function(e){this.setActive(false);this._setState(jbx.base.Control.State.FOCUSED,false);if(jbx.man.component.focusedControl==this){jbx.man.component.focusedControl=null;}};jbx[k][n][A]._doKeydown=function(e){switch(e.keyCode){case jbx.events.KeyboardEvent.KeyCode.Enter:case jbx.events.KeyboardEvent.KeyCode.Spacebar:this.setPressed(true);break;}};jbx[k][n][A]._doKeyup=function(e){switch(e.keyCode){case jbx.events.KeyboardEvent.KeyCode.Enter:case jbx.events.KeyboardEvent.KeyCode.Spacebar:this.isPressed()&&this._doClick(e);this.setPressed(false);break;case jbx.events.KeyboardEvent.KeyCode.Escape:this.setPressed(false);break;}};jbx[k][n][A]._doClick=function(e){};jbx[k][n][A]._doMouseover=function(e){this.setHover(true);};jbx[k][n][A]._doMouseout=function(e){this.setPressed(false);this.setHover(false);};jbx[k][n][A]._doMousedown=function(e){if(e.button==jbx.events.MouseEvent.BUTTON_LEFT){!this.isFocused()&&this.setFocused(true);this.setPressed(true);}};jbx[k][n][A]._doMouseup=function(e){this.setPressed(false);};jbx[k][n][A]._doDragstart=function(e){};jbx[k][n][A]._doDragmove=function(e){};jbx[k][n][A]._doDragend=function(e){};jbx[k][n][A]._onFocus=function(e){if(!this.isFocused()){if(this.dispatch(e)){this._doFocus(e);}else{e.preventDefault();this.blur();};}};jbx[k][n][A]._onBlur=function(e){this._doBlur(e);this.dispatch(e);};jbx[k][n][A]._onKeydown=function(e){this.isEnabled()&&this.dispatch(e)&&this._doKeydown(e);};jbx[k][n][A]._onKeyup=function(e){this.isEnabled()&&this.dispatch(e)&&this._doKeyup(e);};jbx[k][n][A]._onMouseover=function(e){if(e.relatedTarget&&!jbx.dom.contains(this.element,e.relatedTarget)){this.dispatch(e)&&this.isEnabled()&&this._doMouseover(e);}};jbx[k][n][A]._onMouseout=function(e){if(e.relatedTarget&&!jbx.dom.contains(this.element,e.relatedTarget)){this.dispatch(e);this._doMouseout(e);}};jbx[k][n][A]._onMousedown=function(e){this.dispatch(e)&&this.isEnabled()&&this._doMousedown(e);};jbx[k][n][A]._onMouseup=function(e){this.dispatch(e)&&this.isEnabled()&&this._doMouseup(e);};jbx[k][n][A]._onClick=function(e){this._doClick();};jbx[k][n][A]._onCandrag=function(e){return this.isVisible()&&this._canDrag(e)&&this.dispatch(e);};jbx[k][n][A]._onDragstart=function(e){this._setGrabbed(true);this.dispatch(e)&&this._doDragstart(e);};jbx[k][n][A]._onDragmove=function(e){this.dispatch(e)&&this._doDragmove(e);};jbx[k][n][A]._onDragend=function(e){this.dispatch(e)&&this._doDragend(e);this._setGrabbed(false);};jbx[k][n][A].isDraggable=function(){return this._isSupportedState(jbx.base.Control.State.GRABBED);};jbx[k][n][A].isFocusable=function(){return this._isSupportedState(jbx.base.Control.State.FOCUSED);};jbx[k][n][A].isEmpty=function(){return this._getState(jbx.base.Control.State.EMPTY);};jbx[k][n][A].isHover=function(){return this._getState(jbx.base.Control.State.HOVER);};jbx[k][n][A].isDragging=function(){return this._getState(jbx.base.Control.State.DRAGGING);};jbx[k][n][A].isFocused=function(){return this._getState(jbx.base.Control.State.FOCUSED);};jbx[k][n][A].isPressed=function(){return this._getState(jbx.base.Control.State.PRESSED);};jbx[k][n][A].isActive=function(){return this._getState(jbx.base.Control.State.ACTIVE);};jbx[k][n][A].isEnabled=function(){return!this.isDisabled();};jbx[k][n][A].isDisabled=function(){return this._getState(jbx.base.Control.State.DISABLED)||!this.isParentEnabled();};jbx[k][n][A].isVisible=function(){return this.isParentVisible()&&!this._getState(jbx.base.Control.State.HIDDEN);};jbx[k][n][A].isParentEnabled=function(){return!this.parent||!this.parent.isContainer||this.parent.isEnabled();};jbx[k][n][A].isParentVisible=function(){return!this.parent||(this.parent.isContainer?this.parent.isVisible():jbx.dom.resolveNode(this.parent,jbx.dom.TreeWalker.PARENT_NODE,function(n){return jbx.dom.isElement(n)&&jbx.dom.style.getStyle(n,"display")=="none";})==null);};jbx[k][n][A].getState=function(state){return this._getState(state);};jbx[k][n][A].setTooltip=function(value){this.tooltip=value||'';this.element.title=this.tooltip;};jbx[k][n][A].setContent=function(value){this._canSetContent()&&this._setContent(value);};jbx[k][n][A].setDisabled=function(value){this._canSetDisabled(value)&&this._setDisabled(value);};jbx[k][n][A].setHidden=function(value){this._canSetHidden(value)&&this._setHidden(value);};jbx[k][n][A].setFocused=function(value){var target=this._getKeyboardEventTarget();value?target.focus():target.blur();};jbx[k][n][A].setHover=function(value){this._canSetHover(value)&&this._setHover(value);};jbx[k][n][A].setPressed=function(value){this._canSetPressed(value)&&this._setPressed(value);};jbx[k][n][A].setActive=function(value){this._canSetActive(value)&&this._setActive(value);};jbx[k][n][A].setDraggable=function(value){if(this.isDraggable()!=value){this._setSupportedState(jbx.base.Control.State.GRABBED,value);this._toggleSelector('draggable',value);if(value){this._dragsource=new jbx.com.DragSource(this._getDragSourceElement());this._dragsource.listen(jbx.events.DragDropEvent.CANDRAG,this._onCandrag,this);this._dragsource.listen(jbx.events.DragDropEvent.DRAGEND,this._onDragend,this);this._dragsource.listen(jbx.events.DragDropEvent.DRAGMOVE,this._onDragmove,this);this._dragsource.listen(jbx.events.DragDropEvent.DRAGSTART,this._onDragstart,this);this._dragsource.setDragThreshold(5);}else{this._dragsource.free();this._dragsource=null;}}};jbx[k][n][A].setParent=function(value){var ctrl=null;value=value||null;if(this.parent!=value){if(!jbx.isNull(this.parent)){if(this.parent.isContainer){this._setSupportedState(jbx.base.Control.State.ACTIVE,false);if(this.element.parentNode==this.parent.content){this.parent.removeChild(this);}}else{this.parent.removeChild(this.element);}}this.parent=value;if(value&&value.isContainer){this._setSupportedState(jbx.base.Control.State.ACTIVE,true);if(this.element.parentNode!=value.content){value.appendChild(this);}}else
if(!jbx.isNull(value)){ctrl=value.getAttribute('data-jbx-id');if(!jbx.isEmpty(ctrl)){ctrl=jbx.man.component.getComponent(ctrl);if(ctrl&&ctrl.isContainer){this.setParent(ctrl);return;}}if(this.element.parentNode!=value){value.appendChild(this.element);}}}};jbx[k][n][A].setTabIndex=function(value){var target=this._getKeyboardEventTarget();this.tabIndex=value||0;if(this.isFocusable()){target.tabIndex=this.isDisabled()?-1:this.tabIndex;}else{target.removeAttribute('tabIndex');}};jbx[k][n][A].setAccessKey=function(value){var target=this._getKeyboardEventTarget();this.accessKey=value||'';if(this.isFocusable()&&this.accessKey!=''){target.accessKey=this.isDisabled()?'':this.accessKey;}else{target.removeAttribute('accessKey');}};jbx[k][n][A].show=function(){this.setHidden(false);};jbx[k][n][A].hide=function(){this.setHidden(true);};jbx[k][n][A].enable=function(){this.setDisabled(false);};jbx[k][n][A].disable=function(){this.setDisabled(true);};jbx[k][n][A].focus=function(){this.setFocused(true);};jbx[k][n][A].blur=function(){this.setFocused(false);};jbx[k][n][A].click=function(){this._doClick();};jbx[x][z]=function(delay,repeat){var This=this;jbx.com.Timer.Super(this,'constructor');this.repeat=repeat||0;this.delay=delay||0;this.running=false;this.count=0;this._interval=function(){This._onTimer.call(This);};};jbx.extends('jbx.com.Timer','jbx.base.Component');jbx.com.Timer.TIMER='timer';jbx.com.Timer.START='start';jbx.com.Timer.STOP='stop';jbx.com.Timer.prototype.delay=0;jbx.com.Timer.prototype.repeat=0;jbx.com.Timer.prototype.count=0;jbx.com.Timer.prototype.running=false;jbx.com.Timer.prototype._timer=0;jbx.com.Timer.prototype._interval=null;jbx[x][z][A].free=function(){this.stop();this._interval=null;jbx.com.Timer.Super(this,'free');};jbx[x][z][A]._onTimer=function(){var repeat=false;this.count++;this._timer=0;repeat=this.delay>0&&(this.repeat==0||this.count<this.repeat);this.dispatch(jbx.com.Timer.TIMER);if(repeat){this._timer=setTimeout(this._interval,this.delay);}else{this.dispatch(jbx.com.Timer.STOP);this.running=false;}};jbx[x][z][A].stop=function(){this.pause();this.count=0;};jbx[x][z][A].start=function(){if(this._timer==0&&this.delay>0){this.running=true;this._timer=setTimeout(this._interval,this.delay);this.dispatch(jbx.com.Timer.START);}};jbx[x][z][A].pause=function(){if(this._timer>0){clearTimeout(this._timer);this.running=false;this._timer=0;this.dispatch(jbx.com.Timer.STOP);}};jbx[x][z][A].restart=function(){this.stop();this.start();};jbx[k][o]=function(timeout,id){jbx.base.Http.Super(this,'constructor',id);this.setTimeout(timeout);this.responseText='';};jbx.extends('jbx.base.Http','jbx.base.Component');jbx.base.Http.prototype.open=false;jbx.base.Http.prototype.error=false;jbx.base.Http.prototype.aborted=false;jbx.base.Http.prototype.timeout=false;jbx.base.Http.prototype.responseText='';jbx.base.Http.prototype.lastError='';jbx.base.Http.prototype._timer=null;jbx[k][o][A].free=function(){if(this._timer){this._timer.free();this._timer=null;}this._cleanHttp();this._lastError='';this.responseText='';jbx.base.Http.Super(this,'free');};jbx[k][o][A]._cleanHttp=function(){};jbx[k][o][A]._setError=function(message){this.error=true;this.lastError=message;this._timer&&this._timer.stop();this.dispatch(jbx.events.Event.ERROR);this._setComplete();};jbx[k][o][A]._setAborted=function(){this.aborted=true;this._timer&&this._timer.stop();this.dispatch(jbx.events.Event.ABORT);this._setComplete();};jbx[k][o][A]._setComplete=function(){this.open=false;this._timer&&this._timer.stop();this.dispatch(jbx.events.Event.COMPLETE);this._setReady();};jbx[k][o][A]._setReady=function(){this._cleanHttp();this._timer&&this._timer.stop();this.dispatch(jbx.events.Event.READY);};jbx[k][o][A]._onTimeout=function(e){this.timeout=true;this._setError('Connection timeout');};jbx[k][o][A].abort=function(){this.open&&this._setAborted();};jbx[k][o][A].send=function(url){throw new Error("jbx.base.Http is an abstract base class and should not be directly used.");};jbx[k][o][A].setTimeout=function(ms){ms=Math.max(0,ms);if(this._timer){this._timer.free();this._timer=null;}if(ms>0){this._timer=new jbx.com.Timer(ms,1);this._timer.listen(jbx.com.Timer.TIMER,this._onTimeout,this);this.open&&this._timer.start();}};jbx[k][o][A].toString=function(){return this.responseText;};jbx.man.animation._timerId=0;jbx.man.animation._animations={};jbx.man.animation.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||null;jbx.man.animation.cancelRequestAnimationFrame=window.cancelAnimationFrame||window.cancelRequestAnimationFrame||window.webkitCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.msCancelAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelAnimationFrame||window.oCancelRequestAnimationFrame||null;jbx[t][w]._doAnimationFrame=function(){var now=+new Date();jbx.man.animation._timerId=0;for(var i in jbx.man.animation._animations){jbx.man.animation._animations[i].cycle(now);}!jbx.isEmptyObject(jbx.man.animation._animations)&&jbx.man.animation._nextAnimationFrame();};jbx[t][w]._nextAnimationFrame=function(){if(!jbx.man.animation._timerId){jbx.man.animation._timerId=jbx.man.animation.requestAnimationFrame?jbx.man.animation.requestAnimationFrame.call(null,jbx.man.animation._doAnimationFrame):setTimeout(jbx.man.animation._doAnimationFrame,20);}};jbx[t][w].registerAnimation=function(anim){var id=jbx.getUniqueId(anim);jbx.man.animation._animations[id]=anim;jbx.man.animation._nextAnimationFrame();};jbx[t][w].unregisterAnimation=function(anim){var id=jbx.getUniqueId(anim);jbx.man.animation._animations[id]=null;delete jbx.man.animation._animations[id];if(jbx.isEmptyObject(jbx.man.animation._animations)&&jbx.man.animation._timerId!=0){jbx.man.animation.cancelRequestAnimationFrame?jbx.man.animation.cancelRequestAnimationFrame.call(null,jbx.man.animation._timerId):clearTimeout(jbx.man.animation._timerId);jbx.man.animation._timerId=0;}};jbx[Z][h]=function(type,dic){jbx.events.AnimationEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.AnimationEvent','jbx.events.Event');jbx.events.AnimationEvent.PLAY='play';jbx.events.AnimationEvent.BEGIN='begin';jbx.events.AnimationEvent.RESUME='resume';jbx.events.AnimationEvent.PAUSE='pause';jbx.events.AnimationEvent.STOP='stop';jbx.events.AnimationEvent.FINISH='finish';jbx.events.AnimationEvent.FRAME='frame';jbx.events.AnimationEvent.prototype.fps=0;jbx.events.AnimationEvent.prototype.progress=0;jbx.events.AnimationEvent.prototype.frameValue=0;jbx[Z][h][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=false;jbx.events.AnimationEvent.Super(this,'initEvent',type,dic);this.fps=dic.fps||0;this.progress=dic.progress||0;this.frameValue=dic.frameValue||0;};jbx[O][T].easeNone=function(p){return p;};jbx[O][T].easeIn=function(p){return p*p;};jbx[O][T].easeInStrong=function(p){return p*p*p;};jbx[O][T].easeOut=function(p){return 1-(1-p)*(1-p);};jbx[O][T].easeOutStrong=function(p){return 1-(1-p)*(1-p)*(1-p);};jbx[O][T].easeInOut=function(p){return(1-(2*p*p*p))-(1-(3*p*p));};jbx[O][T].easeOutIn=function(p,exp){return 2*p*p*p-3*p*p+2*p;};jbx[x][AA]=function(duration,easing){jbx.com.Animation.Super(this,'constructor');this.setDuration(duration);this.setEasing(easing);};jbx.extends('jbx.com.Animation','jbx.base.Component');jbx.com.Animation.prototype.fps=0;jbx.com.Animation.prototype.value=0;jbx.com.Animation.prototype.progress=0;jbx.com.Animation.prototype.duration=0;jbx.com.Animation.prototype.playing=false;jbx.com.Animation.prototype.startTime=null;jbx.com.Animation.prototype.endTime=null;jbx.com.Animation.prototype._easing=null;jbx.com.Animation.prototype._previousTime=null;jbx[x][AA][A].free=function(){this.stop();jbx.com.Animation.Super(this,'free');this._previousTime=null;this._easing=null;this.startTime=null;this.endTime=null;};jbx[x][AA][A]._doCycle=function(time){this.progress=this.duration>0?(time-this.startTime)/this.duration:1;this.progress=Math.max(Math.min(this.progress,1),0);this.value=this._easing.call(this,this.progress);this.fps=1000/(time-this._previousTime);};jbx[x][AA][A]._setTimeValues=function(){var now=+new Date();this.startTime=now-this.duration*this.progress;this.endTime=this.startTime+this.duration;this._previousTime=now;};jbx[x][AA][A].setEasing=function(value){this._easing=jbx.isFunction(value)?value:jbx.math.easing.easeNone;};jbx[x][AA][A].setDuration=function(value){this.duration=value||0;this.playing&&this._setTimeValues();};jbx[x][AA][A].setProgress=function(progress){this.progress=Math.max(Math.min(progress,1),0);this.playing&&this._setTimeValues();};jbx[x][AA][A].dispatch=function(type){var result=null,dic={target:this,frameValue:this.value,progress:this.progress,fps:this.fps},e=new jbx.events.AnimationEvent(type,dic);result=jbx.com.Animation.Super(this,'dispatch',e);e.free();return result;};jbx[x][AA][A].play=function(){var now=null;if(!this.playing){now=+new Date();this._setTimeValues();this.dispatch(jbx.events.AnimationEvent.PLAY);this.dispatch(this.progress>0?jbx.events.AnimationEvent.RESUME:jbx.events.AnimationEvent.BEGIN);this.playing=true;jbx.man.animation.registerAnimation(this);this.cycle(now);}};jbx[x][AA][A].stop=function(){this.playing=false;jbx.man.animation.unregisterAnimation(this);this.dispatch(jbx.events.AnimationEvent.STOP);this.progress=0;this.value=0;};jbx[x][AA][A].pause=function(){this.playing=false;jbx.man.animation.unregisterAnimation(this);this.dispatch(jbx.events.AnimationEvent.PAUSE);};jbx[x][AA][A].cycle=function(time){this._doCycle(time);this.dispatch(jbx.events.AnimationEvent.FRAME);this._previousTime=time;if(this.progress==1){this.dispatch(jbx.events.AnimationEvent.FINISH);this.stop();}};jbx[x][AB]=function(el){jbx.com.DropTarget.Super(this,'constructor');this.element=jbx.dom.getElement(el);jbx.man.dd.register(this);jbx.dom.classes.add(this.element,this.styleName);};jbx.extends('jbx.com.DropTarget','jbx.base.Component');jbx.com.DropTarget.prototype.element=null;jbx.com.DropTarget.prototype.area=null;jbx[x][AB][A].free=function(){jbx.dom.classes.remove(this.element,this.styleName);this.area=null;this.element=null;jbx.man.dd.unregister(this);jbx.com.DropTarget.Super(this,'free');};jbx[x][AB][A]._recalculateArea=function(){var area=jbx.dom.style.getBounds(this.element).toBox();if(!area.equals(this.area)){this.area=area;jbx.man.dd.recalculateOuterDropArea();}};jbx[x][AB][A].notifyCanDrop=function(source){var result=false,dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.CANDROP,source);result=this.dispatch(dde);if(result){this.element.setAttribute('aria-dropeffect',dde.dropEffect);jbx.dom.classes.add(this.element,this.styleName+'-valid');this.area=jbx.dom.style.getBounds(this.element).toBox();}else{this.element.setAttribute('aria-dropeffect','none');jbx.dom.classes.remove(this.element,this.styleName+'-valid');this.area=null;}dde.free();return result;};jbx[x][AB][A].notifyDragOver=function(source){var dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGOVER,source);this.dispatch(dde);dde.free();jbx.dom.classes.add(this.element,this.styleName+'-over');this._recalculateArea();};jbx[x][AB][A].notifyDragOut=function(source){var dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGOUT,source);this.dispatch(dde);dde.free();jbx.dom.classes.remove(this.element,this.styleName+'-over');this._recalculateArea();};jbx[x][AB][A].notifyDrop=function(source){jbx.dom.classes.remove(this.element,this.styleName+'-over');var dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DROP,source);this.dispatch(dde);dde.free();};jbx[x][AC]=function(el,threshold){jbx.com.DropTargetGroup.Super(this,'constructor',el);this._initDragSources(threshold);};jbx.extends('jbx.com.DropTargetGroup','jbx.com.DropTarget');jbx.com.DropTargetGroup.prototype.items=[];jbx.com.DropTargetGroup.prototype._bounds=[];jbx.com.DropTargetGroup.prototype._lastHDirection=0;jbx.com.DropTargetGroup.prototype._lastVDirection=0;jbx[x][AC][A].free=function(){for(var i=this.items.length-1;i>=0;i--){this.items[i].free();this.items[i]=null;}this._bounds=null;this.items=null;jbx.com.DropTargetGroup.Super(this,'free');};jbx[x][AC][A]._initDragSources=function(threshold){var ds=null,el=jbx.dom.firstChild(this.element);this.items=[];while(el){ds=new jbx.com.DragSource(el);ds.setDragThreshold(threshold||0);this.items.push(ds);el=jbx.dom.nextElement(el);}};jbx[x][AC][A]._recalculateBounds=function(setLimits){this._bounds=[];setLimits&&!this.area&&this._recalculateArea();for(var i=0,l=this.items.length;i<l;i++){this._bounds.push(jbx.dom.style.getBounds(this.items[i].element));setLimits&&this.items[i].setLimits(this.area);}};jbx[x][AC][A]._onDragEnd=function(e){var ds=e.dragSource,dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DROP,ds);this._bounds=[];ds.unlisten(jbx.events.DragDropEvent.DRAGMOVE,this._onDragMove,this);ds.unlisten(jbx.events.DragDropEvent.DRAGEND,this._onDragEnd,this);if(this.indexOf(ds)>=0){this.dispatch(dde);}dde.free();};jbx[x][AC][A]._onDragMove=function(e){var rec=null,ds=e.dragSource,dsrec=ds.getDraggerSize(),intersect=new jbx.math.Rect();this._lastHDirection=ds.hDirection!=0?ds.hDirection:this._lastHDirection;this._lastVDirection=ds.vDirection!=0?ds.vDirection:this._lastVDirection;for(var i=0,l=this._bounds.length;i<l;i++){ds=this.items[i];if(ds==e.dragSource){continue;}rec=this._bounds[i];intersect.setCoordinate(e.clientX,e.clientY);intersect.setSize(dsrec.width,dsrec.height);if(intersect.intersects(rec)){intersect.width=Math.min(rec.width,intersect.width);intersect.height=Math.min(rec.height,intersect.height);intersect.y=this._lastVDirection<=0?intersect.y:intersect.y+intersect.height-rec.height;intersect.x=this._lastHDirection<=0?intersect.x:intersect.x+intersect.width-rec.width;intersect.y=intersect.y+(intersect.height/2);intersect.x=intersect.x+(intersect.width/2);if(rec.containsPoint(intersect)){this.insertItemAt(e.dragSource,i);this._recalculateBounds();break;}}}};jbx[x][AC][A].notifyDragOver=function(source){var dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGOVER,source);if(!this.dispatch(dde)||this.indexOf(source)>=0){this._lastHDirection=0;this._lastVDirection=0;this.insertItem(source);source.listen(jbx.events.DragDropEvent.DRAGMOVE,this._onDragMove,this);source.listen(jbx.events.DragDropEvent.DRAGEND,this._onDragEnd,this);}dde.free();jbx.dom.classes.add(this.element,this.styleName+'-over');this._recalculateArea();this._recalculateBounds(true);};jbx[x][AC][A].notifyDragOut=function(source){var dde=null;if(this.indexOf(source)>=0){dde=jbx.man.dd.getDragDropEvent(jbx.events.DragDropEvent.DRAGOUT,source);if(!this.dispatch(dde)){source.unlisten(jbx.events.DragDropEvent.DRAGMOVE,this._onDragMove,this);source.unlisten(jbx.events.DragDropEvent.DRAGEND,this._onDragEnd,this);source.setLimits(null);this.removeItem(source);}dde.free();jbx.dom.classes.remove(this.element,this.styleName+'-over');this._recalculateArea();}};jbx[x][AC][A].indexOf=function(ds){return jbx.array.indexOf(this.items,ds);};jbx[x][AC][A].indexOfElement=function(el){for(var i=0,l=this.items.length;i<l;i++){if(this.items[i].element===el){return i;}}return-1;};jbx[x][AC][A].addItem=function(el){var ds=new jbx.com.DragSource(el);this.insertItem(ds);};jbx[x][AC][A].addItemAt=function(el,index){var ds=new jbx.com.DragSource(el);this.insertItemAt(ds,index);};jbx[x][AC][A].insertItem=function(item){this.indexOf(item)==-1&&this.insertItemAt(item,this.items.length);};jbx[x][AC][A].insertItemAt=function(item,index){index=index<0?0:index;index=index>this.items.length?this.items.length:index;if(this.indexOf(item)==index){return;}this.removeItem(item);if(this.items[index]){jbx.dom.insertBefore(item.element,this.items[index].element);this.items.splice(index,0,item);}else{this.element.appendChild(item.element);this.items.push(item);}};jbx[x][AC][A].removeItem=function(item){var pos=this.indexOf(item);if(pos>=0){this.items.splice(pos,1);}};jbx[Z][i]=function(type,dic){jbx.events.ResizeEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.ResizeEvent','jbx.events.Event');jbx.events.ResizeEvent.RESIZESTART='resizestart';jbx.events.ResizeEvent.RESIZE='resize';jbx.events.ResizeEvent.RESIZEEND='resizeend';jbx.events.ResizeEvent.prototype.top=0;jbx.events.ResizeEvent.prototype.left=0;jbx.events.ResizeEvent.prototype.width=0;jbx.events.ResizeEvent.prototype.height=0;jbx.events.ResizeEvent.prototype.handler=0;jbx[Z][i][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=false;jbx.events.ResizeEvent.Super(this,'initEvent',type,dic);this.top=dic.top||0;this.left=dic.left||0;this.width=dic.width||0;this.height=dic.height||0;this.handler=dic.handler||0;};jbx[x][AD]=function(el,handlers){jbx.com.Resize.Super(this,'constructor');this.element=jbx.dom.getElement(el);this._resizeHandlers={};this.setTarget(this.element);this.setHandlers(handlers);jbx.dom.classes.add(this.element,this.styleName);};jbx.extends('jbx.com.Resize','jbx.base.Component');jbx.com.Resize.prototype.element=null;jbx.com.Resize.prototype.target=null;jbx.com.Resize.prototype.enabled=true;jbx.com.Resize.prototype.resizing=false;jbx.com.Resize.prototype.interactiveResize=true;jbx.com.Resize.prototype._helper=null;jbx.com.Resize.prototype._bounds=null;jbx.com.Resize.prototype._handlersBounds=null;jbx.com.Resize.prototype._resizeHandlers=null;jbx.com.Resize.prototype._handlersDistanceValue=0;jbx.com.Resize.prototype._handlersDistanceUnit='px';jbx[x][AD][A].free=function(){var el=null,handler=null;for(var i in this._resizeHandlers){handler=this._resizeHandlers[i];el=handler.element;handler.free();el.parentNode.removeChild(el);this._resizeHandlers[i]=null;}this._helper&&this._helper.parentNode.removeChild(this._helper);jbx.dom.classes.remove(this.element,this.styleName);this._resizeHandlers=null;this._handlersBounds=null;this.element=null;this._bounds=null;this._helper=null;this.target=null;jbx.com.Resize.Super(this,'free');};jbx[x][AD][A]._alignHandler=function(handler,rec){var el=handler.element,sides=handler['sides'],top=sides&jbx.dom.style.Side.TOP,left=sides&jbx.dom.style.Side.LEFT,right=sides&jbx.dom.style.Side.RIGHT,bottom=sides&jbx.dom.style.Side.BOTTOM;if(sides==jbx.dom.style.Side.TOP||sides==jbx.dom.style.Side.BOTTOM){el.style.width=rec.width+'px';}if(sides==jbx.dom.style.Side.LEFT||sides==jbx.dom.style.Side.RIGHT){el.style.height=rec.height+'px';}rec=jbx.dom.style.align(handler.element,rec,sides,left||right?this._handlersDistanceValue:0,top||bottom?this._handlersDistanceValue:0,this._handlersDistanceUnit=='%',false);jbx.dom.style.setGlobalPosition(el,rec.y,rec.x);};jbx[x][AD][A]._createHandler=function(sides){var parent=this.element,el=document.createElement('DIV'),top=sides&jbx.dom.style.Side.TOP,left=sides&jbx.dom.style.Side.LEFT,right=sides&jbx.dom.style.Side.RIGHT,bottom=sides&jbx.dom.style.Side.BOTTOM,cls=jbx.dom.style.SideName[sides]||jbx.dom.style.CornerName[sides];el.style.position="absolute";el.style.zIndex=jbx.dom.style.zIndex.TOP++;parent.insertBefore(el,parent.firstChild);jbx.dom.classes.add(el,this.styleName+'-handler');if((top||bottom)&&(left||right)){jbx.dom.classes.add(el,this.styleName+'-handler-corner');}else
if(top||bottom){jbx.dom.classes.add(el,this.styleName+'-handler-vertical');}else
if(left||right){jbx.dom.classes.add(el,this.styleName+'-handler-horizontal');}cls&&jbx.dom.classes.add(el,this.styleName+'-handler-'+cls);handler=new jbx.com.DragSource(el);handler['sides']=sides;handler.documentScroll=true;handler.listen(jbx.events.DragDropEvent.DRAGSTART,this._onHandlerDragStart,this);handler.listen(jbx.events.DragDropEvent.DRAGMOVE,this._onHandlerDragMove,this);handler.listen(jbx.events.DragDropEvent.DRAGEND,this._onHandlerDragEnd,this);handler.notifyDropTargets=false;this._resizeHandlers[sides]=handler;return handler;};jbx[x][AD][A]._updateHandlers=function(rec){for(var i in this._resizeHandlers){this._resizeHandlers[i]&&this._alignHandler(this._resizeHandlers[i],rec);}};jbx[x][AD][A]._updateElement=function(el,handler,nw,nh,tw,th){var dif=0,erec=this._bounds;jbx.dom.style.setSize(el,nw,nh);erec.setSize(el.offsetWidth,el.offsetHeight);if(handler&jbx.dom.style.Side.LEFT){dif=erec.width-tw;if(dif>0){erec.x-=dif;}}if(handler&jbx.dom.style.Side.TOP){dif=erec.height-th;if(dif>0){erec.y-=dif;}}if(jbx.dom.style.getStyle(this.element,'position')!='relative'){jbx.dom.style.setGlobalPosition(el,erec.y,erec.x);}};jbx[x][AD][A]._doResizeStart=function(e,handler){var event=null,rec=this._bounds,dic={target:this,handler:handler,top:rec.y,left:rec.x,width:rec.width,height:rec.height};event=new jbx.events.ResizeEvent(jbx.events.ResizeEvent.RESIZESTART,dic);event.setEvent(e,false);this.dispatch(event);event.free();};jbx[x][AD][A]._doResizeEnd=function(e,handler){this._doResizeEvent(e,this.target,handler,jbx.events.ResizeEvent.RESIZEEND);};jbx[x][AD][A]._doResize=function(e,handler){this._doResizeEvent(e,this.interactiveResize?this.target:this._helper,handler,jbx.events.ResizeEvent.RESIZE);};jbx[x][AD][A]._doResizeEvent=function(e,el,handler,event){var erec=this._bounds,hrec=this._handlersBounds,dic={target:this,handler:handler,top:hrec.y,left:hrec.x,width:hrec.width,height:hrec.height};event=new jbx.events.ResizeEvent(event,dic);event.setEvent(e,false);if(this.dispatch(event)){erec.setSize(event.width,event.height);erec.setCoordinate(event.left,event.top);this._updateElement(el,handler,erec.width,erec.height,hrec.width,hrec.height);this._updateHandlers(this._bounds);}event.free();};jbx[x][AD][A]._onHandlerDragStart=function(e){var parent=this.element,rec=jbx.dom.style.getBounds(this.target);this._bounds=rec;this._handlersBounds=rec.clone();if(!this.interactiveResize){if(!this._helper){this._helper=document.createElement('DIV');this._helper.style.position="absolute";this._helper.style.zIndex=jbx.dom.style.zIndex.MID++;jbx.dom.style.setOpacity(this._helper,0.4);jbx.dom.classes.add(this._helper,this.styleName+'-helper');parent.insertBefore(this._helper,parent.firstChild);}this._helper.style.display='block';jbx.dom.style.setBounds(this._helper,rec.y,rec.x,rec.width,rec.height);}this.resizing=true;jbx.dom.classes.add(this.target,this.styleName+'-resizing');this._doResizeStart(e.event,e.target['sides']);};jbx[x][AD][A]._onHandlerDragEnd=function(e){if(this._helper){this._helper.style.display='none';}this.resizing=false;jbx.dom.classes.remove(this.target,this.styleName+'-resizing');this._doResizeEnd(e.event,e.target['sides']);e.preventDefault();};jbx[x][AD][A]._onHandlerDragMove=function(e){var ds=e.dragSource,sides=e.target['sides'],rec=this._handlersBounds;if(sides&jbx.dom.style.Side.TOP){rec.y+=ds.vDirection;rec.height-=ds.vDirection;}if(sides&jbx.dom.style.Side.LEFT){rec.x+=ds.hDirection;rec.width-=ds.hDirection;}if(sides&jbx.dom.style.Side.RIGHT){rec.width+=ds.hDirection;}if(sides&jbx.dom.style.Side.BOTTOM){rec.height+=ds.vDirection;}this._doResize(e.event,sides);e.preventDefault();};jbx[x][AD][A].getWidth=function(){return this._bounds.width;};jbx[x][AD][A].getHeight=function(){return this._bounds.height;};jbx[x][AD][A].setWidth=function(value){this.resize(value,this.getHeight());};jbx[x][AD][A].setHeight=function(value){this.resize(this.getWidth(),value);};jbx[x][AD][A].setTarget=function(el){this.target=el;this._bounds=jbx.dom.style.getBounds(el);this._updateHandlers(this._bounds);};jbx[x][AD][A].setHandlersDistance=function(value){value=value+'';this._handlersDistanceUnit=value.indexOf('%')>=0?'%':'px';value=parseInt(value);this._handlersDistanceValue=isNaN(value)?0:value;this._updateHandlers(this._bounds);};jbx[x][AD][A].setHandlers=function(value){var handler=null,el=this.element,sides=value||0,position=jbx.dom.style.getStyle(el,'position'),floating=position=='absolute'||position=='fixed',top=(sides==0||sides&jbx.dom.style.Side.TOP)&&floating,left=(sides==0||sides&jbx.dom.style.Side.LEFT)&&floating,right=(sides==0||sides&jbx.dom.style.Side.RIGHT),bottom=(sides==0||sides&jbx.dom.style.Side.BOTTOM),create=[[top,jbx.dom.style.Side.TOP],[left,jbx.dom.style.Side.LEFT],[right,jbx.dom.style.Side.RIGHT],[bottom,jbx.dom.style.Side.BOTTOM],[top&&left,jbx.dom.style.Corner.TOPLEFT],[top&&right,jbx.dom.style.Corner.TOPRIGHT],[bottom&&left,jbx.dom.style.Corner.BOTTOMLEFT],[bottom&&right,jbx.dom.style.Corner.BOTTOMRIGHT]];if(!floating){el.style.position='relative';}for(var i=0;i<8;i++){sides=create[i][1];handler=this._resizeHandlers[sides];if(!create[i][0]){if(handler){el=handler.element;handler.free();el.parentNode.removeChild(el);this._resizeHandlers[sides]=null;}}else{handler=handler||this._createHandler(sides);this._alignHandler(handler,this._bounds);}}};jbx[x][AD][A].enable=function(){if(!this.enabled){this.enabled=true;for(var i in this._resizeHandlers){if(this._resizeHandlers[i]){this._resizeHandlers[i].element.style.display='block';}}}};jbx[x][AD][A].disable=function(){if(this.enabled){this.enabled=false;for(var i in this._resizeHandlers){if(this._resizeHandlers[i]){this._resizeHandlers[i].element.style.display='none';}}}};jbx[x][AD][A].resize=function(width,height){this._updateElement(this.target,jbx.dom.style.Corner.BOTTOMRIGHT,width,height,width,height);this._updateHandlers(this._bounds);};jbx[O][W]=function(cx,cy,rx,ry,x_axis_rotation){this.cx=cx||0;this.cy=cy||0;this.rx=rx||0;this.ry=ry||0;this.rotate(x_axis_rotation);if(this.rx<this.ry){this.rx=ry||0;this.ry=rx||0;this.rotate(90);}};jbx.math.Ellipse.Expression=/^E\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)$/;jbx.math.Ellipse.prototype.cx=0;jbx.math.Ellipse.prototype.cy=0;jbx.math.Ellipse.prototype.rx=0;jbx.math.Ellipse.prototype.ry=0;jbx.math.Ellipse.prototype.x_axis_rotation=0;jbx[O][W].parse=function(str){var x1=0,y1=0,rx=0,ry=0,x_axis_rotation=0,r=str.match(jbx.math.Ellipse.Expression);if(r){x1=parseFloat(r[1]);y1=parseFloat((r[2]=='-'?'-':'')+r[3]);rx=parseFloat(r[4]);ry=parseFloat((r[5]=='-'?'-':'')+r[6]);x_axis_rotation=parseFloat(r[7]);return new jbx.math.Ellipse(x1,y1,rx,ry,x_axis_rotation);}return false;};jbx[O][W][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return'E '+this.cx.toFixed(precision).replace(/\.?0+$/,'')+','+this.cy.toFixed(precision).replace(/\.?0+$/,'')+' '+this.rx.toFixed(precision).replace(/\.?0+$/,'')+','+this.ry.toFixed(precision).replace(/\.?0+$/,'')+' '+this.x_axis_rotation.toFixed(precision).replace(/\.?0+$/,'');};jbx[O][W][A].clone=function(){return new jbx.math.Ellipse(this.cx,this.cy,this.rx,this.ry,this.x_axis_rotation);};jbx[O][W][A]._getRotatedPoint=function(x,y){var ar=jbx.math.toRadians(this.x_axis_rotation),px=(x-this.cx)*Math.cos(ar)-(y-this.cy)*Math.sin(ar),py=(x-this.cx)*Math.sin(ar)+(y-this.cy)*Math.cos(ar);return new jbx.math.Point(px+this.cx,py+this.cy);};jbx[O][W][A].getFocusDistance=function(){return Math.sqrt(this.rx*this.rx-this.ry*this.ry);};jbx[O][W][A].getFocusPoint=function(positive){var f=this.getFocusDistance();return this._getRotatedPoint(this.cx+f*(positive!==false?1:-1),this.cy);};jbx[O][W][A].getEllipsePoint=function(a){var ra=jbx.math.toRadians(a),rr=jbx.math.toRadians(this.x_axis_rotation),xp=this.cx+this.rx*Math.cos(ra)*Math.cos(rr)+this.ry*Math.sin(ra)*Math.sin(rr),yp=this.cy+this.rx*Math.cos(ra)*Math.sin(rr)-this.ry*Math.sin(ra)*Math.cos(rr);return new jbx.math.Point(xp,yp);};jbx[O][W][A].getPoint=function(t){return this.getEllipsePoint(360*t);};jbx[O][W][A].getEllipseArc=function(fromAngle,toAngle){var large_arc=false,sweep_flag=false,p1=this.getEllipsePoint(fromAngle),p2=this.getEllipsePoint(toAngle);toAngle=toAngle==0?360:toAngle;if(toAngle-fromAngle>=180){large_arc=true;sweep_flag=false;}if(toAngle<fromAngle){large_arc=false;sweep_flag=true;}return new jbx.math.Arc(p1.x,p1.y,this.rx,this.ry,this.x_axis_rotation,large_arc,sweep_flag,p2.x,p2.y);};jbx[O][W][A].getArc=function(t1,t2){return this.getEllipseArc(t1*360,t2*360);};jbx[O][W][A].translate=function(tx,ty){this.cx+=tx;this.cy+=ty;};jbx[O][W][A].rotate=function(a){this.x_axis_rotation+=a;this.x_axis_rotation=this.x_axis_rotation%360;if(this.x_axis_rotation<0){this.x_axis_rotation+=360;}};jbx[O][V]=function(x1,y1,rx,ry,x_axis_rotation,large_arc_flag,sweep_flag,x2,y2){this.x1=x1||0;this.y1=y1||0;this.x2=x2||0;this.y2=y2||0;this.rx=rx||0;this.ry=ry||0;this.sweep_flag=!!sweep_flag;this.large_arc_flag=!!large_arc_flag;this.x_axis_rotation=x_axis_rotation||0;this._parameterize();};jbx.math.Arc.Expression=/^A\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)\s+(0|1)\s+(0|1)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)$/;jbx.math.Arc.prototype.x1=0;jbx.math.Arc.prototype.y1=0;jbx.math.Arc.prototype.x2=0;jbx.math.Arc.prototype.y2=0;jbx.math.Arc.prototype.rx=0;jbx.math.Arc.prototype.ry=0;jbx.math.Arc.prototype.sweep_flag=false;jbx.math.Arc.prototype.large_arc_flag=false;jbx.math.Arc.prototype.x_axis_rotation=0;jbx.math.Arc.prototype.cx=0;jbx.math.Arc.prototype.cy=0;jbx.math.Arc.prototype.angleStart=0;jbx.math.Arc.prototype.angleExtent=0;jbx[O][V].parse=function(str){var x1=0,y1=0,rx=0,ry=0,x2=0,y2=0,x_axis_rotation=0,large_arc_flag=0,sweep_flag=0,r=str.match(jbx.math.Arc.Expression);if(r){x1=parseFloat(r[1]);y1=parseFloat((r[2]=='-'?'-':'')+r[3]);rx=parseFloat(r[4]);ry=parseFloat((r[5]=='-'?'-':'')+r[6]);x_axis_rotation=parseFloat(r[7]);sweep_flag=parseInt(r[8])==1;large_arc_flag=parseInt(r[9])==1;x2=parseFloat(r[10]);y2=parseFloat((r[11]=='-'?'-':'')+r[12]);return new jbx.math.Arc(x1,y1,rx,ry,x_axis_rotation,sweep_flag,large_arc_flag,x2,y2);}return false;};jbx[O][V][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return'A '+this.x1.toFixed(precision).replace(/\.?0+$/,'')+','+this.y1.toFixed(precision).replace(/\.?0+$/,'')+' '+this.rx.toFixed(precision).replace(/\.?0+$/,'')+','+this.ry.toFixed(precision).replace(/\.?0+$/,'')+' '+this.x_axis_rotation.toFixed(precision).replace(/\.?0+$/,'')+' '+(this.large_arc_flag?1:0)+' '+(this.sweep_flag?1:0)+' '+this.x2.toFixed(precision).replace(/\.?0+$/,'')+','+this.y2.toFixed(precision).replace(/\.?0+$/,'');};jbx[O][V][A].clone=function(){return new jbx.math.Arc(this.x1,this.y1,this.rx,this.ry,this.x_axis_rotation,this.large_arc_flag,this.sweep_flag,this.x2,this.y2);};jbx[O][V][A]._parameterize=function(){var dx2=(this.x1-this.x2)/2,dy2=(this.y1-this.y2)/2;var angle=jbx.math.toRadians(this.x_axis_rotation),cosAngle=Math.cos(angle),sinAngle=Math.sin(angle);var x1=(cosAngle*dx2+sinAngle*dy2),y1=(cosAngle*dy2-sinAngle*dx2),rx=Math.abs(this.rx),ry=Math.abs(this.ry),Prx=rx*rx,Pry=ry*ry,Px1=x1*x1,Py1=y1*y1,radiiCheck=Px1/Prx+Py1/Pry;if(radiiCheck>1){rx=Math.sqrt(radiiCheck)*rx;ry=Math.sqrt(radiiCheck)*ry;Prx=rx*rx;Pry=ry*ry;}var sign=(this.large_arc_flag==this.sweep_flag)?-1:1,sq=((Prx*Pry)-(Prx*Py1)-(Pry*Px1))/((Prx*Py1)+(Pry*Px1));sq=(sq<0)?0:sq;var coef=(sign*Math.sqrt(sq)),cx1=coef*((rx*y1)/ry),cy1=coef*-((ry*x1)/rx);var sx2=(this.x1+this.x2)/2,sy2=(this.y1+this.y2)/2,cx=sx2+(cosAngle*cx1-sinAngle*cy1),cy=sy2+(sinAngle*cx1+cosAngle*cy1);this.cx=cx;this.cy=cy;var p=0,n=0,ux=(x1-cx1)/rx,uy=(y1-cy1)/ry,vx=(-x1-cx1)/rx,vy=(-y1-cy1)/ry;n=Math.sqrt((ux*ux)+(uy*uy));p=ux;sign=(uy<0)?-1:1;this.angleStart=jbx.math.toDegrees(sign*Math.acos(p/n));n=Math.sqrt((ux*ux+uy*uy)*(vx*vx+vy*vy));p=ux*vx+uy*vy;sign=(ux*vy-uy*vx<0)?-1:1;this.angleExtent=jbx.math.toDegrees(sign*Math.acos(p/n));if(!this.sweep_flag&&this.angleExtent>0){this.angleExtent-=360;}else
if(this.sweep_flag&&this.angleExtent<0){this.angleExtent+=360;}this.angleStart=this.angleStart%360;this.angleExtent=this.angleExtent%360;};jbx[O][V][A].getPoint=function(t){var angle=jbx.math.toRadians(this.angleStart+(this.angleExtent*t)),cosr=Math.cos(jbx.math.toRadians(this.x_axis_rotation)),sinr=Math.sin(jbx.math.toRadians(this.x_axis_rotation)),x=cosr*Math.cos(angle)*this.rx-sinr*Math.sin(angle)*this.ry+this.cx,y=sinr*Math.cos(angle)*this.rx+cosr*Math.sin(angle)*this.ry+this.cy;return new jbx.math.Point(x,y);};jbx[O][V][A].getEllipse=function(){return new jbx.math.Ellipse(this.cx,this.cy,this.rx,this.ry,this.x_axis_rotation);};jbx[O][X]=function(x0,y0,x1,y1){this.x0=x0||0;this.y0=y0||0;this.x1=x1||0;this.y1=y1||0;};jbx.math.Line.Expression=/^M\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*(L|l)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)$/;jbx.math.Line.prototype.x0=null;jbx.math.Line.prototype.y0=null;jbx.math.Line.prototype.x1=null;jbx.math.Line.prototype.y1=null;jbx[O][X].parse=function(str){var x0=0,y0=0,x1=0,y1=0,r=str.match(jbx.math.Line.Expression);if(r){x0=parseFloat(r[1]);y0=parseFloat((r[2]=='-'?'-':'')+r[3]);x1=parseFloat(r[5]);y1=parseFloat((r[6]=='-'?'-':'')+r[7]);if(r[4]==='l'){x1+=x0;y1+=y0;}return new jbx.math.Line(x0,y0,x1,y1);}return false;};jbx[O][X][A].toString=function(precision){precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;return'M '+this.x0.toFixed(precision).replace(/\.?0+$/,'')+','+this.y0.toFixed(precision).replace(/\.?0+$/,'')+' '+'L '+this.x1.toFixed(precision).replace(/\.?0+$/,'')+','+this.y1.toFixed(precision).replace(/\.?0+$/,'');};jbx[O][X][A].getLength=function(){var dx=this.x1-this.x0,dy=this.y1-this.y0;return Math.sqrt(dx*dx+dy*dy);};jbx[O][X][A].getY=function(dx){var m=(this.y1-this.y0)/(this.x1-this.x0);return((dx-this.x0)*m)+this.y0;};jbx[O][X][A].getPoint=function(t){var p=new jbx.math.Point(0,0);p.x=jbx.math.lerp(this.x0,this.x1,t);p.y=jbx.math.lerp(this.y0,this.y1,t);return p;};jbx[O][X][A].clone=function(){return new jbx.math.Line(this.x0,this.y0,this.x1,this.y1);};jbx[O][X][A].equals=function(ln){return ln&&this.x0==ln.x0&&this.y0==ln.y0&&this.x1==ln.x1&&this.y1==ln.y1;};jbx[O][X][A].translate=function(tx,ty){this.x0+=tx;this.x1+=tx;this.y0+=ty;this.y1+=ty;};jbx[O][Y]=function(points){points=!jbx.isArray(points)?[]:points;if(points.length==0){points.push(new jbx.math.Point(0,0));}this.points=points;};jbx.math.Curve.MoveToExpression=/^M\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*(.*)$/;jbx.math.Curve.QuadraticCurveToExpression=/^(Q|q)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)$/;jbx.math.Curve.CubicCurveToExpression=/^(C|c)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)\s*([+-]?\d*\.?\d+)(\s*,\s*|\s+|[+-])([+-]?\d*\.?\d+)$/;jbx.math.Curve.prototype.points=[];jbx[O][Y].parse=function(str){var i=0,x0=0,y0=0,x1=0,y1=0,curve='',points=[],valid=false,res=str.match(jbx.math.Curve.MoveToExpression);if(res){x0=parseFloat(res[1]);y0=parseFloat((res[2]=='-'?'-':'')+res[3]);points.push(new jbx.math.Point(x0,y0));curve=res[4];res=curve.match(jbx.math.Curve.QuadraticCurveToExpression);if(res){valid=true;for(i=0;i<2;i++){x1=parseFloat(res[2+(3*i)]);y1=parseFloat((res[3+(3*i)]=='-'?'-':'')+res[4+(3*i)]);if(res[1]=='q'){x1+=x0;y1+=y0;}points.push(new jbx.math.Point(x1,y1));}}else{res=curve.match(jbx.math.Curve.CubicCurveToExpression);if(res){valid=true;for(i=0;i<3;i++){x1=parseFloat(res[2+(3*i)]);y1=parseFloat((res[3+(3*i)]=='-'?'-':'')+res[4+(3*i)]);if(res[1]=='c'){x1+=x0;y1+=y0;}points.push(new jbx.math.Point(x1,y1));}}}}return valid?new jbx.math.Curve(points):false;};jbx[O][Y][A]._interpolate=function(points,t){var i=0,pi=null,p1=null,p2=null,result=[];for(i=0;i<points.length-1;i++){pi=new jbx.math.Point(0,0);p1=points[i];p2=points[i+1];pi.x=jbx.math.lerp(p1.x,p2.x,t);pi.y=jbx.math.lerp(p1.y,p2.y,t);result.push(pi);}return result;};jbx[O][Y][A].toString=function(precision){var str=[],count=0,command=[];precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;for(count=1;count<this.points.length;count++){str.push(this.points[count].x.toFixed(precision).replace(/\.?0+$/,'')+','+this.points[count].y.toFixed(precision).replace(/\.?0+$/,''));}command.push('M ');command.push(this.points[0].x.toFixed(precision).replace(/\.?0+$/,''));command.push(',');command.push(this.points[0].y.toFixed(precision).replace(/\.?0+$/,''));if(this.points.length>1){switch(this.points.length){case 2:command.push(' L '+str.join(' '));break;case 3:command.push(' Q '+str.join(' '));break;case 4:command.push(' C '+str.join(' '));break;default:command.push(' X '+str.join(' '));break;}}return command.join('')+'';};jbx[O][Y][A].clone=function(){var count=0,points=[];for(count=0;count<this.points.length;count++){points.push(this.points[count].clone());}return new jbx.math.Curve(points);};jbx[O][Y][A].getPoint=function(t){var points=this.points;t=Math.max(0,Math.min(1,t));if(t==0){return this.points[0].clone();}if(t==1){return this.points[this.points.length-1].clone();}while(points.length>1){points=this._interpolate(points,t);}return points.length?points[0]:null;};jbx[O][Y][A].getCurveFromLeft=function(t){var result=[],points=this.points;t=Math.max(0,Math.min(1,t));if(t==1||t==0){return this.clone();}result.unshift(points[points.length-1]);while(points.length>1){points=this._interpolate(points,t);result.unshift(points[points.length-1]);}return new jbx.math.Curve(result);};jbx[O][Y][A].getCurveFromRight=function(t){var result=[],points=this.points;t=Math.max(0,Math.min(1,t));if(t==1||t==0){return this.clone();}result.push(points[0]);while(points.length>1){points=this._interpolate(points,t);result.push(points[0]);}return new jbx.math.Curve(result);};jbx[O][U]=function(){this.clear();};jbx[O][U].Command={MOVETO:'M',CLOSEPATH:'Z',LINETO:'L',HORIZONTALLINETO:'H',VERTICALLINETO:'V',CURVETO:'C',SMOOTHCURVETO:'S',QUADRATICCURVETO:'Q',SMOOTHQUADRATICCURVETO:'T',ARCTO:'A'};jbx.math.Path.prototype.segmentsCount=0;jbx.math.Path.prototype._commands=[];jbx.math.Path.prototype._closePoint=null;jbx.math.Path.prototype._currentPoint=null;jbx.math.Path.prototype._computedPath=null;jbx[O][U].parse=function(str){var i=0,j=0,cmd='',offx=0,offy=0,absx=0,absy=0,values=null,segments=null,path=new jbx.math.Path();str=jbx.string.trim(str).replace(/\n/g,' ').replace(/\r/g,' ');if(str.substring(0,1)!='M'){return false;}segments=str.match(/[MZLHVCSQTA][0-9+\-\., ]*/ig);if(!segments){return false;}for(i=0;i<segments.length;i++){cmd=segments[i].substring(0,1);values=segments[i].substring(1).match(/[+\-]?[0-9\.]+/g);if(values){for(j=0;j<values.length;j++){values[j]=jbx.string.trim(values[j]);values[j]=values[j].substring(0,1)=='+'?values[j].substring(1):values[j];values[j]=parseFloat(values[j]);if(isNaN(values[j])){return false;}}}offx=0;offy=0;if(cmd.toLowerCase()==cmd){offx=absx;offy=absy;}switch(cmd.toUpperCase()){case jbx.math.Path.Command.CLOSEPATH:path.closePath();break;case jbx.math.Path.Command.MOVETO:if(!values.length||values.length%2!=0){return false;}for(j=0;j<values.length;j+=2){path.moveTo(values[j]+offx,values[j+1]+offy);}break;case jbx.math.Path.Command.LINETO:if(!values.length||values.length%2!=0){return false;}for(j=0;j<values.length;j+=2){path.lineTo(values[j]+offx,values[j+1]+offy);}break;case jbx.math.Path.Command.HORIZONTALLINETO:if(!values.length){return false;}for(j=0;j<values.length;j++){path.horizontalLineTo(values[j]+offx);}break;case jbx.math.Path.Command.VERTICALLINETO:if(!values.length){return false;}for(j=0;j<values.length;j++){path.verticalLineTo(values[j]+offy);}break;case jbx.math.Path.Command.CURVETO:if(!values.length||values.length%6!=0){return false;}for(j=0;j<values.length;j+=6){path.curveTo(values[j]+offx,values[j+1]+offy,values[j+2]+offx,values[j+3]+offy,values[j+4]+offx,values[j+5]+offy);}break;case jbx.math.Path.Command.SMOOTHCURVETO:if(!values.length||values.length%4!=0){return false;}for(j=0;j<values.length;j+=4){path.smoothCurveTo(values[j]+offx,values[j+1]+offy,values[j+2]+offx,values[j+3]+offy);}break;case jbx.math.Path.Command.QUADRATICCURVETO:if(!values.length||values.length%4!=0){return false;}for(j=0;j<values.length;j+=4){path.quadraticCurveTo(values[j]+offx,values[j+1]+offy,values[j+2]+offx,values[j+3]+offy);}break;case jbx.math.Path.Command.SMOOTHQUADRATICCURVETO:if(!values.length||values.length%2!=0){return false;}for(j=0;j<values.length;j+=2){path.smoothQuadraticCurveTo(values[j]+offx,values[j+1]+offy);}break;case jbx.math.Path.Command.ARCTO:if(!values.length||values.length%7!=0){return false;}for(j=0;j<values.length;j+=7){path.arcTo(values[j],values[j+1],values[j+2],values[j+3],values[j+4],values[j+5]+offx,values[j+6]+offy);}break;}absx=path.getCurrentPoint().x;absy=path.getCurrentPoint().y;}return path;};jbx[O][U][A]._getLastCommand=function(){if(this._commands.length){return this._commands[this._commands.length-1];}return null;};jbx[O][U][A].toString=function(precision,compressed,absolute){var i=0,j=0,offx=0,offy=0,inix=0,iniy=0,cmd=null,values=[],segment=null,pathdata=[];precision=jbx.isDefined(precision)?precision:2;precision=precision<1?1:precision;for(i=0;i<this._commands.length;i++){segment=this._commands[i];if(segment[0]==jbx.math.Path.Command.CLOSEPATH){if(i==this._commands.length-1||(this._commands[i+1]&&this._commands[i+1][0].toUpperCase()==jbx.math.Path.Command.MOVETO)){pathdata.push('z');offx=inix-(absolute?0:offx);offy=iniy-(absolute?0:offy);continue;}}if(segment[0]==jbx.math.Path.Command.MOVETO){pathdata.push('M');pathdata.push(segment[1].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(segment[2]+'').substring(0,1)=='-'?'':',')+segment[2].toFixed(precision).replace(/\.?0+$/,''));offx=segment[1];offy=segment[2];continue;}cmd=segment[0];values=segment.concat().splice(1);if(!absolute&&i>0){pathdata.push(cmd.toLowerCase());if(cmd==jbx.math.Path.Command.ARCTO){values[5]-=offx;values[6]-=offy;}else
if(cmd==jbx.math.Path.Command.HORIZONTALLINETO){values[0]-=offx;}else
if(cmd==jbx.math.Path.Command.VERTICALLINETO){values[0]-=offy;}else{for(j=0;j<values.length;j+=2){values[j]-=offx;values[j+1]-=offy;}}}else{pathdata.push(cmd);}segment=[];switch(values.length){case 1:pathdata.push(values[0].toFixed(precision).replace(/\.?0+$/,''));break;case 6:segment.unshift((compressed&&(values[4]+'').substring(0,1)=='-'?'':' ')+values[4].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[5]+'').substring(0,1)=='-'?'':',')+values[5].toFixed(precision).replace(/\.?0+$/,''));case 4:segment.unshift((compressed&&(values[2]+'').substring(0,1)=='-'?'':' ')+values[2].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[3]+'').substring(0,1)=='-'?'':',')+values[3].toFixed(precision).replace(/\.?0+$/,''));case 2:segment.unshift(values[0].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[1]+'').substring(0,1)=='-'?'':',')+values[1].toFixed(precision).replace(/\.?0+$/,''));pathdata.push(segment.join(''));break;case 7:pathdata.push(values[0].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[1]+'').substring(0,1)=='-'?'':',')+values[1].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[2]+'').substring(0,1)=='-'?'':' ')+values[2].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[3]+'').substring(0,1)=='-'?'':' ')+values[3].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[4]+'').substring(0,1)=='-'?'':' ')+values[4].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[5]+'').substring(0,1)=='-'?'':' ')+values[5].toFixed(precision).replace(/\.?0+$/,'')+(compressed&&(values[6]+'').substring(0,1)=='-'?'':',')+values[6].toFixed(precision).replace(/\.?0+$/,''));break;}if(cmd==jbx.math.Path.Command.HORIZONTALLINETO){offx+=values[0];}else
if(cmd==jbx.math.Path.Command.VERTICALLINETO){offy+=values[0];}else{offx+=values[values.length-2];offy+=values[values.length-1];}}return pathdata.join(!compressed?' ':'')+'';};jbx[O][U][A].clear=function(){this._commands=[];this._closePoint=null;this._currentPoint=null;this._computedPath=null;this.segmentsCount=0;};jbx[O][U][A].clone=function(){var p=new jbx.math.Path();p._commands=this._commands.concat();p._closePoint=this._closePoint.clone();p._currentPoint=this._currentPoint.clone();return p;};jbx[O][U][A].transform=function(){this._computedPath=null;return false;};jbx[O][U][A].getCurrentPoint=function(){return this._currentPoint;};jbx[O][U][A].getPoint=function(t){var p=this.getComputedPath(),i=Math.floor(t*p.length),s=p[i==p.length?p.length-1:i],tp=t==1?1:(t*p.length)-i;return s.getPoint(tp);};jbx[O][U][A].getComputedPath=function(){var i=0,c=null,cpx=0,cpy=0,obj=null,prev=null,start=null,current=null;if(!this._computedPath){this._computedPath=[];for(i=0;i<this._commands.length;i++){obj=null;c=this._commands[i];switch(c[0]){case jbx.math.Path.Command.MOVETO:current=[c[1],c[2]];start=current.concat();break;case jbx.math.Path.Command.CLOSEPATH:if(current[0]!=start[0]||current[1]!=start[1]){obj=new jbx.math.Line(current[0],current[1],start[0],start[1]);this._computedPath.push(obj);}current=[start[1],start[2]];break;case jbx.math.Path.Command.LINETO:obj=new jbx.math.Line(current[0],current[1],c[1],c[2]);this._computedPath.push(obj);current=[c[1],c[2]];break;case jbx.math.Path.Command.HORIZONTALLINETO:obj=new jbx.math.Line(current[0],current[1],c[1],current[1]);this._computedPath.push(obj);current=[c[1],current[1]];break;case jbx.math.Path.Command.VERTICALLINETO:obj=new jbx.math.Line(current[0],current[1],current[0],c[2]);this._computedPath.push(obj);current=[current[0],c[2]];break;case jbx.math.Path.Command.CURVETO:obj=jbx.math.Curve.parse('M'+current[0]+','+current[1]+' C'+c[1]+','+c[2]+' '+c[3]+','+c[4]+' '+c[5]+','+c[6]);obj&&this._computedPath.push(obj);current=[c[5],c[6]];break;case jbx.math.Path.Command.SMOOTHCURVETO:cpx=current[0];cpy=current[1];if(prev&&prev instanceof jbx.math.Curve){cpx=prev.points[prev.points.length-2].x;cpy=prev.points[prev.points.length-2].y;cpx=(current[0]-cpx)+current[0];cpy=(current[1]-cpy)+current[1];}obj=jbx.math.Curve.parse('M'+current[0]+','+current[1]+' C'+cpx+','+cpy+' '+c[1]+','+c[2]+' '+c[3]+','+c[4]);obj&&this._computedPath.push(obj);current=[c[3],c[4]];break;case jbx.math.Path.Command.QUADRATICCURVETO:obj=jbx.math.Curve.parse('M'+current[0]+','+current[1]+' Q'+c[1]+','+c[2]+' '+c[3]+','+c[4]);obj&&this._computedPath.push(obj);current=[c[3],c[4]];break;case jbx.math.Path.Command.SMOOTHQUADRATICCURVETO:cpx=current[0];cpy=current[1];if(prev&&prev instanceof jbx.math.Curve){cpx=prev.points[prev.points.length-2].x;cpy=prev.points[prev.points.length-2].y;cpx=(current[0]-cpx)+current[0];cpy=(current[1]-cpy)+current[1];}obj=jbx.math.Curve.parse('M'+current[0]+','+current[1]+' Q'+cpx+','+cpy+' '+c[1]+','+c[2]);obj&&this._computedPath.push(obj);current=[c[1],c[2]];break;case jbx.math.Path.Command.ARCTO:obj=new jbx.math.Arc(current[0],current[1],c[1],c[2],c[3],c[4],c[5],c[6],c[7]);this._computedPath.push(obj);current=[c[6],c[7]];break;}prev=obj;}}return this._computedPath;};jbx[O][U][A].moveTo=function(x,y){var lastcmd=this._getLastCommand();if(lastcmd&&lastcmd[0]==jbx.math.Path.Command.MOVETO){this._commands[this._commands.length-1]=[jbx.math.Path.Command.MOVETO,x,y];}else{this._commands.push([jbx.math.Path.Command.MOVETO,x,y]);}this._currentPoint=new jbx.math.Point(x,y);this._closePoint=new jbx.math.Point(x,y);};jbx[O][U][A].closePath=function(){var lastcmd=this._getLastCommand();if(!lastcmd){return;}if(lastcmd[0]!=jbx.math.Path.Command.CLOSEPATH){this._commands.push([jbx.math.Path.Command.CLOSEPATH]);}this._currentPoint=this._closePoint.clone();this._computedPath=null;this.segmentsCount++;};jbx[O][U][A].lineTo=function(x,y){var lastcmd=this._getLastCommand();if(!lastcmd){return;}if(this._currentPoint.x!=x&&this._currentPoint.y!=y){this._commands.push([jbx.math.Path.Command.LINETO,x,y]);this._currentPoint.setCoordinate(x,y);this._computedPath=null;this.segmentsCount++;}};jbx[O][U][A].horizontalLineTo=function(x){var lastcmd=this._getLastCommand();if(!lastcmd){return;}if(this._currentPoint.x!=x){this._commands.push([jbx.math.Path.Command.HORIZONTALLINETO,x]);this._currentPoint.x=x;this._computedPath=null;this.segmentsCount++;}};jbx[O][U][A].verticalLineTo=function(y){var lastcmd=this._getLastCommand();if(!lastcmd){return;}if(this._currentPoint.y!=y){this._commands.push([jbx.math.Path.Command.VERTICALLINETO,y]);this._currentPoint.y=y;this._computedPath=null;this.segmentsCount++;}};jbx[O][U][A].curveTo=function(x1,y1,x2,y2,x,y){var lastcmd=this._getLastCommand();if(!lastcmd){return;}this._commands.push([jbx.math.Path.Command.CURVETO,x1,y1,x2,y2,x,y]);this._currentPoint.setCoordinate(x,y);this._computedPath=null;this.segmentsCount++;};jbx[O][U][A].smoothCurveTo=function(x2,y2,x,y){var lastcmd=this._getLastCommand();if(!lastcmd){return;}this._commands.push([jbx.math.Path.Command.SMOOTHCURVETO,x2,y2,x,y]);this._currentPoint.setCoordinate(x,y);this._computedPath=null;this.segmentsCount++;};jbx[O][U][A].quadraticCurveTo=function(x1,y1,x,y){var lastcmd=this._getLastCommand();if(!lastcmd){return;}this._commands.push([jbx.math.Path.Command.QUADRATICCURVETO,x1,y1,x,y]);this._currentPoint.setCoordinate(x,y);this._computedPath=null;this.segmentsCount++;};jbx[O][U][A].smoothQuadraticCurveTo=function(x,y){var lastcmd=this._getLastCommand();if(!lastcmd){return;}this._commands.push([jbx.math.Path.Command.SMOOTHQUADRATICCURVETO,x,y]);this._currentPoint.setCoordinate(x,y);this._computedPath=null;this.segmentsCount++;};jbx[O][U][A].arcTo=function(rx,ry,x_axis_rotation,large_arc_flag,sweep_flag,x2,y2){var lastcmd=this._getLastCommand();if(!lastcmd){return;}this._commands.push([jbx.math.Path.Command.ARCTO,rx,ry,x_axis_rotation,large_arc_flag,sweep_flag,x2,y2]);this._currentPoint.setCoordinate(x2,y2);this._computedPath=null;this.segmentsCount++;};jbx[x][AE]=function(el,duration,easing){jbx.com.Tween.Super(this,'constructor',duration,easing);this._transitions={};this.element=el;};jbx.extends('jbx.com.Tween','jbx.com.Animation');jbx.com.Tween.prototype._transitions={};jbx[x][AE][A].free=function(){this._transitions=null;jbx.com.Tween.Super(this,'free');};jbx[x][AE][A].clear=function(){this._transitions={};};jbx[x][AE][A]._doCycle=function(time){var p='',t=null;jbx.com.Tween.Super(this,'_doCycle',time);for(p in this._transitions){t=this._transitions[p];if(p=='pathdata'){this._doPathTransition(t);}else{this._doStyleTransition(p,t[0],t[1],t[2]);}}};jbx[x][AE][A]._doPathTransition=function(path){var p=path.getPoint(this.value);jbx.dom.style.setPosition(this.element,p.y.toFixed(0),p.x.toFixed(0));};jbx[x][AE][A]._doStyleTransition=function(style,from,to,format){var i=0,re=null,value=0;for(i=0;i<from.length;i++){if(jbx.isNumber(from[i])){value=from[i]+((to[i]-from[i])*this.value);re=new RegExp('\\{\{'+i+'\\}\\}','g');format=format.replace(re,Math.round(value));re=new RegExp('\\{'+i+'\\}','g');format=format.replace(re,value.toFixed(5));}else{value=from[i].clone();value.blend(to[i].formatHEX(),this.value);re=new RegExp('\\{'+i+'\\}','g');format=format.replace(re,'#'+value.formatHEX());}}jbx.dom.style.setStyle(this.element,style,format);};jbx[x][AE][A].setPathTransition=function(path){var p=path.getPoint(0);this._transitions['pathdata']=path;jbx.dom.style.setPosition(this.element,p.y.toFixed(0),p.x.toFixed(0));};jbx[x][AE][A].setStyleTransition=function(style,from,to,format){var i=0;style=jbx.string.toCamel(style);to=jbx.isArray(to)?to:[to];from=jbx.isArray(from)?from:[from];for(i=0;i<from.length;i++){if(from[i]&&jbx.isString(from[i])&&from[i].substr(0,1)=='#'){from[i]=jbx.color.parse(from[i]);to[i]=jbx.color.parse(to[i]);}else{from[i]=Number(from[i]);from[i]=isNaN(from[i])?0:from[i];to[i]=Number(to[i]);to[i]=isNaN(to[i])?0:to[i];}}if(jbx.isEmpty(format)){format=[];for(i=0;i<from.length;i++){format.push('{'+i+'}');}format=format.join(' ');}this._transitions[style]=[from,to,format];};jbx[H][N].useElementSelection=function(el){try{return jbx.isNumber(el.selectionStart);}catch(e){}return false;};jbx[H][N].setInputSelection=function(el,start,length){var range=null;start=parseInt(start);length=length?parseInt(length):0;if(jbx.dom.selection.useElementSelection(el)){el.selectionStart=start;el.selectionEnd=start+length;el.focus();}else
if(el.createTextRange){range=el.createTextRange();range.collapse(true);range.moveStart("character",start);range.moveEnd("character",length);range.select();}};jbx[H][N].getInputSelection=function(el){var sel=null,range=null,text='',start=0,count=0,doc=el.ownerDocument||el.document;if(jbx.dom.selection.useElementSelection(el)){start=el.selectionStart;count=el.selectionEnd-start;text=el.value?el.value.substr(start,count):'';}else
if(doc.selection){sel=doc.selection.createRange();if(el.nodeName=='TEXTAREA'){range=doc.body.createTextRange();range.moveToElementText(el);}else{range=el.createTextRange();}if(range.inRange(sel)){range.setEndPoint('EndToStart',sel);text=sel.text;count=text.length;start=range.text.replace(/\r\n|\r|\n/g,"\n").length;}}return{start:start,length:count,text:text};};jbx[H][N].getRange=function(win){var sel=null,range=null,result=null;win=jbx.dom.getWindow(win);if(win.getSelection){sel=win.getSelection();range=sel.rangeCount>0&&sel.getRangeAt(sel.rangeCount-1);}else{sel=win.document.selection;if(sel){if(sel.type!='None'){try{range=sel.createRange();}catch(e){}}}}result=new jbx.dom.Range();result.setBrowserRange(range);return result;};jbx[H][N].setRange=function(range){var sel=null,win=range.getWindow();jbx.dom.selection.clearRanges();range=range.getBrowserRange();if(range&&win){if(win.getSelection){sel=win.getSelection();sel.addRange(range);}else{range.select&&range.select();}}};jbx[H][N].clearRanges=function(win){var sel=null;win=jbx.dom.getWindow(win);if(win.getSelection){sel=win.getSelection();sel.removeAllRanges();}else{sel=win.document.selection;sel&&sel.empty&&sel.empty();}};jbx[H][M]=function(){jbx.dom.Range.Super(this,'constructor');this._range=null;this._cached={};};jbx.extends('jbx.dom.Range','jbx.base.Object');jbx[H][M].ComparePoints={END_TO_END:Range?Range.END_TO_END:'EndToEnd',END_TO_START:Range?Range.END_TO_START:'EndToStart',START_TO_END:Range?Range.START_TO_END:'StartToEnd',START_TO_START:Range?Range.START_TO_START:'StartToStart'};jbx.dom.Range.prototype._range=null;jbx.dom.Range.prototype._cached=null;jbx[H][M][A].free=function(){jbx.dom.Range.Super(this,'free');this._cached=null;this._range=null;};jbx[H][M][A]._getNewRange=function(doc){return doc.createRange?doc.createRange():doc.body.createTextRange();};jbx[H][M][A]._getTextRangeFromNode=function(node){var offset=0,previous=null,doc=jbx.dom.getDocument(node),range=doc.body.createTextRange();if(node.nodeType==jbx.dom.NodeType.ELEMENT){range.moveToElementText(node);!node.firstChild&&range.collapse(false);}else{previous=node.previousSibling;while(previous){if(previous.nodeType==jbx.dom.NodeType.TEXT){offset+=sibling.length;}else
if(previous.nodeType==jbx.dom.NodeType.ELEMENT){break;}previous=previous.previousSibling;}if(!previous){range.moveToElementText(node.parentNode);range.collapse(true);}else{range.moveToElementText(previous);range.collapse(false);}offset>0&&range.move('character',offset);range.moveEnd('character',node.length);if(previous&&node.nodeValue!=range.htmlText){range.moveEnd('character',1);range.moveStart('character',1);}}return range;};jbx[H][M][A]._getTextRangeCommonAncestor=function(){var ss=0,ee=0,node=null,range=null,child=null;node=this._range.parentElement();range=this._getTextRangeFromNode(node);ss=this._range.compareEndPoints('StartToStart',range);ee=this._range.compareEndPoints('EndToEnd',range);if(ss==0&&ee==0){return node;}else
if(node.nodeType!=jbx.dom.NodeType.TEXT&&node.firstChild){child=node.firstChild;while(child){range=this._getTextRangeFromNode(child);ss=this._range.compareEndPoints('StartToStart',range);ee=this._range.compareEndPoints('EndToEnd',range);if(ss>=0&&ee<=0){node=child;break;}else
if(ss<0&&ee<0){break;}child=child.nextSibling;}}return node;};jbx[H][M][A]._getTextRangeCoordinate=function(point,node){var i=0,pp=0,se=0,es=0,len=0,range=null;node=node||this.getCommonAncestorContainer();if(node.nodeType==jbx.dom.NodeType.TEXT){range=this._getTextRangeFromNode(node);range.setEndPoint(point=='end'?'EndToEnd':'EndToStart',this._range);this._cached[point+'offset']=range.text.length;this._cached[point+'node']=node;}else{len=node.childNodes.length;for(i=0;i<len;i++){range=this._getTextRangeFromNode(node.childNodes[i]);pp=this._range.compareEndPoints(point=='end'?'EndToEnd':'StartToStart',range);se=this._range.compareEndPoints('StartToEnd',range);es=this._range.compareEndPoints('EndToStart',range);if(pp==0||(se<0&&es>0)){this._getTextRangeCoordinate(point,node.childNodes[i]);if(point=='start'){break;}}}}};jbx[H][M][A]._getCommonAncestorContainer=function(){var i=0,item=null;this._cached['ancestor']=null;if(this._range.commonAncestorContainer){this._cached['ancestor']=this._range.commonAncestorContainer;}else
if(this._range.parentElement){this._cached['ancestor']=this._getTextRangeCommonAncestor();}else
if(this._range.length){for(i=0;i<this._range.length;i++){if(this._cached['ancestor']){item=this._range.item(i);if(jbx.dom.contains(item,this._cached['ancestor'])){this._cached['ancestor']=item;}}else{this._cached['ancestor']=item;}}}};jbx[H][M][A]._getStartCoordinate=function(){this._cached['startnode']=null;this._cached['startoffset']=-1;if(this._range.startContainer){this._cached['startnode']=this._range.startContainer;this._cached['startoffset']=this._range.startOffset;}else
if(this._range.compareEndPoints){this._getTextRangeCoordinate('start');}else
if(this._range.length){this._cached['startnode']=this._range.items(0);this._cached['startoffset']=0;}};jbx[H][M][A]._getEndCoordinate=function(){this._cached['endnode']=null;this._cached['endoffset']=-1;if(this.isCollapsed()){this._cached['endnode']=this.getStartContainer();this._cached['endoffset']=this.getStartOffset();}else
if(this._range.endContainer){this._cached['endnode']=this._range.endContainer;this._cached['endoffset']=this._range.endOffset;}else
if(this._range.compareEndPoints){this._getTextRangeCoordinate('end');}else
if(this._range.length){this._cached['endnode']=this._range.items(this._range.length-1);this._cached['endoffset']=this._cached['endnode'].childNodes.length;}};jbx[H][M][A]._getTextRangeDocumentFragment=function(){var doc=jbx.dom.getDocument(this.getStartContainer());frag=doc.createDocumentFragment(),div=doc.createElement('DIV'),child=null;div.innerHTML=this._range.htmlText;child=div.firstChild;while(child){frag.appendChild(child);child=div.firstChild;}return frag;};jbx[H][M][A]._getControlRangeDocumentFragment=function(){var i=0,doc=jbx.dom.getDocument(this.getStartContainer());frag=doc.createDocumentFragment(),div=doc.createElement('DIV');doc=jbx.dom.getDocument(this.getStartContainer());frag=doc.createDocumentFragment();div=document.createElement('DIV');for(i=0;i<this._range.length;i++){frag.appendChild(this._range.item(i).cloneNode(true));}return frag;};jbx[H][M][A]._setPoint=function(node,offset,point){var range=null,done=false,pointNode=node,pointOffset=offset,collapseStart=false,func=point=='start'?'setStart':'setEnd';if(this._range[func]){this._range[func](node,offset);done=true;}else
if(this._range.setEndPoint){if(node.nodeType==jbx.dom.NodeType.ELEMENT){offset=Math.max(0,Math.min(offset,node.childNodes.length));collapseStart=!!node.childNodes[offset];node=node.childNodes[offset]||node;offset=0;}range=this._getTextRangeFromNode(node);range.collapse(collapseStart);offset>0&&range[point=='start'?'move':'moveEnd']('character',offset);this._range.setEndPoint(point=='start'?'StartToStart':'EndToEnd',range);done=true;}if(done){jbx.dom.selection.setRange(this);this._cached[point+'node']=pointNode;this._cached[point+'offset']=pointOffset;this._cached['collapsed']=undefined;this._cached['ancestor']=undefined;}return done;};jbx[H][M][A]._setPointAt=function(node,point,position){var func='',offset=0,child=null;if(point=='end'){func=position=='after'?'setEndAfter':'setEndBefore';}else{func=position=='after'?'setStartAfter':'setStartBefore';}if(this._range[func]){this._range[func](node);jbx.dom.selection.setRange(this);this._cached[point+'node']=undefined;this._cached[point+'offset']=undefined;}else{child=node.parentNode.firstChild;while(child){if(position=='after'){offset++;}if(node==child){break;}if(position!='after'){offset++;}child=child.nextSibling;}this[point=='end'?'setEnd':'setStart'](node.parentNode,offset);this._cached[point+'node']=node.parentNode;this._cached[point+'offset']=offset;}this._cached['collapsed']=undefined;this._cached['ancestor']=undefined;};jbx[H][M][A].getBrowserRange=function(){return this._range;};jbx[H][M][A].getWindow=function(){return this._range?jbx.dom.getWindow(this.getStartContainer()):null;};jbx[H][M][A].getCommonAncestorContainer=function(){this._range&&!jbx.isDefined(this._cached['ancestor'])&&this._getCommonAncestorContainer();return this._cached['ancestor']||null;};jbx[H][M][A].getStartContainer=function(){this._range&&!jbx.isDefined(this._cached['startnode'])&&this._getStartCoordinate();return this._cached['startnode']||null;};jbx[H][M][A].getStartOffset=function(){this._range&&!jbx.isDefined(this._cached['startoffset'])&&this._getStartCoordinate();return this._cached['startoffset'];};jbx[H][M][A].getEndContainer=function(){this._range&&!jbx.isDefined(this._cached['endnode'])&&this._getEndCoordinate();return this._cached['endnode']||null;};jbx[H][M][A].getEndOffset=function(){this._range&&!jbx.isDefined(this._cached['endoffset'])&&this._getEndCoordinate();return this._cached['endoffset'];};jbx[H][M][A].getText=function(){if(this._range){if(this._range.compareBoundaryPoints){return this._range.toString();}else
if(this._range.compareEndPoints){return this._range.text;}else{return jbx.string.stripTags(this.getHTML());}}return'';};jbx[H][M][A].getHTML=function(){var div=null,content=null;if(this._range){if(this._range.compareEndPoints){return this._range.htmlText;}else{content=this.cloneContents();if(content){div=document.createElement('DIV');div.appendChild(content);return div.innerHTML;}return'';}}return'';};jbx[H][M][A].setBrowserRange=function(range){this._range=range;this._cached={};};jbx[H][M][A].setStart=function(node,offset){var done=false,newrange=!this._range;if(newrange){this._range=this._getNewRange(jbx.dom.getDocument(node));}done=this._setPoint(node,offset||0,'start');if(newrange){this._setPoint(node,offset||0,'end');this.collapse(true);}return done;};jbx[H][M][A].setEnd=function(node,offset){var done=false,newrange=!this._range;if(newrange){this._range=this._getNewRange(jbx.dom.getDocument(node));done=this._setPoint(node,offset||0,'start');}done=this._setPoint(node,offset||0,'end');newrange&&this.collapse(false);return done;};jbx[H][M][A].setStartBefore=function(node){this._range&&this._setPointAt(node,'start','before');};jbx[H][M][A].setEndBefore=function(node){this._range&&this._setPointAt(node,'end','before');};jbx[H][M][A].setStartAfter=function(node){this._range&&this._setPointAt(node,'start','after');};jbx[H][M][A].setEndAfter=function(node){this._range&&this._setPointAt(node,'end','after');};jbx[H][M][A].isCollapsed=function(){if(this._range&&!jbx.isDefined(this._cached['collapsed'])){if(this._range.collapse){this._cached['collapsed']=this._range.collapsed;}else
if(this._range.compareEndPoints){this._cached['collapsed']=this._range.compareEndPoints('StartToEnd',this._range)==0;}else{this._cached['collapsed']=!this._range.length;}}return this._cached['collapsed']||!this._range;};jbx[H][M][A].collapse=function(toStart){toStart=toStart!==false;if(!this.isCollapsed()){if(this._range.collapse){this._range.collapse(toStart);jbx.dom.selection.setRange(this);this._cached['collapsed']=undefined;this._cached['ancestor']=undefined;if(toStart){this._cached['endnode']=this._cached['startnode'];this._cached['endoffset']=this._cached['startoffset'];}else{this._cached['startnode']=this._cached['endnode'];this._cached['startoffset']=this._cached['endoffset'];}}else{this._range=null;}}};jbx[H][M][A].selectNode=function(node){if(this._range){if(this._range.selectNode){this._range.selectNode(node);}else
if(this._range.moveToElementText){this._range.moveToElementText(node);}else{}jbx.dom.selection.setRange(this);}this._cached={};};jbx[H][M][A].selectNodeContents=function(node){if(this._range){if(this._range.selectNodeContents){this._range.selectNodeContents(node);}else
if(this._range.moveToElementText){this._range.moveToElementText(node);}else{}jbx.dom.selection.setRange(this);}this._cached={};};jbx[H][M][A].compareBoundaryPoints=function(method,range){if(this._range){if(this._range.compareBoundaryPoints){return this._range.compareBoundaryPoints(method,range.getBrowserRange());}else
if(this._range.compareEndPoint){return this._range.compareEndPoint(method,range.getBrowserRange());}else{}}return 0;};jbx[H][M][A].deleteContents=function(){var i=0;if(!this.isCollapsed()){this._cached={};if(this._range.deleteContents){this._range.deleteContents();}else
if(this._range.compareEndPoints){this._range.text='';}else{for(i=this._range.length-1;i>0;i--){this._range.item(i).parentNode.removeChild(this._range.item(i));}}}};jbx[H][M][A].extractContents=function(){var frag=null;if(!this.isCollapsed()){this._cached={};if(this._range.extractContents){return this._range.extractContents();}else{frag=this._range.compareEndPoints?this._getTextRangeDocumentFragment():this._getControlRangeDocumentFragment();this.deleteContents();return frag;}}return null;};jbx[H][M][A].cloneContents=function(){if(!this.isCollapsed()){if(this._range.cloneContents){return this._range.cloneContents();}else{return this._range.compareEndPoints?this._getTextRangeDocumentFragment():this._getControlRangeDocumentFragment();}}return null;};jbx[H][M][A].insertNode=function(node,atStart){var len=0,range=null,newnode=null;if(this._range){if(this._range.insertNode){if(atStart===false){range=this._range.cloneRange();range.collapse(false);range.insertNode(node);if(node.nodeType==jbx.dom.NodeType.TEXT){len=node.nodeValue.length;}else{len=node.childNodes?node.childNodes.length:0;}this.setEnd(node,len);}else{this._range.insertNode(node);}return node;}else
if(this._range.pasteHTML){newnode=jbx.dom.getDocument(node).createElement('SPAN');newnode.appendChild(node);node=newnode;node.id='jbx_range_node_insert';range=this._range.duplicate();range.collapse(atStart!==false);range.pasteHTML(node.outerHTML);node=jbx.dom.getElement('jbx_range_node_insert');newnode=node.firstChild;node.parentNode.insertBefore(newnode,node);node.parentNode.removeChild(node);node=newnode;return node;}else
if(this._range.length){atStart?jbx.dom.insertBefore(node,this.getStartContainer()):jbx.dom.insertAfter(node,this.getEndContainer());}this._cached={};}};jbx[H][M][A].surroundContents=function(element){if(this._range){if(this._range.surroundContents){this._range.surroundContents(element);}else
if(this._range.pasteHTML){element.parentNode&&element.parentNode.removeChild(element);element.appendChild(this.extractContents());element=this.insertNode(element);}else{}this.selectNode(element);this._cached={};}return element;};jbx[H][M][A].cloneRange=function(){var i=0,doc=null,range=new jbx.dom.Range();if(this._range){if(this._range.cloneRange){range.setBrowserRange(this._range.cloneRange());}else
if(this._range.duplicate){range.setBrowserRange(this._range.duplicate());}else
if(this._range.items&&this._range.length){doc=jbx.dom.getDocument(this._range.items(0));range.setBrowserRange(doc.body.createControlRange());for(i=0;i<this._range.length;i++){range.getBrowserRange().addElement(this._range.items(i).cloneNode(true));}}}return range;};jbx[Z][j]=function(type,dic){jbx.events.SlideshowEvent.Super(this,'constructor',type,dic);};jbx.extends('jbx.events.SlideshowEvent','jbx.events.Event');jbx.events.SlideshowEvent.SHOW='show';jbx.events.SlideshowEvent.HIDE='hide';jbx.events.SlideshowEvent.prototype.slide=null;jbx.events.SlideshowEvent.prototype.index=-1;jbx.events.SlideshowEvent.prototype.direction=-1;jbx[Z][j][A].initEvent=function(type,dic){dic=dic||{};dic.bubbles=false;jbx.events.SlideshowEvent.Super(this,'initEvent',type,dic);this.slide=dic.slide||null;this.index=dic.index||-1;this.direction=dic.direction||0;};jbx[p][q].Type={POP:0,PUSH:1}
jbx.net.history._pushed=false;jbx.net.history._popped=false;jbx.net.history._listenerSet=false;jbx.net.history._initialUrl='';jbx.net.history._callbacks=[];jbx[p][q]._onPopstate=function(e){var url=document.location+'',initialpop=!jbx.net.history._popped&&!jbx.net.history._pushed&&jbx.net.history._initialUrl==url;jbx.net.history._popped=true;!initialpop&&jbx.net.history._fireCallbacks(jbx.net.history.Type.POP,e.event.state);};jbx[p][q]._fireCallbacks=function(source,data){var i=0;for(i=0;i<jbx.net.history._callbacks.length;i++){jbx.net.history._callbacks[i].call(this,source,data);}};jbx[p][q].register=function(func){if(jbx.net.isHistoryAvailable()){if(func&&jbx.isFunction(func)){if(!jbx.net.history._listenerSet){jbx.net.history._listenerSet=true;jbx.net.history._popped=history.state!=null;jbx.net.history._initialUrl=document.location+'';jbx.events.listen(window,'popstate',jbx.net.history._onPopstate);}jbx.net.history._callbacks.push(func);}}};jbx[p][q].unregister=function(func){var i=0;if(jbx.net.isHistoryAvailable()){for(i=0;i<jbx.net.history._callbacks.length;i++){if(jbx.net.history._callbacks==func){jbx.net.history._callbacks.splice(i,1);}}if(jbx.net.history._listenerSet&&!jbx.net.history._callbacks.length){jbx.net.history._listenerSet=false;jbx.events.unlisten(window,'popstate',jbx.net.history._onPopstate);}}};jbx[p][q].push=function(url,title,data){if(jbx.net.isHistoryAvailable()){url=url||document.location+'';title=jbx.isEmpty(title)?document.title+'':title;url!=document.location+''&&history.pushState(data,title,url);jbx.net.history._fireCallbacks(jbx.net.history.Type.PUSH,data);jbx.net.history._pushed=true;return true;}return false;};jbx[p][q].replace=function(url,title,data){if(jbx.net.isHistoryAvailable()){url=url||document.location+'';title=jbx.isEmpty(title)?document.title+'':title;history.replaceState(data,title,url);jbx.net.history._pushed=true;return true;}return false;};jbx[p][r]._replaceChars={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};jbx[p][r].isValid=function(text){var remainder=/^[\],:{}\s]*$/,brakets=/(?:^|:|,)(?:\s*\[)+/g,escaped=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,values=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g;return jbx.string.trim(text)!=''&&remainder.test(text.replace(escaped,'@').replace(values,']').replace(brakets,''));};jbx[p][r].parse=function(text){try{if(JSON&&JSON.parse){return JSON.parse(value);}}catch(e){}if(jbx.net.json.isValid(text)){try{return eval('('+text+')');}catch(e){}}throw Error("Invalid JSON string");};jbx[p][r].stringify=function(value){try{if(JSON&&JSON.stringify){return JSON.stringify(value);}}catch(e){}switch(typeof value){case'null':case'undefined':return'null';case'boolean':return value?'true':'false';case'string':return jbx.net.json.encodeString(value);case'number':return jbx.net.json.encodeNumber(value);case'object':if(!value){return'null';}if(jbx.isArray(value)){return jbx.net.json.encodeArray(value);}return jbx.net.json.encodeObject(value);default:throw Error('Invalid JSON object type "'+(typeof value)+'"');}};jbx[p][r].encodeNumber=function(value){return isFinite(value)&&!isNaN(value)?value+'':'null';};jbx[p][r].encodeString=function(value){var replacement=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;return replacement.test(value)?'"'+value.replace(replacement,function(c){var v=jbx.net.json._replaceChars[c];return v||'\\u'+('0000'+c.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+value+'"';};jbx[p][r].encodeArray=function(value){var i=0,arr=[],join='',l=value.length;for(i=0;i<l;i++){arr[i]=jbx.net.json.stringify(value[i])+',';}if(!arr.length){return'[]';}arr[l-1]=arr[l-1].substr(0,arr[l-1].length-1);arr.unshift('[');return arr.join(join)+']';};jbx[p][r].encodeObject=function(value){var l=0,k='',v='',join='',obj=[];for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=jbx.net.json.stringify(value[k]);k=jbx.net.json.stringify(k);obj.push(k+':'+v+',');l++;}}if(!obj.length){return'{}';}obj[l-1]=obj[l-1].substr(0,obj[l-1].length-1);obj.unshift('{');return obj.join(join)+'}';};jbx[p][s]=function(timeout,id){jbx.net.XHR.Super(this,'constructor',timeout,id);};jbx.extends('jbx.net.XHR','jbx.base.Http');jbx.net.XHR.prototype.sending=false;jbx.net.XHR.prototype.total=0;jbx.net.XHR.prototype.loaded=0;jbx.net.XHR.prototype.state=0;jbx.net.XHR.prototype._xhr=null;jbx[p][s].send=function(url,callback,method,params,files,timeout,id,widthCredentials){var xhr=new jbx.net.XHR(timeout,id);xhr.listen(jbx.events.Event.COMPLETE,callback);xhr.listen(jbx.events.Event.READY,xhr.free,xhr);xhr.send(url,method,params,files,widthCredentials);};jbx[p][s][A]._cleanHttp=function(){if(this._xhr){this._xhr.abort();this._xhr.onreadystatechange=jbx.net._XHRNull;if('upload'in this._xhr&&'onprogress'in this._xhr.upload){jbx.events.unlistenAll(this._xhr.upload);}this._xhr=null;}};jbx[p][s][A]._getFiles=function(files){var i=0,j=0,item=null,result=[];if('files'in files){result=this._getFiles(files.files);}else
if('item'in files&&files.length){for(i=0;i<files.length;i++){result.push(files[i]);}}else
if('name'in files&&files.size){result.push(files);}else
if(jbx.isArray(files)){for(i=0;i<files.length;i++){item=this._getFiles(files[i]);for(j=0;j<item.length;j++){result.push(item[j]);}}}else{}return result;};jbx[p][s][A]._onUploadError=function(e){this._setError('Upload fails');};jbx[p][s][A]._onUploadStart=function(e){this._timer&&this._timer.restart();this.total=e.event.total;};jbx[p][s][A]._onUploadProgress=function(e){this._timer&&this._timer.restart();this.loaded=e.event.loaded;this.total=e.event.total;this.dispatch(jbx.events.Event.PROGRESS);};jbx[p][s][A]._onReadyStateChange=function(){this.state=this._xhr.readyState;this.dispatch(jbx.events.Event.STATECHANGE);switch(this._xhr.readyState){case 1:if(!this.sending){this.sending=true;this._timer&&this._timer.restart();this.dispatch(jbx.events.Event.OPEN);}break;case 2:if(this.sending){this.total=0;this.loaded=0;this.sending=false;this._timer&&this._timer.restart();if(this._xhr.getResponseHeader){this.total=parseInt(this._xhr.getResponseHeader("Content-length"));this.total=isNaN(this.total)?0:this.total;}}break;case 3:this._timer&&this._timer.restart();this.loaded=this._xhr.responseText.length;this.dispatch(jbx.events.Event.PROGRESS);break;case 4:if(this.open){if(this._xhr.status>0&&this._xhr.status!=200){this._setError('['+this._xhr.status+'] '+this._xhr.statusText);}else{this.responseText=this._xhr.responseText;this._setComplete();}}break;}};jbx[p][s][A].send=function(url,method,params,files,withCredentials){var i=0,This=this,data=null,upload=null;if(this._xhr){throw new Error("Http object is currently active.");}this.state=0;this.total=0;this.loaded=0;this.open=true;this.error=false;this.aborted=false;this.timeout=false;this.sending=false;this.lastError='';this.responseText='';params=params||'';this._xhr=jbx.net.getXMLHttpRequestObject();if(!this._xhr){throw new Error("XMLHttpRequest not supported on this browser.");}method=method&&method.toUpperCase()=='POST'?'POST':'GET';if(method=='GET'&&params!=''){url+=url.indexOf('?')>=0?'&'+params:'?'+params;params='';}if(withCredentials&&'withCredentials'in this._xhr){this._xhr.withCredentials=true;}data=params;if(files&&files.length){files=this._getFiles(files);try{data=new FormData();}catch(e){}if(files.length&&'upload'in this._xhr&&data){method='POST';upload=this._xhr.upload;if('onprogress'in upload){jbx.events.listen(upload,'error',this._onUploadError,this);jbx.events.listen(upload,'progress',this._onUploadProgress,this);jbx.events.listen(upload,'loadstart',this._onUploadStart,this);}if(params!=''){params=params.split('&');for(i=0;i<params.length;i++){params[i]=params[i].split('=',2);data.append(params[i][0],params[i][1]||'');}}for(i=0;i<files.length;i++){this.total+=files[i].length;data.append('upload[]',files[i]);}}}this._xhr.onreadystatechange=function(){This._onReadyStateChange.call(This);};this._timer&&this._timer.restart();try{this._xhr.open(method,url,true);}catch(e){this._setError(e.message);return;}if(method=='POST'&&(!files||!files.length)){this._xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");}try{this._xhr.send(data);}catch(e){this._setError(e.message);}};jbx[AF][AG]=function(el,interval){jbx.widget.Slideshow.Super(this,'constructor');this._initialize(jbx.dom.getElement(el));this.start(interval||0);};jbx.extends('jbx.widget.Slideshow','jbx.base.Control');jbx.widget.Slideshow.prototype.element=null;jbx.widget.Slideshow.prototype.count=0;jbx.widget.Slideshow.prototype.current=0;jbx.widget.Slideshow.prototype.direction=1;jbx.widget.Slideshow.prototype.size=null;jbx.widget.Slideshow.prototype._navigator=null;jbx.widget.Slideshow.prototype._interval=0;jbx.widget.Slideshow.prototype._timer=null;jbx[AF][AG][A].free=function(){this._timer.free();this.size=null;this._timer=null;this.element=null;this.setNavigator(null);jbx.widget.Slideshow.Super(this,'free');};jbx[AF][AG][A]._initialize=function(el){this.element=el;this.direction=1;this._timer=new jbx.com.Timer();if(!el){this.size=new jbx.math.Size(0,0);}else{jbx.dom.classes.add(el,this.styleName);this.size=jbx.dom.style.getSize(el);this._timer.listen(jbx.com.Timer.TIMER,this._onTimer,this);this._timer.listen(jbx.com.Timer.STOP,this._onTimerStops,this);this._timer.listen(jbx.com.Timer.START,this._onTimerStarts,this);jbx.events.listen(el,['mouseover','mouseout'],this._onMouseEvent,this);el.style.overflow='hidden';el.style.position='relative';el.style.width=this.size.width+'px';el.style.height=this.size.height+'px';el=jbx.dom.firstChild(el);while(el){jbx.dom.classes.add(el,this.styleName+'-slide');el.style.height=this.size.height+'px';el.style.width=this.size.width+'px';el.style.position='absolute';el.style.overflow='hidden';el.style.left='0px';el.style.top='0px';el.style.zIndex=1;if(this.count==0){jbx.dom.classes.add(el,this.styleName+'-slide-selected');el.style.zIndex=2;}el=jbx.dom.nextElement(el);this.count++;}}};jbx[AF][AG][A]._onTimer=function(e){this.direction>0?this.nextSlide():this.previousSlide();};jbx[AF][AG][A]._onTimerStarts=function(e){jbx.dom.classes.add(this.element,this.styleName+'-playing');};jbx[AF][AG][A]._onTimerStops=function(e){jbx.dom.classes.remove(this.element,this.styleName+'-playing');};jbx[AF][AG][A]._onMouseEvent=function(e){if(e.type=='mouseover'){jbx.dom.classes.add(this.element,this.styleName+'-over');this._timer.pause();}else{jbx.dom.classes.remove(this.element,this.styleName+'-over');this._timer.start();}};jbx[AF][AG][A]._onNavigatorButtonEvent=function(e){var btn=e.target,pos=btn.id.split('_').pop();switch(e.type){case'mouseout':jbx.dom.classes.remove(btn,this.styleName+'-navigator-button-over');break;case'mouseover':jbx.dom.classes.add(btn,this.styleName+'-navigator-button-over');break;case'click':this.showSlide(parseInt(pos)||0);break;}};jbx[AF][AG][A]._doShowSlide=function(el,pos,dir){var dic={index:pos,direction:dir,slide:el},e=new jbx.events.SlideshowEvent(jbx.events.SlideshowEvent.SHOW,dic);this.dispatch(e);e.free();};jbx[AF][AG][A]._doHideSlide=function(el,pos,dir){var dic={index:pos,direction:dir,slide:el},e=new jbx.events.SlideshowEvent(jbx.events.SlideshowEvent.HIDE,dic);this.dispatch(e);e.free();};jbx[AF][AG][A].setNavigator=function(el,numbers){var btn=null;if(this._navigator){btn=jbx.dom.firstChild(this._navigator);while(btn){jbx.events.unlisten(btn,['click','mouseover','mouseout'],this._onNavigatorButtonEvent,this);this._navigator.removeChild(btn);btn=jbx.dom.firstChild(this._navigator);}jbx.events.unlisten(this._navigator,['mouseover','mouseout'],this._onMouseEvent,this);this._navigator.parentNode.removeChild(this._navigator);}this._navigator=jbx.dom.getElement(el);if(this._navigator){this._navigator.innerHTML='';jbx.dom.classes.add(this._navigator,this.styleName+'-navigator');jbx.events.listen(this._navigator,['mouseover','mouseout'],this._onMouseEvent,this);for(var i=0;i<this.count;i++){btn=jbx.dom.createElement('DIV',{id:'jbx_slideshow_button_'+i,className:this.styleName+'-navigator-button'});if(numbers){btn.innerHTML=(i+1);}jbx.events.listen(btn,['click','mouseover','mouseout'],this._onNavigatorButtonEvent,this);if(i==this.current){jbx.dom.classes.add(btn,this.styleName+'-navigator-button-selected');}this._navigator.appendChild(btn);}}};jbx[AF][AG][A].nextSlide=function(){this.showSlide(this.current+1);};jbx[AF][AG][A].previousSlide=function(){this.showSlide(this.current-1);};jbx[AF][AG][A].showSlide=function(index){var el=null,count=0,dir=index>this.current?1:-1;index=index>=this.count?0:index;index=index<0?this.count-1:index;if(index==this.current){return;}el=jbx.dom.firstChild(this.element);while(el){if(count==index){el.style.zIndex=3;this._doShowSlide(el,count,dir);}else
if(count==this.current){el.style.zIndex=2;this._doHideSlide(el,count,dir);}else{el.style.zIndex=1;}el=jbx.dom.nextElement(el);count++;}if(this._navigator){count=0;el=jbx.dom.firstChild(this._navigator);while(el){if(count==index){jbx.dom.classes.add(el,this.styleName+'-navigator-button-selected');}else{jbx.dom.classes.remove(el,this.styleName+'-navigator-button-selected');}el=jbx.dom.nextElement(el);count++;}}this.current=index;};jbx[AF][AG][A].start=function(interval){this._interval=Math.max(0,interval||this._interval);this._timer.delay=this._interval;this._timer.start();};jbx[AF][AG][A].stop=function(){this._timer.pause();};